(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    338373,       7583]
NotebookOptionsPosition[    329408,       7310]
NotebookOutlinePosition[    329764,       7326]
CellTagsIndexPosition[    329721,       7323]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Basic setup", "Subchapter",
 CellChangeTimes->{{3.686484362181985*^9, 3.6864843639161797`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Quiet", "[", 
   RowBox[{"Needs", "[", "\"\<QDENSITY`Qdensity`\>\"", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Quiet", "[", 
   RowBox[{"Needs", "[", "\"\<QDENSITY`QCWave`\>\"", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"?", "QDENSITY`Qdensity`*"}]}], "Input",
 CellChangeTimes->{{3.639975458161084*^9, 3.6399754693100843`*^9}, {
  3.6815397820713816`*^9, 3.681539795860895*^9}, {3.683882379249514*^9, 
  3.683882379439514*^9}}],

Cell[BoxData[
 DynamicModuleBox[{Typeset`open$$ = True}, 
  PaneSelectorBox[{False->
   RowBox[{
    OpenerBox[Dynamic[Typeset`open$$],
     ImageSize->Small], 
    StyleBox["QDENSITY`Qdensity`", "InfoHeading"]}], True->GridBox[{
     {
      RowBox[{
       OpenerBox[Dynamic[Typeset`open$$],
        ImageSize->Small], 
       StyleBox["QDENSITY`Qdensity`", "InfoHeading"]}]},
     {GridBox[{
        {
         ButtonBox["about",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"about", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["CPHASE",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"CPHASE", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["i8",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"i8", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["Mutual",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"Mutual", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["PY",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"PY", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["res2$",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"res2$", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["stB",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"stB", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["Xb",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"Xb", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"]},
        {
         ButtonBox["Adj",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"Adj", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["CPHASEV",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"CPHASEV", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["intro",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"intro", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["nb",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"nb", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["qubit",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"qubit", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["Rotqbit",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"Rotqbit", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["Swap",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"Swap", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["xd",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"xd", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"]},
        {
         ButtonBox["AF",
          BaseStyle->"InformationLink",
          ButtonData:>{
           "Info1813688305758-3755664", {"AF", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["cRQN",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"cRQN", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["j8",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"j8", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["neg",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"neg", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["RandomBra1",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"RandomBra1", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["RotX",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"RotX", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["s$",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"s$", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["Xd",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"Xd", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"]},
        {
         ButtonBox["at",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"at", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["Definef",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"Definef", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["Ket1",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"Ket1", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["nneg",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"nneg", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["RandomBra2",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"RandomBra2", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["RotY",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"RotY", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["TensorProductQ",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {
            "TensorProductQ", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["ZeroMatrix",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"ZeroMatrix", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"]},
        {
         ButtonBox["Bra1",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"Bra1", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["density",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"density", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["KetV",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"KetV", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["nq",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"nq", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["RandomBraN",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"RandomBraN", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["RotZ",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"RotZ", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["ThreeOp",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"ThreeOp", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["ZeroT",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"ZeroT", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"]},
        {
         ButtonBox["BraV",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"BraV", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["DForm2",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"DForm2", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["KetX",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"KetX", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["Observables",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"Observables", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["RandomKet1",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"RandomKet1", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["s",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"s", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["to",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"to", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["\[ScriptCapitalH]",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {
            "\[ScriptCapitalH]", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"]},
        {
         ButtonBox["BraX",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"BraX", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["Discord",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"Discord", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["KetY",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"KetY", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["OneOp",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"OneOp", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["RandomKet2",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"RandomKet2", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["Schmidt",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"Schmidt", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["Toffoli",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"Toffoli", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["\[ScriptCapitalP]",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {
            "\[ScriptCapitalP]", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"]},
        {
         ButtonBox["BraY",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"BraY", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["EnTropy",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"EnTropy", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["look",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"look", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["Oracle",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"Oracle", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["RandomKetN",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"RandomKetN", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["Sigma0",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"Sigma0", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["ts",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"ts", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["\[DoubleStruckCapitalI]",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {
            "\[DoubleStruckCapitalI]", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"]},
        {
         ButtonBox["CNOT",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"CNOT", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["EnTropy2",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"EnTropy2", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["matrices",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"matrices", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["PartialTrace",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {
            "PartialTrace", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["RandomQubit1",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {
            "RandomQubit1", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["Sigma1",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"Sigma1", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["ts$",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"ts$", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["\[Rho]",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"\[Rho]", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"]},
        {
         ButtonBox["Coeff",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"Coeff", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["Fidelity",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"Fidelity", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["mc",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"mc", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["PartialTraceGen",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {
            "PartialTraceGen", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["RandomQubit2",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {
            "RandomQubit2", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["Sigma2",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"Sigma2", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["TwoOp",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"TwoOp", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["\[Rho]$",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"\[Rho]$", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"]},
        {
         ButtonBox["Comm",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"Comm", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["FidelityB",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"FidelityB", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["mcl",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"mcl", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["PartialTranspose",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {
            "PartialTranspose", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["RandomQubitN",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {
            "RandomQubitN", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["Sigma3",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"Sigma3", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["U",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"U", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["\[Sigma]",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"\[Sigma]", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"]},
        {
         ButtonBox["CompMeasureKet",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {
            "CompMeasureKet", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["for",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"for", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["mcl$",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"mcl$", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["ProjG",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"ProjG", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["rcsDate",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"rcsDate", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["Snos",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"Snos", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["v",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"v", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["\[Phi]A1",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"\[Phi]A1", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"]},
        {
         ButtonBox["CompPTr",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"CompPTr", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["had",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"had", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["mc$",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"mc$", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["PTr",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"PTr", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["rcsRevision",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"rcsRevision", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["SP",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"SP", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["Vs",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"Vs", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["\[Phi]A2",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"\[Phi]A2", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"]},
        {
         ButtonBox["ControlledX",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"ControlledX", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["Had",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"Had", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["MeasureKet",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"MeasureKet", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["PTrGen",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"PTrGen", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["res1",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"res1", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["Spin",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"Spin", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["v$",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"v$", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["\[Phi]B1",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"\[Phi]B1", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"]},
        {
         ButtonBox["ControlledY",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"ControlledY", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["Hadamard",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"Hadamard", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["MultiProjCBasis",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {
            "MultiProjCBasis", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["Purity",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"Purity", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["res1$",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"res1$", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["SpinObs",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"SpinObs", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["ws",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"ws", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["\[Phi]B2",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"\[Phi]B2", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"]},
        {
         ButtonBox["ControlledZ",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"ControlledZ", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["HALL",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"HALL", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["MultiQProj",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"MultiQProj", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["PX",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"PX", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["res2",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"res2", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["stA",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"stA", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["xb",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {"xb", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["\[CapitalOmega]s",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info1813688305758-3755664", {
            "\[CapitalOmega]s", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"]}
       },
       DefaultBaseStyle->"InfoGrid",
       GridBoxItemSize->{"Columns" -> {{
            Scaled[0.11875]}}}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}}]}, 
   Dynamic[Typeset`open$$],
   ImageSize->Automatic]]], "Print", "InfoCell",
 CellChangeTimes->{3.688302158444063*^9}]
}, Open  ]],

Cell["General useful definitions such as gates etc.", "Text",
 CellChangeTimes->{{3.6820568687461243`*^9, 3.6820568979912386`*^9}},
 Background->GrayLevel[0.85]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"KP", "[", "r__", "]"}], ":=", 
  RowBox[{"KroneckerProduct", "[", "r", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"StyleNumber", "[", "number_", "]"}], " ", ":=", 
  RowBox[{"Style", "[", 
   RowBox[{"number", ",", "Bold", ",", 
    RowBox[{"Darker", "[", "Green", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Stokesfrom\[Rho]", "[", "\[Rho]_", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"t", " ", "=", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Re", "[", 
         RowBox[{"Tr", "[", 
          RowBox[{
           SubscriptBox["\[Sigma]", "i"], ".", "\[Rho]"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], "//", "N"}]}], 
    ";", " ", "t"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Stokesfrom\[Rho]Styled", "[", "\[Rho]_", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"t", " ", "=", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"Re", "[", 
             RowBox[{"Tr", "[", 
              RowBox[{
               SubscriptBox["\[Sigma]", "i"], ".", "\[Rho]"}], "]"}], "]"}], 
            "]"}], ">", "0.4"}], ",", 
          RowBox[{"StyleNumber", "[", 
           RowBox[{"Re", "[", 
            RowBox[{"Tr", "[", 
             RowBox[{
              SubscriptBox["\[Sigma]", "i"], ".", "\[Rho]"}], "]"}], "]"}], 
           "]"}], ",", 
          RowBox[{"Re", "[", 
           RowBox[{"Tr", "[", 
            RowBox[{
             SubscriptBox["\[Sigma]", "i"], ".", "\[Rho]"}], "]"}], "]"}]}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], "//", "N"}]}], 
    ";", " ", "t"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]from\[Psi]", "[", "\[Psi]_", "]"}], " ", ":=", 
   RowBox[{"\[Psi]", ".", 
    RowBox[{"\[Psi]", "\[ConjugateTranspose]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Stokesfrom\[Psi]", "[", "\[Psi]_", "]"}], ":=", 
   RowBox[{"Stokesfrom\[Rho]", "[", 
    RowBox[{"\[Rho]from\[Psi]", "[", "\[Psi]", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fidfrom\[Rho]", "[", 
    RowBox[{"\[Rho]_", ",", "\[Sigma]_"}], "]"}], ":=", 
   RowBox[{"Re", "[", 
    SuperscriptBox[
     RowBox[{"Tr", "[", 
      RowBox[{"MatrixPower", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"MatrixPower", "[", 
          RowBox[{"\[Rho]", ",", "0.5"}], "]"}], ".", "\[Sigma]", ".", 
         RowBox[{"MatrixPower", "[", 
          RowBox[{"\[Rho]", ",", "0.5"}], "]"}]}], ",", "0.5"}], "]"}], "]"}],
      "2"], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MixedState", "=", 
    RowBox[{"\[DoubleStruckCapitalI]", "/", "2"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"Mixed", " ", "state"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"transformAndNorm", "[", 
    RowBox[{"state_", ",", "U_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"out", "=", 
      RowBox[{"U", ".", "state", ".", 
       RowBox[{"U", "\[ConjugateTranspose]"}]}]}], ";", 
     RowBox[{"out", "=", 
      RowBox[{"out", "/", 
       RowBox[{"Tr", "[", "out", "]"}]}]}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"norm", "[", "state_", "]"}], ":=", 
   RowBox[{"state", "/", 
    RowBox[{"Tr", "[", "state", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"transform", "[", 
     RowBox[{"state_", ",", "U_"}], "]"}], ":=", 
    RowBox[{"U", ".", "state", ".", 
     RowBox[{"U", "\[ConjugateTranspose]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"measureOut", "[", "state_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"KP", "[", 
      RowBox[{
       SubscriptBox["\[ScriptCapitalP]", "0"], ",", 
       SubscriptBox["\[Sigma]", "0"]}], "]"}], ".", "state", ".", 
     RowBox[{
      RowBox[{"KP", "[", 
       RowBox[{
        SubscriptBox["\[ScriptCapitalP]", "0"], ",", 
        SubscriptBox["\[Sigma]", "0"]}], "]"}], "\[ConjugateTranspose]"}]}], 
    "+", 
    RowBox[{
     RowBox[{"KP", "[", 
      RowBox[{
       SubscriptBox["\[ScriptCapitalP]", "1"], ",", 
       SubscriptBox["\[Sigma]", "0"]}], "]"}], ".", "state", ".", 
     RowBox[{
      RowBox[{"KP", "[", 
       RowBox[{
        SubscriptBox["\[ScriptCapitalP]", "1"], ",", 
        SubscriptBox["\[Sigma]", "0"]}], "]"}], 
      "\[ConjugateTranspose]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"measureOutAndBranch", "[", 
    RowBox[{"state_", ",", "U0_", ",", "U1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"U0", ".", 
     RowBox[{"KP", "[", 
      RowBox[{
       SubscriptBox["\[ScriptCapitalP]", "0"], ",", 
       SubscriptBox["\[Sigma]", "0"]}], "]"}], ".", "state", ".", 
     RowBox[{
      RowBox[{"KP", "[", 
       RowBox[{
        SubscriptBox["\[ScriptCapitalP]", "0"], ",", 
        SubscriptBox["\[Sigma]", "0"]}], "]"}], "\[ConjugateTranspose]"}], 
     ".", 
     RowBox[{"U0", "\[ConjugateTranspose]"}]}], "+", 
    RowBox[{"U1", ".", 
     RowBox[{"KP", "[", 
      RowBox[{
       SubscriptBox["\[ScriptCapitalP]", "1"], ",", 
       SubscriptBox["\[Sigma]", "0"]}], "]"}], ".", "state", ".", 
     RowBox[{
      RowBox[{"KP", "[", 
       RowBox[{
        SubscriptBox["\[ScriptCapitalP]", "1"], ",", 
        SubscriptBox["\[Sigma]", "0"]}], "]"}], "\[ConjugateTranspose]"}], 
     ".", 
     RowBox[{"U1", "\[ConjugateTranspose]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6820569126877956`*^9, 3.6820569377273917`*^9}, {
  3.6820570249227343`*^9, 3.682057027220744*^9}, {3.6821590086672306`*^9, 
  3.6821590091332774`*^9}, {3.682159316345996*^9, 3.682159329170278*^9}, {
  3.6821593644498053`*^9, 3.68215945800316*^9}, {3.682160352902641*^9, 
  3.6821604143177814`*^9}, {3.6860305407356577`*^9, 3.6860305623748007`*^9}, {
  3.68603476909194*^9, 3.6860347726401587`*^9}, {3.68613817948212*^9, 
  3.686138179891822*^9}, {3.6864809653331003`*^9, 3.686480966531604*^9}, {
  3.68700873750569*^9, 3.687008804528399*^9}, {3.687008894092257*^9, 
  3.68700892926888*^9}, {3.687011129568685*^9, 3.687011142880721*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Single", " ", "qubit", " ", "gates"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "rxp", ",", "rXp", ",", "ryp", ",", "rYp", ",", "rzp", ",", "rZp"}], 
      "}"}], "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"AF", "[", 
        RowBox[{"MatrixExp", "[", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], "*", 
          SubscriptBox["\[Sigma]", 
           RowBox[{
            RowBox[{"Floor", "[", 
             RowBox[{
              RowBox[{"j", "/", "2"}], "-", "0.01"}], "]"}], "+", "1"}]], "*", 
          RowBox[{"\[Pi]", "/", 
           RowBox[{"(", 
            RowBox[{"2", "*", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"Mod", "[", 
                RowBox[{"j", ",", "2"}], "]"}]}], ")"}]}], ")"}]}]}], "]"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "rxm", ",", "rXm", ",", "rym", ",", "rYm", ",", "rzm", ",", "rZm"}], 
      "}"}], "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"AF", "[", 
        RowBox[{"MatrixExp", "[", 
         RowBox[{"\[ImaginaryI]", "*", 
          SubscriptBox["\[Sigma]", 
           RowBox[{
            RowBox[{"Floor", "[", 
             RowBox[{
              RowBox[{"j", "/", "2"}], "-", "0.01"}], "]"}], "+", "1"}]], "*", 
          RowBox[{"\[Pi]", "/", 
           RowBox[{"(", 
            RowBox[{"2", "*", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"Mod", "[", 
                RowBox[{"j", ",", "2"}], "]"}]}], ")"}]}], ")"}]}]}], "]"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"rThetaX", "[", "\[Theta]_", "]"}], "=", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], "*", 
       SubscriptBox["\[Sigma]", "1"], "*", 
       RowBox[{"\[Theta]", "/", "2"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"rThetaY", "[", "\[Theta]_", "]"}], "=", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], "*", 
       SubscriptBox["\[Sigma]", "2"], "*", 
       RowBox[{"\[Theta]", "/", "2"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"rThetaZ", "[", "\[Theta]_", "]"}], "=", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], "*", 
       SubscriptBox["\[Sigma]", "3"], "*", 
       RowBox[{"\[Theta]", "/", "2"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"rTheta\[Phi]", "[", 
      RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "]"}], "=", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", "\[Phi]", "]"}], 
           SubscriptBox["\[Sigma]", "1"], "*", "\[Theta]"}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", "\[Phi]", "]"}], 
           SubscriptBox["\[Sigma]", "2"], "*", "\[Theta]"}]}], ")"}], "/", 
        "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.6820569780485454`*^9, 3.68205699898563*^9}, {
   3.686130428009943*^9, 3.686130490495379*^9}, {3.6861317876502028`*^9, 
   3.686131794850554*^9}, 3.6861381755451612`*^9}],

Cell["Our nuclear spin parameters for both setups:", "Text",
 CellChangeTimes->{{3.6400656951694546`*^9, 3.6400657009570336`*^9}, {
  3.6815398155346937`*^9, 3.681539819639515*^9}, {3.6815399028051443`*^9, 
  3.6815399042754383`*^9}},
 Background->GrayLevel[0.85]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "LT3", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Omega]L3", " ", "=", " ", 
     RowBox[{"2", "*", "\[Pi]", "*", "447747.11"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"wL31", "=", 
     RowBox[{"2", "*", "\[Pi]", "*", "425341.4"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Aperp3", " ", "=", 
     RowBox[{"2", "*", "\[Pi]", "*", 
      RowBox[{"(", "87.5", ")"}], "*", 
      SuperscriptBox["10", "3"]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Apar3", " ", "=", " ", 
     RowBox[{
      RowBox[{"-", "2"}], "*", "\[Pi]", "*", 
      RowBox[{"(", "30.0", ")"}], "*", 
      SuperscriptBox["10", "3"]}]}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"par3", " ", "=", " ", 
     RowBox[{"\[Omega]L3", "+", "Apar3"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LT3WrongRotate", " ", "=", "  ", "True"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "LT4", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Omega]L4", " ", "=", " ", 
     RowBox[{"2", "\[Pi]", " ", 
      TagBox["443172.12",
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Omega]L41", "=", 
     RowBox[{"2", "\[Pi]", " ", "416572.34"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Aperp4", " ", "=", 
     RowBox[{"2", "*", "\[Pi]", "*", 
      RowBox[{"(", "35.0", ")"}], "*", 
      SuperscriptBox["10", "3"]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Apar4", " ", "=", 
     RowBox[{
      RowBox[{"-", "2"}], "*", "\[Pi]", "*", 
      RowBox[{"(", "33.0", ")"}], "*", 
      SuperscriptBox["10", "3"]}]}], " ", ";", " ", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"because", " ", "we", " ", "use", " ", "the"}], " ", "-", 
      RowBox[{"1", " ", "transition", " ", "here"}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"par4", "=", 
     RowBox[{"Apar4", "+", "\[Omega]L4"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"carbon", " ", "parameters", " ", "as", " ", "a", " ", "list"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LT3C", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"\[Omega]L3", ",", 
       RowBox[{"par3", "-", "545.2"}], ",", "Aperp3"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"LT3C", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "=", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", "wL31", " ", ")"}], "^", "2"}], "-", 
       RowBox[{
        RowBox[{"LT3C", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}], "]"}]}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{
     "Gate", " ", "parameters", " ", "have", " ", "to", " ", "be", " ", 
      "slightly", " ", "adjusted"}], "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"LT4C", "=", 
     RowBox[{"{", 
      RowBox[{"\[Omega]L4", ",", 
       RowBox[{"par4", "+", "34349.1"}], ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"LT4C", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "=", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", "\[Omega]L41", ")"}], "^", "2"}], "-", 
       RowBox[{
        RowBox[{"LT4C", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}], "]"}]}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{
     "Gate", " ", "parameters", " ", "have", " ", "to", " ", "be", " ", 
      "slightly", " ", "adjusted"}], "*)"}], 
    "\[IndentingNewLine]"}]}]}]], "Input",
 CellChangeTimes->{{3.639975490485084*^9, 3.639975562071084*^9}, {
   3.639975621566084*^9, 3.639975661670084*^9}, {3.64006568671661*^9, 
   3.640065714462384*^9}, {3.681539863666318*^9, 3.681539875001585*^9}, {
   3.6815399063358507`*^9, 3.6815399173350496`*^9}, {3.6815488838119154`*^9, 
   3.681548972608794*^9}, {3.68154913808534*^9, 3.6815491819317245`*^9}, {
   3.681550551010618*^9, 3.681550578058323*^9}, {3.681550757697285*^9, 
   3.681550765100025*^9}, {3.6815509285603695`*^9, 3.6815509416856823`*^9}, {
   3.681551720604566*^9, 3.6815517215776634`*^9}, {3.681551781180623*^9, 
   3.6815517814926543`*^9}, {3.681552585448042*^9, 3.681552607409238*^9}, {
   3.6815526515896554`*^9, 3.6815526516586623`*^9}, {3.681553000262519*^9, 
   3.6815530011806107`*^9}, {3.681553117051197*^9, 3.681553129174409*^9}, {
   3.681553601056593*^9, 3.68155360822631*^9}, {3.6815536687223587`*^9, 
   3.6815537024867344`*^9}, {3.6815584817006273`*^9, 
   3.6815584977862353`*^9}, {3.681561083852816*^9, 3.6815610872471557`*^9}, {
   3.6820559074241953`*^9, 3.682055979817479*^9}, {3.682056035732193*^9, 
   3.682056105954951*^9}, {3.6820638808986716`*^9, 3.682063958638672*^9}, {
   3.682939012289318*^9, 3.68293903870996*^9}, 3.682939085290618*^9, {
   3.6829391587829666`*^9, 3.6829391731754055`*^9}, {3.68293929833492*^9, 
   3.6829393029253793`*^9}, {3.6829399311911993`*^9, 3.682939949985079*^9}, {
   3.68603025181697*^9, 3.6860302843581448`*^9}, {3.6860314053084297`*^9, 
   3.686031411164893*^9}, {3.68629902277129*^9, 3.68629907231426*^9}, {
   3.686367987763048*^9, 3.686367996185207*^9}, {3.686369131315404*^9, 
   3.686369141655527*^9}, {3.686369174185521*^9, 3.686369245028385*^9}, {
   3.6863693016487627`*^9, 3.686369313348743*^9}, {3.686370597627808*^9, 
   3.6863706020774117`*^9}, {3.686372459111189*^9, 3.686372459294368*^9}, {
   3.686374535829815*^9, 3.686374539924975*^9}, {3.6864737394758863`*^9, 
   3.68647373996214*^9}, {3.6864836463050528`*^9, 3.686483700179051*^9}, {
   3.6864837920518227`*^9, 3.686483802782875*^9}, 3.686483833468547*^9, {
   3.68648394285966*^9, 3.6864839829862413`*^9}, {3.686484309369545*^9, 
   3.686484337886166*^9}, 3.686484569062681*^9, {3.686484881074525*^9, 
   3.686484886904922*^9}, {3.686485280579234*^9, 3.68648528990471*^9}, 
   3.686485417435267*^9, {3.686550609274066*^9, 3.686550611286086*^9}, {
   3.686628811233081*^9, 3.68662891335424*^9}, {3.686628958256609*^9, 
   3.6866289593557053`*^9}, {3.687006464934513*^9, 3.687006530249506*^9}, {
   3.687006591310607*^9, 3.687006598581407*^9}, {3.68700667288946*^9, 
   3.687006691692861*^9}, {3.6870627592790422`*^9, 3.687062777673277*^9}, {
   3.6883020830166187`*^9, 3.688302083825285*^9}, {3.688302154024576*^9, 
   3.688302154473772*^9}}],

Cell["The system Hamiltonian with NV and Carbon reads", "Text",
 CellChangeTimes->{{3.6399755680810843`*^9, 3.6399755845560837`*^9}},
 Background->GrayLevel[0.85]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Usys", "[", 
    RowBox[{"t_", ",", 
     RowBox[{"{", 
      RowBox[{"\[Omega]_", ",", "par_", ",", "Aperp_"}], "}"}]}], "]"}], " ", 
   ":=", " ", 
   RowBox[{"MatrixExp", "[", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", 
     RowBox[{"t", "/", "2"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Omega]", " ", 
        RowBox[{"KP", "[", 
         RowBox[{
          SubscriptBox["\[ScriptCapitalP]", "0"], ",", 
          SubscriptBox["\[Sigma]", "3"]}], "]"}]}], "+", 
       RowBox[{"KP", "[", 
        RowBox[{
         SubscriptBox["\[ScriptCapitalP]", "1"], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"par", " ", 
            SubscriptBox["\[Sigma]", "3"]}], "+", 
           RowBox[{"Aperp", "*", 
            SubscriptBox["\[Sigma]", "1"]}]}], ")"}]}], "]"}]}], ")"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.639975587105084*^9, 3.6399755881410837`*^9}, {
   3.639975682377084*^9, 3.6399757358570843`*^9}, {3.639975828252084*^9, 
   3.639975850629084*^9}, {3.639978135059428*^9, 3.6399781370376263`*^9}, {
   3.639978410421962*^9, 3.63997841130005*^9}, {3.640065717903728*^9, 
   3.6400657198289204`*^9}, {3.6815506078563023`*^9, 3.681550656823199*^9}, {
   3.6815509771142244`*^9, 3.6815510427567883`*^9}, 3.6815513062261324`*^9, {
   3.6820562689990487`*^9, 3.682056269109049*^9}, {3.6861310328694057`*^9, 
   3.686131053269607*^9}, {3.686131095957088*^9, 3.686131167792658*^9}, {
   3.6861316002682123`*^9, 3.6861316065686207`*^9}, {3.686131847269639*^9, 
   3.686131847960327*^9}, {3.686141023683126*^9, 3.6861410238711853`*^9}, {
   3.6862990132743053`*^9, 3.686299033663639*^9}, {3.686299081614915*^9, 
   3.686299081812729*^9}, {3.68647638667981*^9, 3.686476407429545*^9}, {
   3.686484743458887*^9, 3.686484777390171*^9}, {3.686484849420765*^9, 
   3.686484849608947*^9}, {3.6864854348069897`*^9, 3.6864854869417133`*^9}, {
   3.686486206558865*^9, 3.6864862163469954`*^9}, 3.6865608364001293`*^9, {
   3.686560913335597*^9, 3.686560913728051*^9}, 3.686562698695468*^9, 
   3.686563023392872*^9}],

Cell["Import the pulse sequences", "Text",
 CellChangeTimes->{{3.6399755680810843`*^9, 3.6399755845560837`*^9}, {
  3.6861294318956947`*^9, 3.68612943755676*^9}},
 Background->GrayLevel[0.85]],

Cell[BoxData[
 RowBox[{
  RowBox[{"getPulses", "[", 
   RowBox[{"basedir_", ",", "measname_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "filename", ",", "x", ",", "attrs", ",", "seqOverview", ",", 
      "PulseSeqs"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"filename", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"FileExtension", "[", "\"\<filename\>\"", "]"}], "\[Equal]", 
         "\"\<\>\""}], ",", 
        RowBox[{"measname", "<>", "\"\<.h5\>\""}], ",", "measname"}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"seqOverview", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"attrs", "=", 
      RowBox[{"{", 
       RowBox[{
       "\"\<seq_overview/name\>\"", ",", "\"\<seq_overview/trigger_wait\>\"", 
        ",", "\"\<seq_overview/goto_target\>\"", ",", 
        "\"\<seq_overview/jump_target\>\"", ",", 
        "\"\<seq_overview/final_time\>\""}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"x", "=", "1"}], ",", 
       RowBox[{"x", "\[LessEqual]", 
        RowBox[{
         RowBox[{"Dimensions", "[", "attrs", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"x", "++"}], ",", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"seqOverview", ",", 
         RowBox[{"Import", "[", 
          RowBox[{
           RowBox[{"basedir", "<>", "filename"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<Datasets\>\"", ",", 
             RowBox[{"attrs", "[", 
              RowBox[{"[", "x", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"seqOverview", "=", 
      RowBox[{"Transpose", "[", "seqOverview", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"PulseSeqs", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"x", "=", "0"}], ",", 
       RowBox[{"x", "<", 
        RowBox[{
         RowBox[{"Dimensions", "[", "seqOverview", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"x", "++"}], ",", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"PulseSeqs", ",", 
         RowBox[{"Import", "[", 
          RowBox[{
           RowBox[{"basedir", "<>", "filename"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<Datasets\>\"", ",", 
             RowBox[{"\"\<pulses/\>\"", "<>", 
              RowBox[{"ToString", "[", "x", "]"}]}]}], "}"}]}], "]"}]}], 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"seqOverview", "=", 
      RowBox[{"Transpose", "[", "seqOverview", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Transpose", "[", "seqOverview", "]"}], ",", "PulseSeqs"}], 
       "}"}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.686211720789049*^9, 3.686211726786645*^9}, 
   3.6862828601846113`*^9, {3.686288355779913*^9, 3.6862884552411547`*^9}, {
   3.686288495890192*^9, 3.686288501935465*^9}, {3.686288544994197*^9, 
   3.686288548527504*^9}, {3.686288606978684*^9, 3.686288619812045*^9}, {
   3.6862886824588833`*^9, 3.686288713462883*^9}, {3.6862896323577003`*^9, 
   3.686289636220661*^9}, {3.686291068277831*^9, 3.6862910684581423`*^9}, {
   3.686483378722045*^9, 3.686483378736537*^9}, {3.686633964623516*^9, 
   3.686633964740864*^9}, {3.68663399888442*^9, 3.686633999076757*^9}, {
   3.68709013688632*^9, 3.687090193549951*^9}, {3.6870909969777927`*^9, 
   3.6870910811229277`*^9}, {3.687091127831182*^9, 3.687091224495386*^9}, {
   3.687091258574121*^9, 3.68709126126654*^9}, {3.6870913062176657`*^9, 
   3.687091310334503*^9}, {3.687091588282503*^9, 3.6870915884147663`*^9}, {
   3.687091653654723*^9, 3.687091657502467*^9}, {3.687091701246519*^9, 
   3.687091705067402*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "basedirLT4", " ", "=", " ", 
   "\"\</Users/humphreys/Repositories/personal_calcs/Work/Modelling/PulseSim/\
LT4/\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "basedirLT3", " ", "=", " ", 
   "\"\</Users/humphreys/Repositories/personal_calcs/Work/Modelling/PulseSim/\
LT3/\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "basedirLT3w", " ", "=", " ", 
   "\"\</Users/humphreys/Repositories/personal_calcs/Work/Modelling/PulseSim/\
LT3w/\>\""}], ";"}]}], "Input",
 CellChangeTimes->{{3.6862885356390047`*^9, 3.68628853950173*^9}, 
   3.686288623418057*^9, {3.686483378746767*^9, 3.686483393252334*^9}, {
   3.6864840180742273`*^9, 3.686484021600397*^9}, {3.687060911067515*^9, 
   3.687060914971883*^9}}],

Cell["\<\
Compiler!

Each pulse has a few params:
1.) Centre of pulse
2.) Pulse duration (less useful here)
3.) Phase angle of pulse - for some reason, in the compiled sequences, 0 \
encodes Y gate, \[Pi]/2 encodes X gate, 3 \[Pi]/2 encodes - X gate, \[Pi] \
encodes - Y gate
4.) The rotation angle (basically pi/2 or pi)
5.) Special. 1 is repump, 2 is readout (readout is not implemented in all of \
the datasets, but is also not necessary)

The pulse seq also has some extra data, like what it jumps to, and most \
importantly, the total length of the pulse sequence.\
\>", "Text",
 CellChangeTimes->{{3.6399755680810843`*^9, 3.6399755845560837`*^9}, {
  3.6861294318956947`*^9, 3.68612943755676*^9}, {3.686571494125465*^9, 
  3.686571618760818*^9}},
 Background->GrayLevel[0.85]],

Cell[BoxData[
 RowBox[{
  RowBox[{"compiledPulse", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Omega]_", ",", "Apar_", ",", "Aperp_"}], "}"}], ",", 
    "pulseData_", ",", 
    RowBox[{"RotateOtherWay_:", "False"}], ",", 
    RowBox[{"ignoreFinal_:", "False"}], ",", 
    RowBox[{"triggerReadout_:", "False"}], ",", 
    RowBox[{"readoutVal_:", "0"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "i", ",", "numPulses", ",", "evMat", ",", "pulseMat", ",", "pulseDelay", 
      ",", "compiledPulse"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"numPulses", "=", 
      RowBox[{
       RowBox[{"Dimensions", "[", 
        RowBox[{"pulseData", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"compiledPulse", "=", 
      RowBox[{"IdentityMatrix", "[", "4", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "<=", "numPulses"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pulseDelay", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", "\[Equal]", "1"}], ",", " ", 
           RowBox[{"pulseData", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "i", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"pulseData", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "i", ",", "1"}], "]"}], "]"}], "-", 
             RowBox[{"pulseData", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", 
                RowBox[{"i", "-", "1"}], ",", "1"}], "]"}], "]"}]}], ")"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"evMat", "=", 
         RowBox[{"Usys", "[", 
          RowBox[{"pulseDelay", ",", 
           RowBox[{"{", 
            RowBox[{"\[Omega]", ",", "Apar", ",", "Aperp"}], "}"}]}], "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"pulseMat", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pulseData", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "i", ",", "5"}], "]"}], "]"}], "\[Equal]", 
            "0"}], ",", 
           RowBox[{"KP", "[", 
            RowBox[{
             RowBox[{"rTheta\[Phi]", "[", 
              RowBox[{
               RowBox[{"pulseData", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "i", ",", "4"}], "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{"RotateOtherWay", ",", 
                  RowBox[{"-", "1"}], ",", "1"}], "]"}], 
                RowBox[{"(", " ", 
                 RowBox[{
                  RowBox[{"\[Pi]", "/", "2"}], "-", 
                  RowBox[{"pulseData", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "i", ",", "3"}], "]"}], "]"}]}], 
                 ")"}]}]}], "]"}], ",", 
             SubscriptBox["\[Sigma]", "0"]}], "]"}], ",", 
           RowBox[{
            RowBox[{"pulseData", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "i", ",", "5"}], "]"}], "]"}], "\[Equal]", 
            "1"}], ",", 
           RowBox[{"KP", "[", 
            RowBox[{
             SubscriptBox["\[ScriptCapitalP]", "0"], ",", 
             SubscriptBox["\[Sigma]", "0"]}], "]"}], ",", 
           RowBox[{
            RowBox[{"pulseData", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "i", ",", "5"}], "]"}], "]"}], "\[Equal]", 
            "2"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{"triggerReadout", ",", 
             RowBox[{"KP", "[", 
              RowBox[{
               SubscriptBox["\[ScriptCapitalP]", "readoutVal"], ",", 
               SubscriptBox["\[Sigma]", "0"]}], "]"}], ",", 
             RowBox[{"KP", "[", 
              RowBox[{
               SubscriptBox["\[Sigma]", "0"], ",", 
               SubscriptBox["\[Sigma]", "0"]}], "]"}]}], "]"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"compiledPulse", "=", 
         RowBox[{"pulseMat", ".", "evMat", ".", "compiledPulse"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"pulseDelay", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", "ignoreFinal", "]"}], ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"pulseData", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "5"}], "]"}], "]"}], "-", 
          RowBox[{"pulseData", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", 
             RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], ")"}], ",", 
        "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"compiledPulse", "=", 
      RowBox[{
       RowBox[{"Usys", "[", 
        RowBox[{"pulseDelay", ",", 
         RowBox[{"{", 
          RowBox[{"\[Omega]", ",", "Apar", ",", "Aperp"}], "}"}]}], "]"}], 
       ".", "compiledPulse"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "compiledPulse", "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 CellChangeTimes->{{3.6861302914277363`*^9, 3.686130381635577*^9}, {
   3.686130691995265*^9, 3.6861307894292727`*^9}, {3.686130824373376*^9, 
   3.686130846130333*^9}, {3.686131193345839*^9, 3.686131540012273*^9}, {
   3.686131576027671*^9, 3.686131579163169*^9}, {3.6861316261476307`*^9, 
   3.68613166649596*^9}, {3.686131714833537*^9, 3.686131737112486*^9}, 
   3.6861317707355757`*^9, {3.686131828757794*^9, 3.6861318424517508`*^9}, {
   3.686131920417536*^9, 3.686131927182706*^9}, {3.686131979020537*^9, 
   3.686132099299556*^9}, {3.686132835346424*^9, 3.686132844614297*^9}, {
   3.686132920655469*^9, 3.6861329770500593`*^9}, 3.686133019632258*^9, {
   3.686133059914732*^9, 3.686133097645472*^9}, {3.686133700988481*^9, 
   3.6861337559591093`*^9}, {3.686133790990069*^9, 3.686133833566687*^9}, 
   3.686134702476997*^9, {3.686134781405855*^9, 3.6861347831915617`*^9}, {
   3.6861352210021276`*^9, 3.686135222787099*^9}, {3.6861354630051126`*^9, 
   3.686135476577721*^9}, {3.686136505994166*^9, 3.686136565760232*^9}, 
   3.686136635635705*^9, 3.686136724591267*^9, {3.686141611689477*^9, 
   3.6861416403835487`*^9}, {3.686142825103278*^9, 3.6861430328666058`*^9}, {
   3.686143083593689*^9, 3.6861430837482557`*^9}, {3.686143234992916*^9, 
   3.6861432358984823`*^9}, {3.686211975838749*^9, 3.6862119909087563`*^9}, {
   3.686212144404457*^9, 3.686212174314427*^9}, {3.686221524987145*^9, 
   3.6862215502566557`*^9}, {3.686221622452929*^9, 3.6862216418829412`*^9}, {
   3.686221697921959*^9, 3.686221698474834*^9}, {3.686222038845096*^9, 
   3.686222039456493*^9}, {3.686222524988083*^9, 3.6862225256756487`*^9}, {
   3.686222590428809*^9, 3.686222590886241*^9}, {3.686222628836953*^9, 
   3.68622262911773*^9}, {3.686225001906852*^9, 3.6862250024155483`*^9}, {
   3.686225171741005*^9, 3.686225171926704*^9}, {3.686225252464407*^9, 
   3.6862252528214808`*^9}, {3.6862889558527822`*^9, 3.686289057405116*^9}, {
   3.686291059828005*^9, 3.686291060038043*^9}, {3.686294065213243*^9, 
   3.686294102856956*^9}, {3.6862956437075377`*^9, 3.686295683253764*^9}, {
   3.6862958291602087`*^9, 3.686295874799951*^9}, 3.686295918734364*^9, {
   3.686296007867692*^9, 3.686296099147546*^9}, {3.6862962429959173`*^9, 
   3.686296328103855*^9}, {3.6862963745077*^9, 3.686296376109962*^9}, 
   3.686303541559915*^9, {3.6863056589890337`*^9, 3.6863057130591373`*^9}, {
   3.686369644540846*^9, 3.686369645931576*^9}, {3.686474877728237*^9, 
   3.68647487992561*^9}, {3.686475260897175*^9, 3.686475269350809*^9}, 
   3.686476020699135*^9, 3.6864859770211897`*^9, {3.68648601286942*^9, 
   3.6864860621165752`*^9}, {3.6865477210798063`*^9, 3.686547763290852*^9}, {
   3.68654782878093*^9, 3.686547871534986*^9}, {3.686547997233214*^9, 
   3.6865480177510347`*^9}, {3.686548504491705*^9, 3.6865485104972563`*^9}, {
   3.686548555925095*^9, 3.686548556120254*^9}, {3.686628597572358*^9, 
   3.6866286106665087`*^9}, {3.686635595167913*^9, 3.6866355954925528`*^9}, {
   3.688301957411685*^9, 3.688301960458897*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.68663561970059*^9}],

Cell["\<\
I just wrote this, it tries to keep track of the phase during a pulse \
sequence (for human readability)\
\>", "Text",
 CellChangeTimes->{{3.6399755680810843`*^9, 3.6399755845560837`*^9}, {
  3.6861294318956947`*^9, 3.68612943755676*^9}, {3.686571494125465*^9, 
  3.6865716518959312`*^9}},
 Background->GrayLevel[0.85]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"URot", "[", 
    RowBox[{"t_", ",", 
     RowBox[{"{", 
      RowBox[{"\[Omega]_", ",", "par_", ",", "Aperp_"}], "}"}], ",", 
     "eState_"}], "]"}], " ", ":=", " ", 
   RowBox[{"MatrixExp", "[", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", 
     RowBox[{"t", "/", "2"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Omega]", " ", 
        RowBox[{"Tr", "[", 
         RowBox[{
          SubscriptBox["\[ScriptCapitalP]", "0"], ".", "eState"}], "]"}], 
        SubscriptBox["\[Sigma]", "3"]}], "+", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{"par", "^", "2"}], " ", "+", 
          RowBox[{"Aperp", "^", "2"}]}], "]"}], 
        RowBox[{"Tr", "[", 
         RowBox[{
          SubscriptBox["\[ScriptCapitalP]", "1"], ".", "eState"}], "]"}], 
        SubscriptBox["\[Sigma]", "3"]}]}], ")"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6866356899313107`*^9, 3.686635729687537*^9}, {
  3.686636397530941*^9, 3.686636464535001*^9}, {3.686636497208712*^9, 
  3.686636509367662*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "compiledRotMat", "]"}]], "Input",
 CellChangeTimes->{{3.686638828335224*^9, 3.686638830421597*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"compiledRotMat", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Omega]_", ",", "Apar_", ",", "Aperp_"}], "}"}], ",", 
    "pulseData_", ",", "inputEState_", ",", 
    RowBox[{"refState_:", 
     RowBox[{
      SubscriptBox["\[Sigma]", "0"], "/", "2"}]}], ",", 
    RowBox[{"ignoreFinal_:", "False"}], ",", 
    RowBox[{"triggerReadout_:", "False"}], ",", 
    RowBox[{"readoutVal_:", "0"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "i", ",", "numPulses", ",", "evMat", ",", "eState", ",", "refRotMat", 
      ",", "pulseMat", ",", "pulseDelay", ",", "compiledPulse"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"numPulses", "=", 
      RowBox[{
       RowBox[{"Dimensions", "[", 
        RowBox[{"pulseData", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"compiledPulse", "=", 
      RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"eState", "=", "inputEState"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "<=", "numPulses"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pulseDelay", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", "\[Equal]", "1"}], ",", " ", 
           RowBox[{"pulseData", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "i", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"pulseData", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "i", ",", "1"}], "]"}], "]"}], "-", 
             RowBox[{"pulseData", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", 
                RowBox[{"i", "-", "1"}], ",", "1"}], "]"}], "]"}]}], ")"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"evMat", "=", 
         RowBox[{"URot", "[", 
          RowBox[{"pulseDelay", ",", 
           RowBox[{"{", 
            RowBox[{"\[Omega]", ",", "Apar", ",", "Aperp"}], "}"}], ",", 
           "eState"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"compiledPulse", "=", 
         RowBox[{"evMat", ".", "compiledPulse"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"pulseMat", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pulseData", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "i", ",", "5"}], "]"}], "]"}], "\[Equal]", 
            "0"}], ",", 
           RowBox[{"rTheta\[Phi]", "[", 
            RowBox[{
             RowBox[{"pulseData", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "i", ",", "4"}], "]"}], "]"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Pi]", "/", "2"}], "-", 
               RowBox[{"pulseData", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "i", ",", "3"}], "]"}], "]"}]}], ")"}]}], 
            "]"}], ",", 
           RowBox[{
            RowBox[{"pulseData", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "i", ",", "5"}], "]"}], "]"}], "\[Equal]", 
            "1"}], ",", 
           SubscriptBox["\[ScriptCapitalP]", "0"], ",", 
           RowBox[{
            RowBox[{"pulseData", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "i", ",", "5"}], "]"}], "]"}], "\[Equal]", 
            "2"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{"triggerReadout", ",", 
             SubscriptBox["\[ScriptCapitalP]", "readoutVal"], ",", 
             SubscriptBox["\[Sigma]", "0"]}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"eState", "=", 
         RowBox[{"pulseMat", ".", "eState", ".", 
          RowBox[{"pulseMat", "\[ConjugateTranspose]"}]}]}], ";"}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pulseDelay", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", "ignoreFinal", "]"}], ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"pulseData", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "5"}], "]"}], "]"}], "-", 
          RowBox[{"pulseData", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", 
             RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], ")"}], ",", 
        "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"compiledPulse", "=", 
      RowBox[{
       RowBox[{"URot", "[", 
        RowBox[{"pulseDelay", ",", 
         RowBox[{"{", 
          RowBox[{"\[Omega]", ",", "Apar", ",", "Aperp"}], "}"}], ",", 
         "eState"}], "]"}], ".", "compiledPulse"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"refState", "!=", 
        RowBox[{
         SubscriptBox["\[Sigma]", "0"], "/", "2"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"refRotMat", "=", 
         RowBox[{"rThetaZ", "[", 
          RowBox[{"ArcTan", "[", 
           RowBox[{
            RowBox[{"Re", "[", 
             RowBox[{"Tr", "[", 
              RowBox[{
               SubscriptBox["\[Sigma]", "1"], ".", "refState"}], "]"}], "]"}],
             ",", 
            RowBox[{"Re", "[", 
             RowBox[{"Tr", "[", 
              RowBox[{
               SubscriptBox["\[Sigma]", "2"], ".", "refState"}], "]"}], 
             "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"compiledPulse", "=", 
         RowBox[{"refRotMat", ".", "compiledPulse"}]}], ";"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "compiledPulse", "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 CellChangeTimes->{{3.686635649860989*^9, 3.686635675554968*^9}, {
   3.6866357517086277`*^9, 3.68663575299683*^9}, {3.686635805323681*^9, 
   3.68663584035979*^9}, {3.6866364139187183`*^9, 3.686636418794579*^9}, {
   3.6866365269277477`*^9, 3.6866365997264338`*^9}, {3.686636801998457*^9, 
   3.6866368437211933`*^9}, {3.68663695487236*^9, 3.686637000223687*^9}, {
   3.686637554482676*^9, 3.686637563372553*^9}, {3.6866383144763308`*^9, 
   3.6866383576082*^9}, {3.686638577135857*^9, 3.686638611099053*^9}, {
   3.686638677305879*^9, 3.686638709961149*^9}, {3.686638784881757*^9, 
   3.686638801174698*^9}, {3.686638860933326*^9, 3.686638877528014*^9}, {
   3.686638960093734*^9, 3.686638969859763*^9}, 3.686638999959023*^9, {
   3.686639076538629*^9, 3.6866390835390787`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"phaseEvolution", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Omega]_", ",", "Apar_", ",", "Aperp_"}], "}"}], ",", 
     "pulseData_", ",", "inputEstate_", ",", 
     RowBox[{"inPhase_:", "0"}], ",", 
     RowBox[{"ignoreFinal_:", "False"}], ",", 
     RowBox[{"triggerReadout_:", "False"}], ",", 
     RowBox[{"readoutVal_:", "0"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "i", ",", "numPulses", ",", "estate", ",", "PhaseTerm", ",", 
       "finalPhaseTerm", ",", "pulseMat", ",", "pulseDelay", ",", "rotFact"}],
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"numPulses", "=", 
       RowBox[{
        RowBox[{"Dimensions", "[", 
         RowBox[{"pulseData", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"estate", "=", "inputEstate"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "<=", "numPulses"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"pulseDelay", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"i", "\[Equal]", "1"}], ",", " ", 
            RowBox[{"pulseData", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "i", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"pulseData", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "i", ",", "1"}], "]"}], "]"}], "-", 
              RowBox[{"pulseData", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", 
                 RowBox[{"i", "-", "1"}], ",", "1"}], "]"}], "]"}]}], ")"}]}],
            "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"rotFact", "=", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", 
            RowBox[{"pulseDelay", "/", "2"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Omega]", " ", 
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{"estate", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "^", "2"}]}],
               "+", 
              RowBox[{
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{"estate", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "1"}], "]"}], "]"}], "]"}], "^", "2"}], 
               RowBox[{"Sqrt", "[", 
                RowBox[{
                 RowBox[{"Apar", "^", "2"}], "+", 
                 RowBox[{"Aperp", "^", "2"}]}], "]"}]}]}], ")"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"PhaseTerm", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"i", "\[Equal]", "1"}], ",", 
            RowBox[{"PhaseTerm", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "\[ImaginaryI]"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"\[Pi]", "/", "180"}], ")"}], "inPhase"}], " ", 
                "]"}], "rotFact"}], "}"}]}], ",", 
            RowBox[{"Append", "[", 
             RowBox[{"PhaseTerm", " ", ",", 
              RowBox[{
               RowBox[{"PhaseTerm", " ", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}], "rotFact"}]}], "]"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"pulseMat", "=", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"pulseData", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "i", ",", "5"}], "]"}], "]"}], "\[Equal]", 
             "0"}], ",", 
            RowBox[{"rTheta\[Phi]", "[", 
             RowBox[{
              RowBox[{"pulseData", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "i", ",", "4"}], "]"}], "]"}], ",", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Pi]", "/", "2"}], "-", 
                RowBox[{"pulseData", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "i", ",", "3"}], "]"}], "]"}]}], ")"}]}], 
             "]"}], ",", 
            RowBox[{
             RowBox[{"pulseData", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "i", ",", "5"}], "]"}], "]"}], "\[Equal]", 
             "1"}], ",", 
            SubscriptBox["\[ScriptCapitalP]", "0"], ",", 
            RowBox[{
             RowBox[{"pulseData", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "i", ",", "5"}], "]"}], "]"}], "\[Equal]", 
             "2"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{"triggerReadout", ",", 
              SubscriptBox["\[ScriptCapitalP]", "readoutVal"], ",", 
              SubscriptBox["\[Sigma]", "0"]}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"estate", "=", 
          RowBox[{"pulseMat", ".", "estate"}]}], ";"}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pulseDelay", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Not", "[", "ignoreFinal", "]"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"pulseData", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "5"}], "]"}], "]"}], "-", 
           RowBox[{"pulseData", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", 
              RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], ")"}], ",", 
         "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rotFact", "=", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", 
         RowBox[{"pulseDelay", "/", "2"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Omega]", " ", 
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"estate", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "^", "2"}]}], 
           "+", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"estate", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "1"}], "]"}], "]"}], "]"}], "^", "2"}], 
            RowBox[{"Sqrt", "[", 
             RowBox[{
              RowBox[{"Apar", "^", "2"}], "+", 
              RowBox[{"Aperp", "^", "2"}]}], "]"}]}]}], ")"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"finalPhaseTerm", "=", 
       RowBox[{
        RowBox[{"PhaseTerm", " ", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], "rotFact"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"PhaseTerm", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"180", "/", "\[Pi]"}], ")"}], 
        RowBox[{"Arg", "[", "PhaseTerm", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"finalPhaseTerm", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"180", "/", "\[Pi]"}], ")"}], 
        RowBox[{"Arg", "[", "finalPhaseTerm", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"PhaseTerm", ",", "finalPhaseTerm"}], "}"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phaseEvolutionSimp", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Omega]_", ",", "Apar_", ",", "Aperp_"}], "}"}], ",", 
    "pulseData_", ",", "inputEstate_", ",", "\[Omega]sup_", ",", 
    RowBox[{"inPhase_:", "0"}], ",", 
    RowBox[{"ignoreFinal_:", "False"}], ",", 
    RowBox[{"triggerReadout_:", "False"}], ",", 
    RowBox[{"readoutVal_:", "0"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "i", ",", "numPulses", ",", "estate", ",", "currentEstate", ",", 
      "PhaseTerm", ",", "finalPhaseTerm", ",", "pulseMat", ",", "pulseDelay", 
      ",", "rotFact"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"numPulses", "=", 
      RowBox[{
       RowBox[{"Dimensions", "[", 
        RowBox[{"pulseData", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"estate", "=", "inputEstate"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "<=", "numPulses"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pulseDelay", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", "\[Equal]", "1"}], ",", " ", 
           RowBox[{"pulseData", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "i", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"pulseData", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "i", ",", "1"}], "]"}], "]"}], "-", 
             RowBox[{"pulseData", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", 
                RowBox[{"i", "-", "1"}], ",", "1"}], "]"}], "]"}]}], ")"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"currentEstate", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"estate", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "^", "2"}], ">",
             "0.9"}], ",", "0", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"estate", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "^", "2"}], "<",
             "0.1"}], ",", "1", ",", "True", ",", "0.5"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"rotFact", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"currentEstate", "\[Equal]", "0"}], ",", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", 
             RowBox[{"pulseDelay", "/", "2"}], 
             RowBox[{"(", "\[Omega]", ")"}]}], "]"}], ",", 
           RowBox[{"currentEstate", "\[Equal]", "1"}], ",", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", 
             RowBox[{"pulseDelay", "/", "2"}], 
             RowBox[{"(", 
              RowBox[{"Sqrt", "[", 
               RowBox[{
                RowBox[{"Apar", "^", "2"}], "+", 
                RowBox[{"Aperp", "^", "2"}]}], "]"}], ")"}]}], "]"}], ",", 
           RowBox[{"currentEstate", "\[Equal]", "0.5"}], ",", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", 
             RowBox[{"pulseDelay", "/", "2"}], 
             RowBox[{"(", "\[Omega]sup", ")"}]}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"PhaseTerm", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", "\[Equal]", "1"}], ",", 
           RowBox[{"PhaseTerm", "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], " ", 
                RowBox[{"(", 
                 RowBox[{"\[Pi]", "/", "180"}], ")"}], "inPhase"}], " ", 
               "]"}], "rotFact"}], "}"}]}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{"PhaseTerm", " ", ",", 
             RowBox[{
              RowBox[{"PhaseTerm", " ", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}], "rotFact"}]}], "]"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"pulseMat", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pulseData", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "i", ",", "5"}], "]"}], "]"}], "\[Equal]", 
            "0"}], ",", 
           RowBox[{"rTheta\[Phi]", "[", 
            RowBox[{
             RowBox[{"pulseData", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "i", ",", "4"}], "]"}], "]"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Pi]", "/", "2"}], "-", 
               RowBox[{"pulseData", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "i", ",", "3"}], "]"}], "]"}]}], ")"}]}], 
            "]"}], ",", 
           RowBox[{
            RowBox[{"pulseData", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "i", ",", "5"}], "]"}], "]"}], "\[Equal]", 
            "1"}], ",", 
           SubscriptBox["\[ScriptCapitalP]", "0"], ",", 
           RowBox[{
            RowBox[{"pulseData", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "i", ",", "5"}], "]"}], "]"}], "\[Equal]", 
            "2"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{"triggerReadout", ",", 
             SubscriptBox["\[ScriptCapitalP]", "readoutVal"], ",", 
             SubscriptBox["\[Sigma]", "0"]}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"estate", "=", 
         RowBox[{"pulseMat", ".", "estate"}]}], ";"}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pulseDelay", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", "ignoreFinal", "]"}], ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"pulseData", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "5"}], "]"}], "]"}], "-", 
          RowBox[{"pulseData", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", 
             RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], ")"}], ",", 
        "0"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"currentEstate", "=", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"estate", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "^", "2"}], ">", 
         "0.9"}], ",", "0", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"estate", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "^", "2"}], "<", 
         "0.1"}], ",", "1", ",", "True", ",", "0.5"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rotFact", "=", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"currentEstate", "\[Equal]", "0"}], ",", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", 
          RowBox[{"pulseDelay", "/", "2"}], 
          RowBox[{"(", "\[Omega]", ")"}]}], "]"}], ",", 
        RowBox[{"currentEstate", "\[Equal]", "1"}], ",", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", 
          RowBox[{"pulseDelay", "/", "2"}], 
          RowBox[{"(", 
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{"Apar", "^", "2"}], "+", 
             RowBox[{"Aperp", "^", "2"}]}], "]"}], ")"}]}], "]"}], ",", 
        RowBox[{"currentEstate", "\[Equal]", "0.5"}], ",", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", 
          RowBox[{"pulseDelay", "/", "2"}], 
          RowBox[{"(", "\[Omega]sup", ")"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"finalPhaseTerm", "=", 
      RowBox[{
       RowBox[{"PhaseTerm", " ", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}], "rotFact"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"PhaseTerm", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"180", "/", "\[Pi]"}], ")"}], 
       RowBox[{"Arg", "[", "PhaseTerm", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"finalPhaseTerm", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"180", "/", "\[Pi]"}], ")"}], 
       RowBox[{"Arg", "[", "finalPhaseTerm", "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"PhaseTerm", ",", "finalPhaseTerm"}], "}"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.6865671998153954`*^9, 3.6865672068704777`*^9}, {
   3.6865672447386417`*^9, 3.686567304923348*^9}, {3.686567341225491*^9, 
   3.6865675016036777`*^9}, {3.686567531618938*^9, 3.686567645666964*^9}, {
   3.686567726886218*^9, 3.6865677272325087`*^9}, {3.686567769899971*^9, 
   3.686567796946785*^9}, {3.686567854164564*^9, 3.6865678638450613`*^9}, 
   3.68656789517904*^9, {3.686567964909006*^9, 3.6865679986936693`*^9}, {
   3.6865699591950893`*^9, 3.686570033503994*^9}, {3.686570185185288*^9, 
   3.686570191720635*^9}, {3.6865702408090878`*^9, 3.68657024105394*^9}, {
   3.686570271740549*^9, 3.686570276336041*^9}, {3.686628600778599*^9, 
   3.686628801494719*^9}, {3.686628935917416*^9, 3.6866289403085127`*^9}, {
   3.686629116981201*^9, 3.686629120664935*^9}, 3.6866291559982843`*^9, {
   3.686629256225163*^9, 3.686629309987604*^9}, {3.6866293413862467`*^9, 
   3.6866293872769957`*^9}, {3.686629450868238*^9, 3.686629493628365*^9}, {
   3.68662953560351*^9, 3.686629559350061*^9}, {3.686629638625412*^9, 
   3.686629712349822*^9}, {3.686629793741762*^9, 3.6866298025578327`*^9}, {
   3.686629856829296*^9, 3.686629862687746*^9}, {3.6866299134330606`*^9, 
   3.686629940937812*^9}, {3.6866300006371307`*^9, 3.6866300050077553`*^9}, {
   3.686630059348114*^9, 3.68663006464213*^9}, {3.6866300968914022`*^9, 
   3.6866301058992*^9}, {3.686630241949729*^9, 3.686630263993322*^9}, 
   3.68663054708965*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"addPhaseEvInfo", "[", 
    RowBox[{
    "CarbonParams_", ",", "pulseData_", ",", "inputEstate_", ",", 
     "\[Omega]sup_", ",", 
     RowBox[{"inPhase_:", "0"}]}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"pulseData", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"phaseEvolutionSimp", "[", 
         RowBox[{
         "CarbonParams", ",", "pulseData", ",", "inputEstate", ",", 
          "\[Omega]sup", ",", "inPhase"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "}"}], "]"}], ",", "2"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.686571771917973*^9, 3.686571842379176*^9}, {
  3.686629010690345*^9, 3.686629018280984*^9}, {3.686629168076623*^9, 
  3.686629191742312*^9}, {3.686629728049821*^9, 3.686629728616467*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Carbon calib", "Subchapter",
 CellChangeTimes->{{3.686288250029621*^9, 3.686288254410158*^9}}],

Cell[CellGroupData[{

Cell["LT4", "Subsection",
 CellChangeTimes->{{3.686483596151759*^9, 3.686483597933713*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LT4phase", "=", 
   RowBox[{"getPulses", "[", 
    RowBox[{"basedirLT4", ",", "\"\<AWG_seqs_phase_C4\>\""}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.6864738101904907`*^9, 3.686483378614252*^9, {3.686557934416934*^9, 
   3.686557944933217*^9}, {3.686634037396431*^9, 3.686634037930625*^9}, 
   3.687092054783078*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"numPoints", " ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Dimensions", "[", "LT4phase", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "/", "3"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phase", "=", 
   RowBox[{
    RowBox[{"-", "60"}], "+", 
    RowBox[{
     RowBox[{"Range", "[", 
      RowBox[{"0", ",", 
       RowBox[{"numPoints", "-", "1"}]}], "]"}], "*", 
     RowBox[{"(", 
      RowBox[{"460.", "/", 
       RowBox[{"(", 
        RowBox[{"numPoints", "-", "1"}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MeasVals", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "\[LessEqual]", "numPoints"}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"InitLT4", "=", 
     RowBox[{
      RowBox[{"KP", "[", 
       RowBox[{
        SubscriptBox["\[ScriptCapitalP]", "0"], ",", 
        SubscriptBox["\[Sigma]", "0"]}], "]"}], ".", 
      RowBox[{"compiledPulse", "[", 
       RowBox[{"LT4C", ",", 
        RowBox[{"LT4phase", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"3", 
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}]}], "+", "2"}], "]"}], "]"}]}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"MeasLT4", "=", 
     RowBox[{"compiledPulse", "[", 
      RowBox[{"LT4C", ",", 
       RowBox[{"LT4phase", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"3", 
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}]}], "+", "3"}], "]"}], "]"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"pulse", "=", 
     RowBox[{"MeasLT4", ".", "InitLT4"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"initState", "=", 
     RowBox[{"KP", "[", 
      RowBox[{
       SubscriptBox["\[ScriptCapitalP]", "0"], ",", 
       RowBox[{
        SubscriptBox["\[Sigma]", "0"], "/", "2"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"outState", "=", 
     RowBox[{"PTr", "[", 
      RowBox[{
       RowBox[{"{", "2", "}"}], ",", 
       RowBox[{"transformAndNorm", "[", 
        RowBox[{"initState", ",", "pulse"}], "]"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"MeasVals", "=", 
     RowBox[{"Append", "[", 
      RowBox[{"MeasVals", ",", 
       RowBox[{"Tr", "[", 
        RowBox[{
         SubscriptBox["\[ScriptCapitalP]", "0"], ".", "outState"}], "]"}]}], 
      "]"}]}], ";"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "x", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nlmLT4", "=", 
   RowBox[{"NonlinearModelFit", "[", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{"phase", ",", "MeasVals"}], "}"}], "]"}], ",", 
     RowBox[{
      RowBox[{"Amp", "*", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", "\[Pi]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"f", " ", "x"}], "+", 
           RowBox[{"a", "/", "360"}]}], ")"}]}], "]"}]}], "+", "off"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"f", ",", 
         RowBox[{"1", "/", "360"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Amp", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"off", ",", "0.5"}], "}"}]}], "}"}], ",", "x"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"plot2", " ", "=", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"ListPlot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"phase", ",", "MeasVals"}], "}"}], "]"}], "}"}], ",", 
      RowBox[{"Joined", "\[Rule]", 
       RowBox[{"{", "False", "}"}]}]}], "]"}], ",", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"Normal", "[", "nlmLT4", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"phase", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"phase", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"97", ",", "\"\<ColorList\>\""}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "}"}]}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"aout", "=", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"Amp", ">", "0"}], ",", 
     RowBox[{"Mod", "[", 
      RowBox[{"a", ",", "360"}], "]"}], ",", 
     RowBox[{"Mod", "[", 
      RowBox[{
       RowBox[{"a", "+", "180"}], ",", "360"}], "]"}]}], "]"}], "/.", 
   RowBox[{"nlmLT4", "[", "\"\<BestFitParameters\>\"", "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.6864736976619167`*^9, 3.686473715075102*^9}, {
  3.686473766018442*^9, 3.686473767073341*^9}, {3.6864738014760227`*^9, 
  3.6864738533366623`*^9}, {3.6864740993211317`*^9, 3.686474099624116*^9}, {
  3.686474181075223*^9, 3.686474184458667*^9}, {3.686474268032628*^9, 
  3.686474344022779*^9}, {3.686474459910347*^9, 3.686474615739085*^9}, {
  3.686483639484515*^9, 3.6864836408000174`*^9}, {3.6865396377709923`*^9, 
  3.6865396551885633`*^9}, {3.686634091824478*^9, 3.686634093635846*^9}}],

Cell[BoxData[
 TagBox[
  GraphicsBox[{{{}, {{}, 
      {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
       0.012833333333333334`], AbsoluteThickness[1.6], 
       PointBox[CompressedData["
1:eJxTTMoPSmViYGCQBGIQDQF+Bww8GJVnTn5qv3oVEGS5HMjutDEzin5gvwbE
X2V6oE7I7vFVw2v2AmD1LAeuHDvyfk/bSfsVYHkDhxCWM5w+N7ZC+K8cHSas
Dbjv2TnR/t9/IKj3dmDQTvnt15RsD1beFeRwoeCD0Ou7S+1DQkEg3CHI8Zxp
oPRBiHr5GAeF7GdHvn2/AJEvTXBo26O5bZPYbYj+W0kOFs6qd27cfmQPUv7f
PtVhi8cz51m3n0PUL013YMsQK+f9+xqinivLQYbRaqbl6XcQ8/NzHKb07k7Y
+O09RP3VPAcNgyOH9eLe24OdM7fAQeESU8cmobcQ888XOuz9/FjEMvQlxDym
Yof8y47aa/qfQPSbljjMElvuEz7pHkR9eqnD5fm1/GZ6VyDqZ5U5LLnCHZhj
dAyi/my5ww6NaSfPBmyEqP9f4aDA9lJB6XuzPQBO5swf
        "]]}, {}}, {}}, {{{}, {}, 
      {RGBColor[0.880722, 0.611041, 0.142051], AbsoluteThickness[1.6], 
       Opacity[1.], LineBox[CompressedData["
1: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

        "]]}}, {}}},
   AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
   Axes->{True, True},
   AxesLabel->{None, None},
   AxesOrigin->{0, 0},
   DisplayFunction->Identity,
   Frame->{{False, False}, {False, False}},
   FrameLabel->{{None, None}, {None, None}},
   FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
   GridLines->{None, None},
   GridLinesStyle->Directive[
     GrayLevel[0.5, 0.4]],
   ImagePadding->All,
   Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
         (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
          Part[#, 1]], 
         (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
          Part[#, 2]]}& ), "CopiedValueFunction" -> ({
         (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
          Part[#, 1]], 
         (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
          Part[#, 2]]}& )}},
   PlotRange->{{-60., 399.99999999999994`}, {0, 0.9988638772305642}},
   PlotRangeClipping->True,
   PlotRangePadding->{{
      Scaled[0.02], 
      Scaled[0.02]}, {
      Scaled[0.02], 
      Scaled[0.05]}},
   Ticks->{Automatic, Automatic}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.686473763596736*^9, 3.686473773221821*^9}, {
   3.6864738171616087`*^9, 3.686473854222948*^9}, {3.686474100758129*^9, 
   3.6864741067479897`*^9}, 3.6864742018667717`*^9, {3.686474269241839*^9, 
   3.6864743528188143`*^9}, {3.686474516238736*^9, 3.686474536895372*^9}, {
   3.686474580688911*^9, 3.6864746392661533`*^9}, 3.686474884248437*^9, 
   3.686476201883898*^9, {3.6864763925676003`*^9, 3.68647641099632*^9}, 
   3.686478510201799*^9, 3.686478540971189*^9, {3.686484001796151*^9, 
   3.686484031787517*^9}, 3.686484412404613*^9, 3.68648475229408*^9, 
   3.686484786200946*^9, 3.6864848570311527`*^9, 3.686485441149741*^9, {
   3.686485475695191*^9, 3.686485495683997*^9}, {3.686485989980887*^9, 
   3.6864860444041986`*^9}, 3.686486083452306*^9, 3.68653964042387*^9, 
   3.6865396750314407`*^9, 3.686556350948073*^9, {3.686560844324106*^9, 
   3.686560872831936*^9}, 3.686560918289257*^9, 3.686567750437942*^9, 
   3.686568323394437*^9, {3.68663373786449*^9, 3.6866337526878023`*^9}, 
   3.686634095200575*^9, 3.686634153758759*^9, 3.686634200454568*^9, 
   3.686916057938855*^9, 3.6869779320705833`*^9, 3.686992446612082*^9, 
   3.687005645294788*^9, 3.687006611600383*^9, 3.687006706290784*^9, 
   3.687006858600683*^9, 3.6870069675351954`*^9, 3.6870078704337473`*^9, 
   3.68700798017089*^9, 3.687060921608379*^9, 3.687068035046033*^9, 
   3.687068143181744*^9, 3.687073084276638*^9, 3.687092061803783*^9, 
   3.6870921178922863`*^9, 3.687094120075564*^9, {3.6871829825999126`*^9, 
   3.68718301048472*^9}, 3.688302104166648*^9, 3.688302162713766*^9}],

Cell[BoxData[
 TagBox["129.5501352703807`",
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.686473763596736*^9, 3.686473773221821*^9}, {
   3.6864738171616087`*^9, 3.686473854222948*^9}, {3.686474100758129*^9, 
   3.6864741067479897`*^9}, 3.6864742018667717`*^9, {3.686474269241839*^9, 
   3.6864743528188143`*^9}, {3.686474516238736*^9, 3.686474536895372*^9}, {
   3.686474580688911*^9, 3.6864746392661533`*^9}, 3.686474884248437*^9, 
   3.686476201883898*^9, {3.6864763925676003`*^9, 3.68647641099632*^9}, 
   3.686478510201799*^9, 3.686478540971189*^9, {3.686484001796151*^9, 
   3.686484031787517*^9}, 3.686484412404613*^9, 3.68648475229408*^9, 
   3.686484786200946*^9, 3.6864848570311527`*^9, 3.686485441149741*^9, {
   3.686485475695191*^9, 3.686485495683997*^9}, {3.686485989980887*^9, 
   3.6864860444041986`*^9}, 3.686486083452306*^9, 3.68653964042387*^9, 
   3.6865396750314407`*^9, 3.686556350948073*^9, {3.686560844324106*^9, 
   3.686560872831936*^9}, 3.686560918289257*^9, 3.686567750437942*^9, 
   3.686568323394437*^9, {3.68663373786449*^9, 3.6866337526878023`*^9}, 
   3.686634095200575*^9, 3.686634153758759*^9, 3.686634200454568*^9, 
   3.686916057938855*^9, 3.6869779320705833`*^9, 3.686992446612082*^9, 
   3.687005645294788*^9, 3.687006611600383*^9, 3.687006706290784*^9, 
   3.687006858600683*^9, 3.6870069675351954`*^9, 3.6870078704337473`*^9, 
   3.68700798017089*^9, 3.687060921608379*^9, 3.687068035046033*^9, 
   3.687068143181744*^9, 3.687073084276638*^9, 3.687092061803783*^9, 
   3.6870921178922863`*^9, 3.687094120075564*^9, {3.6871829825999126`*^9, 
   3.68718301048472*^9}, 3.688302104166648*^9, 3.6883021627292147`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Simulate the phase offset calibration", "Subsubsection",
 CellChangeTimes->{{3.686557253214086*^9, 3.686557258212644*^9}}],

Cell["\<\
The only phase adding element is the trigger duration (plus 2 extra \
microseconds that are added on each side)\
\>", "Text",
 CellChangeTimes->{{3.68655710446556*^9, 3.68655713268616*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"triggerRODuration", "=", "80*^-6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phaseAfterTrig", "=", 
   RowBox[{"Mod", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"triggerRODuration", "+", "2*^-6"}], ")"}], "*", 
      "\[Omega]L4"}], ",", 
     RowBox[{"2", "\[Pi]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"phaseToComp", "=", 
    RowBox[{"Mod", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"2", "\[Pi]"}], "-", "phaseAfterTrig"}], ",", 
      RowBox[{"2", "\[Pi]"}]}], "]"}]}], " ", ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "is", " ", "therefore", " ", "the", " ", "phase", " ", "that",
     " ", "needs", " ", "to", " ", 
    RowBox[{"be", " ", "'"}], 
    RowBox[{"added", "'"}], " ", "to", " ", "get", " ", "back", " ", "to", 
    " ", 
    RowBox[{"zero", "."}]}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InitLT4", "=", 
   RowBox[{"compiledPulse", "[", 
    RowBox[{"LT4C", ",", 
     RowBox[{"LT4phase", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"initState", "=", 
   RowBox[{"KP", "[", 
    RowBox[{
     SubscriptBox["\[ScriptCapitalP]", "0"], ",", 
     RowBox[{
      SubscriptBox["\[Sigma]", "0"], "/", "2"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ZProj", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", 
       RowBox[{"Re", "@", 
        RowBox[{"Tr", "[", 
         RowBox[{
          SubscriptBox["\[ScriptCapitalP]", "0"], ".", 
          RowBox[{"PTr", "[", 
           RowBox[{
            RowBox[{"{", "2", "}"}], ",", 
            RowBox[{"transformAndNorm", "[", 
             RowBox[{"initState", ",", 
              RowBox[{"InitLT4", ".", 
               RowBox[{"Usys", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Round", "[", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"phaseToComp", "+", 
                    RowBox[{"\[Theta]", " ", 
                    RowBox[{"\[Pi]", "/", "180"}]}]}], ")"}], " ", "/", 
                    "\[Omega]L4"}], ")"}], "*", "1*^9"}], "]"}], "*", 
                  "1*^-9"}], ",", "LT4C"}], "]"}], ".", 
               RowBox[{"KP", "[", 
                RowBox[{
                 SubscriptBox["\[ScriptCapitalP]", "0"], ",", 
                 SubscriptBox["\[Sigma]", "0"]}], "]"}], ".", "InitLT4"}]}], 
             "]"}]}], "]"}]}], "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", "phase"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nlmLT4", "=", 
   RowBox[{"NonlinearModelFit", "[", 
    RowBox[{"ZProj", ",", 
     RowBox[{
      RowBox[{"Amp", "*", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", "\[Pi]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"f", " ", "x"}], "+", 
           RowBox[{"a", "/", "360"}]}], ")"}]}], "]"}]}], "+", "off"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"f", ",", 
         RowBox[{"1", "/", "360"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Amp", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"off", ",", "0.5"}], "}"}]}], "}"}], ",", "x"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"plot2", " ", "=", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"ListPlot", "[", 
     RowBox[{"ZProj", ",", 
      RowBox[{"Joined", "\[Rule]", 
       RowBox[{"{", "False", "}"}]}]}], "]"}], ",", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"Normal", "[", "nlmLT4", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"ZProj", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"ZProj", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"97", ",", "\"\<ColorList\>\""}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "}"}]}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"aout", "=", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"Amp", ">", "0"}], ",", 
     RowBox[{"Mod", "[", 
      RowBox[{"a", ",", "360"}], "]"}], ",", 
     RowBox[{"Mod", "[", 
      RowBox[{
       RowBox[{"a", "+", "180"}], ",", "360"}], "]"}]}], "]"}], "/.", 
   RowBox[{
   "nlmLT4", "[", "\"\<BestFitParameters\>\"", 
    "]"}]}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.686541576935083*^9, 3.68654162453118*^9}, {
   3.68654166041891*^9, 3.6865418007120667`*^9}, {3.686541841215205*^9, 
   3.6865419852271214`*^9}, {3.686542389892214*^9, 3.686542399337966*^9}, {
   3.686542429538813*^9, 3.68654249091702*^9}, {3.686542599360292*^9, 
   3.686542636236602*^9}, {3.68654266976742*^9, 3.686542711861766*^9}, {
   3.6865428275446243`*^9, 3.686542884519163*^9}, {3.686545451919592*^9, 
   3.6865455941003036`*^9}, {3.686545702444227*^9, 3.686545734104954*^9}, {
   3.6865457646111593`*^9, 3.686545830136656*^9}, {3.6865458645759363`*^9, 
   3.6865459343458014`*^9}, {3.6865464210203342`*^9, 3.68654642150637*^9}, {
   3.6865464559090357`*^9, 3.686546473194869*^9}, {3.686549064276119*^9, 
   3.686549064506768*^9}, {3.6865561949415627`*^9, 3.686556200747735*^9}, {
   3.686556909848901*^9, 3.686556910302525*^9}, {3.686557060996511*^9, 
   3.686557091017144*^9}, {3.686557203978477*^9, 3.686557205913137*^9}, {
   3.686557281239862*^9, 3.686557324245544*^9}, 3.6865573783517313`*^9, {
   3.686557418142352*^9, 3.686557433426626*^9}, {3.686557490420044*^9, 
   3.6865575373131123`*^9}, {3.686557571396649*^9, 3.686557655537858*^9}, 
   3.686558339839075*^9, {3.6865583779464912`*^9, 3.686558379778133*^9}, {
   3.6865584170108137`*^9, 3.686558444563999*^9}, {3.6865585614448347`*^9, 
   3.686558572376584*^9}, {3.686634120010921*^9, 3.686634127306961*^9}}],

Cell[BoxData[
 TagBox[
  GraphicsBox[{{{}, {{}, 
      {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
       0.012833333333333334`], AbsoluteThickness[1.6], 
       PointBox[CompressedData["
1:eJxTTMoPSmViYGCQBGIQDQF+ByaE5tRO2fTUfvUqIMhyOZAUcHiTT80D+zUg
/irTA2cubyv4XnDNXgCsnuWARoIbx5MPJ+1XgOUNHDKEfp18lbMNwn/l6CBg
vO8Dk/0k+3//gaDe24HheRvbjIeJ9mDlXUEODw6lJN8PXGofEgoC4Q5y3sst
198/AFEvH+Pg67okWvniBYh8aYKDy7uL6y88uAXRfyvJ4Z2Q5plfBx7Zg5T/
t091YO+b+mL32ecQ9UvTHa58Mrhf/+k1RD1XloPbwsz/6kffQczPz3Hg+M8r
eeTre4j6q3kOf76a2yxKem8Pds7cAodcnrZnHDJvIeafL3Qo8ChRyEp6CTGP
qdhB6MuZgsgpTyD6TUsclDX6TCXn3IOoTy91+JkZkOltfgWiflaZA8/5k5Y2
jscg6s+WOxz5mtd5IHUjRP3/CocGO6tXHmYt9gCL1NHj
        "]]}, {}}, {}}, {{{}, {}, 
      {RGBColor[0.880722, 0.611041, 0.142051], AbsoluteThickness[1.6], 
       Opacity[1.], LineBox[CompressedData["
1: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
k/tR0rjHFXMv/frpfIKCiPhDmu96XbFj2Ul3aVsKzM4/PkEbcsV8QcWOYXsK
JkxvJBpMuiK304i3ngsFG/9Zsh36R+p/bapr8qHgjHnXF40tbpg7NNSZHU6B
NuouMiXd8C6d1s0eRQHfjsp1KOOG/+S5amyiKchnSTFQV3RD7ozWzazXKPh4
/0iVio4bZkZIavy+QYEya2fibjc33LWCW64xn4Llk9olpR5uqHXw1Zv6Agpa
Oiua5U+74SJjm/qTIgqcCpPYyJ0LVSaK4pNLKUiytPCSiXXDbu1Pf1ZUUfCj
qN1ga5kbKjx+ue3xCwr0JAUyVlS6YdKOrHnfVxTcyrCYGa52Q6Vehv+O1xTo
xnUmZje6odBiWXDwWwpuen38ItnthjZlmXfbPlAw822DPEevGx6XTO006yDv
a2d1aXTQDffyxJS966Rg+nCPZN6kG8ZM59k/6KZAa89nT+lldFz+wOS6QB8F
NwpE6jnZ6bgzO3vRup+CKYkT68Y56fhrbRf7rQEyn+t6H9/np2ORaAgHxzAZ
/599rDul6HiyPeb2pW8UaHiImf+3k47+fvob4sbI+361zZmUp+OPhUy5xHEK
sGtAv0iVjuNNimqRkxQkPB5KkDWi46B9ZpXgDAXf5Ld+5TGjo1D/PfExYvV8
h33TlnRkudazrXyWgtHUkc/FdnSc1TrFqvCdgv1rJeWuOdGxWJn94zDx9StO
IV50Ojar++ld/0GBWtDoNgU/OvYIhv758JOCa9+lAvnO0pGmH63mNk/BCN3l
9ewFOjoa7hVYJFYdzhN5H0pHsYEDkRcXKIizHvMoi6Qjq6pn4rJfFAy3S9fF
x9Bx18IllTPEKjQ3/tPxdAyX0g4YJx5Sn6jck07H67orax4tUrDvkczqdVl0
vBWcU8/3m4IYWYb1j2w6llcr2zkSD+YUPmi/T/qrlJBSSqwsOrWsopiOW1OS
HOeJr6bsMkt6SEe9X5ub9/yhYIDXI9uvio7bB9a+ciXeG/lgweIZnXyvjlrf
II5eNq239zkdF5K7I5jE/YFy6etf0XFdVph+H7HSrCc1/4aOZkX69xaIr7iW
aHS1kfn2FktatURB38BMfGUnHfP5/omsJVY8pjCS8omOvhJ9auuIo957Kwf2
0/HD/fpZHuJe/bKooyN0zNtYAGzEe57Pfdo3TvKtMrZQpP2oO6aSLygyX/9E
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
32Z9nt2Ll+B/wj4j6g==
        "]]}}, {}}},
   AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
   Axes->{True, True},
   AxesLabel->{None, None},
   AxesOrigin->{0, 0},
   DisplayFunction->Identity,
   Frame->{{False, False}, {False, False}},
   FrameLabel->{{None, None}, {None, None}},
   FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
   GridLines->{None, None},
   GridLinesStyle->Directive[
     GrayLevel[0.5, 0.4]],
   ImagePadding->All,
   Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
         (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
          Part[#, 1]], 
         (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
          Part[#, 2]]}& ), "CopiedValueFunction" -> ({
         (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
          Part[#, 1]], 
         (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
          Part[#, 2]]}& )}},
   PlotRange->{{-60., 399.99999999999994`}, {0, 0.9987507333134724}},
   PlotRangeClipping->True,
   PlotRangePadding->{{
      Scaled[0.02], 
      Scaled[0.02]}, {
      Scaled[0.02], 
      Scaled[0.05]}},
   Ticks->{Automatic, Automatic}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6865419371264143`*^9, 3.686541985789657*^9}, {
   3.686542430840075*^9, 3.6865424403658752`*^9}, {3.6865424720191383`*^9, 
   3.686542491446506*^9}, 3.686542602797411*^9, {3.6865427047506227`*^9, 
   3.68654271212569*^9}, 3.686542831583559*^9, {3.686542861634651*^9, 
   3.686542884774621*^9}, {3.6865455380057917`*^9, 3.686545594738501*^9}, {
   3.686545725922078*^9, 3.6865457347336807`*^9}, 3.686545771536426*^9, {
   3.686545804383078*^9, 3.686545830699154*^9}, 3.686545891394388*^9, {
   3.686545930021784*^9, 3.686545935264482*^9}, 3.686546423407386*^9, {
   3.686546465068982*^9, 3.68654647425102*^9}, 3.686549069387773*^9, 
   3.686556956252413*^9, {3.6865570639763813`*^9, 3.6865570919258223`*^9}, 
   3.686557212220983*^9, {3.6865573100720654`*^9, 3.686557324919175*^9}, 
   3.686557378845118*^9, 3.686557540643362*^9, {3.686557576029929*^9, 
   3.6865575862728786`*^9}, {3.6865576343420353`*^9, 3.686557655853324*^9}, 
   3.686558307579051*^9, {3.6865583733673887`*^9, 3.686558380334867*^9}, {
   3.6865584274557*^9, 3.686558445023226*^9}, {3.686558563300543*^9, 
   3.6865585731632833`*^9}, {3.686560844950132*^9, 3.686560873455936*^9}, 
   3.6865609187484217`*^9, 3.6865677512529383`*^9, 3.6865683238806047`*^9, {
   3.686634118056233*^9, 3.686634154354785*^9}, 3.686634200895157*^9, 
   3.6869160589016743`*^9, 3.686977932493805*^9, 3.686992447658745*^9, 
   3.68700564573427*^9, 3.687006616472499*^9, 3.687006711177898*^9, 
   3.687006859046139*^9, 3.6870069680300617`*^9, 3.687007870844178*^9, 
   3.68700798222943*^9, 3.6870609223227386`*^9, 3.68706803553109*^9, 
   3.6870681437675657`*^9, 3.687073084746703*^9, 3.687092062730194*^9, 
   3.6870921188030643`*^9, 3.687094120550885*^9, {3.6871829832277412`*^9, 
   3.6871830110987377`*^9}, 3.688302104971757*^9, 3.68830216328047*^9}],

Cell[BoxData[
 TagBox["129.10677430943883`",
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6865419371264143`*^9, 3.686541985789657*^9}, {
   3.686542430840075*^9, 3.6865424403658752`*^9}, {3.6865424720191383`*^9, 
   3.686542491446506*^9}, 3.686542602797411*^9, {3.6865427047506227`*^9, 
   3.68654271212569*^9}, 3.686542831583559*^9, {3.686542861634651*^9, 
   3.686542884774621*^9}, {3.6865455380057917`*^9, 3.686545594738501*^9}, {
   3.686545725922078*^9, 3.6865457347336807`*^9}, 3.686545771536426*^9, {
   3.686545804383078*^9, 3.686545830699154*^9}, 3.686545891394388*^9, {
   3.686545930021784*^9, 3.686545935264482*^9}, 3.686546423407386*^9, {
   3.686546465068982*^9, 3.68654647425102*^9}, 3.686549069387773*^9, 
   3.686556956252413*^9, {3.6865570639763813`*^9, 3.6865570919258223`*^9}, 
   3.686557212220983*^9, {3.6865573100720654`*^9, 3.686557324919175*^9}, 
   3.686557378845118*^9, 3.686557540643362*^9, {3.686557576029929*^9, 
   3.6865575862728786`*^9}, {3.6865576343420353`*^9, 3.686557655853324*^9}, 
   3.686558307579051*^9, {3.6865583733673887`*^9, 3.686558380334867*^9}, {
   3.6865584274557*^9, 3.686558445023226*^9}, {3.686558563300543*^9, 
   3.6865585731632833`*^9}, {3.686560844950132*^9, 3.686560873455936*^9}, 
   3.6865609187484217`*^9, 3.6865677512529383`*^9, 3.6865683238806047`*^9, {
   3.686634118056233*^9, 3.686634154354785*^9}, 3.686634200895157*^9, 
   3.6869160589016743`*^9, 3.686977932493805*^9, 3.686992447658745*^9, 
   3.68700564573427*^9, 3.687006616472499*^9, 3.687006711177898*^9, 
   3.687006859046139*^9, 3.6870069680300617`*^9, 3.687007870844178*^9, 
   3.68700798222943*^9, 3.6870609223227386`*^9, 3.68706803553109*^9, 
   3.6870681437675657`*^9, 3.687073084746703*^9, 3.687092062730194*^9, 
   3.6870921188030643`*^9, 3.687094120550885*^9, {3.6871829832277412`*^9, 
   3.6871830110987377`*^9}, 3.688302104971757*^9, 3.688302163302547*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["LT3", "Subsection",
 CellChangeTimes->{{3.6864836067815113`*^9, 3.686483608005525*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LT3phase", "=", 
   RowBox[{"getPulses", "[", 
    RowBox[{"basedirLT3", ",", "\"\<AWG_seqs_phase_C1\>\""}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.6864738101904907`*^9, 3.686483378614252*^9, {3.68648361856037*^9, 
   3.686483626908596*^9}, 3.687092054811433*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"numPoints", " ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Dimensions", "[", "LT3phase", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "/", "3"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phase", "=", 
   RowBox[{
    RowBox[{"-", "60"}], "+", 
    RowBox[{
     RowBox[{"Range", "[", 
      RowBox[{"0", ",", 
       RowBox[{"numPoints", "-", "1"}]}], "]"}], "*", 
     RowBox[{"(", 
      RowBox[{"460.", "/", 
       RowBox[{"(", 
        RowBox[{"numPoints", "-", "1"}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MeasVals", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "i", "]"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "\[LessEqual]", "numPoints"}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"InitLT3", "=", 
     RowBox[{
      RowBox[{"KP", "[", 
       RowBox[{
        SubscriptBox["\[ScriptCapitalP]", "0"], ",", 
        SubscriptBox["\[Sigma]", "0"]}], "]"}], ".", 
      RowBox[{"compiledPulse", "[", 
       RowBox[{"LT3C", ",", 
        RowBox[{"LT3phase", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"3", 
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}]}], "+", "2"}], "]"}], "]"}], ",", 
        "LT3WrongRotate"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"MeasLT3", "=", 
     RowBox[{"compiledPulse", "[", 
      RowBox[{"LT3C", ",", 
       RowBox[{"LT3phase", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"3", 
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}]}], "+", "3"}], "]"}], "]"}], ",", 
       "LT3WrongRotate"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"pulse", "=", 
     RowBox[{"MeasLT3", ".", "InitLT3"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"initState", "=", 
     RowBox[{"KP", "[", 
      RowBox[{
       SubscriptBox["\[ScriptCapitalP]", "0"], ",", 
       RowBox[{
        SubscriptBox["\[Sigma]", "0"], "/", "2"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"outState", "=", 
     RowBox[{"PTr", "[", 
      RowBox[{
       RowBox[{"{", "2", "}"}], ",", 
       RowBox[{"transformAndNorm", "[", 
        RowBox[{"initState", ",", "pulse"}], "]"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"MeasVals", "=", 
     RowBox[{"Append", "[", 
      RowBox[{"MeasVals", ",", 
       RowBox[{"Tr", "[", 
        RowBox[{
         SubscriptBox["\[ScriptCapitalP]", "0"], ".", "outState"}], "]"}]}], 
      "]"}]}], ";"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "x", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nlmLT3", "=", 
   RowBox[{"NonlinearModelFit", "[", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{"phase", ",", "MeasVals"}], "}"}], "]"}], ",", 
     RowBox[{
      RowBox[{"Amp", "*", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", "\[Pi]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"f", " ", "x"}], "+", 
           RowBox[{"a", "/", "360"}]}], ")"}]}], "]"}]}], "+", "off"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"f", ",", 
         RowBox[{"1", "/", "360"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Amp", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"off", ",", "0.5"}], "}"}]}], "}"}], ",", "x"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"plot2", " ", "=", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"ListPlot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"phase", ",", "MeasVals"}], "}"}], "]"}], "}"}], ",", 
      RowBox[{"Joined", "\[Rule]", 
       RowBox[{"{", "False", "}"}]}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Automatic", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}]}], "]"}], ",", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"Normal", "[", "nlmLT3", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"phase", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"phase", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"97", ",", "\"\<ColorList\>\""}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "}"}]}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"aout", "=", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"Amp", ">", "0"}], ",", 
     RowBox[{"Mod", "[", 
      RowBox[{"a", ",", "360"}], "]"}], ",", 
     RowBox[{"Mod", "[", 
      RowBox[{
       RowBox[{"a", "+", "180"}], ",", "360"}], "]"}]}], "]"}], "/.", 
   RowBox[{"nlmLT3", "[", "\"\<BestFitParameters\>\"", "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.6864736976619167`*^9, 3.686473715075102*^9}, {
   3.686473766018442*^9, 3.686473767073341*^9}, {3.6864738014760227`*^9, 
   3.6864738533366623`*^9}, {3.6864740993211317`*^9, 3.686474099624116*^9}, {
   3.686474181075223*^9, 3.686474184458667*^9}, {3.686474268032628*^9, 
   3.686474344022779*^9}, {3.686474459910347*^9, 3.686474615739085*^9}, {
   3.686483715893231*^9, 3.686483737359152*^9}, {3.686484044929525*^9, 
   3.686484045281271*^9}, {3.686484400546883*^9, 3.686484444788418*^9}, {
   3.686484477602532*^9, 3.686484562428817*^9}, 3.686484896365693*^9, {
   3.686539658369063*^9, 3.686539659009378*^9}, {3.686540352038773*^9, 
   3.686540467105741*^9}, {3.686540633439229*^9, 3.6865407204520283`*^9}, {
   3.686540751599216*^9, 3.686540886658969*^9}, {3.686540920864902*^9, 
   3.686540969768826*^9}, 3.686541093830462*^9, 3.686541136552457*^9, {
   3.686547950450841*^9, 3.686547955289229*^9}, {3.6865480431035337`*^9, 
   3.686548066774778*^9}, 3.6865481876285458`*^9, {3.686548547306363*^9, 
   3.6865485777646217`*^9}, {3.686634135765621*^9, 3.6866341407469187`*^9}, {
   3.6870062870927362`*^9, 3.6870062872593193`*^9}, {3.6870063367017117`*^9, 
   3.687006349822897*^9}, {3.687006737633875*^9, 3.687006741904725*^9}, {
   3.6870135719962063`*^9, 3.687013624020714*^9}, {3.687013678404758*^9, 
   3.687013877334852*^9}, {3.688301985926958*^9, 3.688302005321477*^9}}],

Cell[BoxData[
 TagBox[
  GraphicsBox[{{{}, {{}, 
      {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
       0.012833333333333334`], AbsoluteThickness[1.6], 
       PointBox[CompressedData["
1:eJxTTMoPSmViYGCQBGIQDQF+B7YUcy4U3vrOfvUqIMhyOSDGm9fJ/fW9/RoQ
f5XpgVOz7D1OFL23FwCrZzkw0aEu5nnoW/sVYHkDh3LODX4q219C+K8cHZa2
GC8p4Hpq/+8/ENR7OzQ8bU6UYH5gD1beFeSgMpnJ49qsq/YhoSAQ7vCkPMnz
q8JJiHr5GAeGa4ur+N9sh8iXJjgUBOUpKhsthOi/leRw4f62PW/D5tiDlP+3
T3Uo2Lxqh+TnTRD1S9Mdgi6kC/mfPwpRz5XlsO7OhInTOi9DzM/PcTDwmp6g
v/IuRP3VPIe+bUVJds8e24OdM7fAYdv3vDVr976AmH++0IHLxOZL6uI3EPOY
ih1WrbSzPK32HqLftMTh5N6Ic87/30PUp5c6LH4a8/if0nuI+lllDnmPpBn0
57yBqD9b7sBxwWEt202o+f8rHH4m6505xfrEHgDZvNBN
        "]]}, {}}, {}}, {{{}, {}, 
      {RGBColor[0.880722, 0.611041, 0.142051], AbsoluteThickness[1.6], 
       Opacity[1.], LineBox[CompressedData["
1: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
WnbCRbwXkVCEeFjrx1q4kn7jULT9RfTaY6wzfqQGZp1SVazXmSEnnyV2L4lq
2LXzVeVeNjO0pHTvTMT2alCrzoRubjPUc2eRXrVAQOTuXDUjMTPk/orNk1JF
wNGmMi3NM2ao/dJWtuLzBHhKfj4tlmCGBL58b9XYVgUr9EXLWQVzFPLV9Grl
fAWIOSl93qhujuS4B29NNFSA8ZAf2qdnjlgeBe9Sjq2ArG9rgqcszZHz8C9h
a7UKMKnaMJESYI7qtobFJzwuh7wITvcLTeYo+gCL2cqJMrA7Kn630twCzfRo
p37IKoZHb6786bSzQM48Ths07xRDuehrp+lrmOVbtsyYFwPn3sN6u/wtkLHJ
S7WqbcVQyXKMwz3VArnePsVDo74F3m8oVphugfLc7LqEdIqgyds0J+yWJZp5
ELuyhaMAWNmVHtqHWCKhtwnbtKbzQStln7NqpCWSmfx8t6ghH4iWIfHZNEsU
wlS5ePRWPhQLXks712KJ9MMEqorJPEhuDojfs9cKeb86X1VUlgsDNna+88JW
qNTN/sOoZy7s+6Nt1nzYCk1E5RXckcuF6ANbd93SsEJIRjZvY34OhHs+fzJ4
xQopUKQypHLfgK9A9oOMMivE0Rc+w0VkQ+nbh5cDaq2QTP6mKwJB2fD7lKuu
WYsVCtGSyojXzQZ3j2Mbtw5aIdae4m+D7Vng1FQV4MJ6CQlc27Y+eSYTjGmd
3vIXLiH/L7z8nMcyQKpxxaFu4RIytJfLM9+TBu6xU5dcVjGPnc7XpaeCRfFV
qW0s1khhdRsthUiFlyGmwqXbrNEu+RePkp1SQeqQLC/7AWtUyjeg9/F9Cqh7
ji6V6VijJH6+uI9+yWDfb+71SN8adflotMWZJEOIbvu83VlrFML8aaFXJhla
9lTNbDe3Ro1Gdwxfj70E06roPvvrWK5qLhpw4SVcZ9Wv4XxmjfwH/Iw4DZLg
sVuN6ngM1v9IYF+PdBIU9ShUvEvE9nmYt3NxJMHia+EixwxrhNqHnTJevYCg
s2tp7yuskfWjmTSZ6kR4Ve4h+ISwRnnse/pr7ydC08GZRKd6rO98UM3xc4mw
/XdX1I7P1qitimm6eiIBYmML7l8ewnJqqzWFPwHerxffCOPWSMBmOGyFHg8D
zi8CuWewfH0+v09lPAhDmG/VL2skIxz9kZcSD3nD9td2brZBA/VbAsYL46BD
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
a/0I/B/ugoL1
        "]]}}, {}}},
   AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
   Axes->{True, True},
   AxesLabel->{None, None},
   AxesOrigin->{0, 0},
   DisplayFunction->Identity,
   Frame->{{False, False}, {False, False}},
   FrameLabel->{{None, None}, {None, None}},
   FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
   GridLines->{None, None},
   GridLinesStyle->Directive[
     GrayLevel[0.5, 0.4]],
   ImagePadding->All,
   Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
         (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
          Part[#, 1]], 
         (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
          Part[#, 2]]}& ), "CopiedValueFunction" -> ({
         (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
          Part[#, 1]], 
         (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
          Part[#, 2]]}& )}},
   PlotRange->{{-60., 399.99999999999994`}, {0, 1}},
   PlotRangeClipping->True,
   PlotRangePadding->{{
      Scaled[0.02], 
      Scaled[0.02]}, {0, 0}},
   Ticks->{Automatic, Automatic}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.686473763596736*^9, 3.686473773221821*^9}, {
   3.6864738171616087`*^9, 3.686473854222948*^9}, {3.686474100758129*^9, 
   3.6864741067479897`*^9}, 3.6864742018667717`*^9, {3.686474269241839*^9, 
   3.6864743528188143`*^9}, {3.686474516238736*^9, 3.686474536895372*^9}, {
   3.686474580688911*^9, 3.6864746392661533`*^9}, 3.686474884248437*^9, 
   3.686476201883898*^9, {3.6864763925676003`*^9, 3.68647641099632*^9}, 
   3.686478510201799*^9, 3.686478540971189*^9, {3.686484011580543*^9, 
   3.686484057155943*^9}, {3.686484393915229*^9, 3.686484418768743*^9}, {
   3.686484481731678*^9, 3.686484555448494*^9}, 3.686484788091015*^9, 
   3.686484858270067*^9, 3.686485263456214*^9, 3.686485442743699*^9, {
   3.686485476943461*^9, 3.686485496855516*^9}, {3.686485991148059*^9, 
   3.6864860458208933`*^9}, 3.686486084862822*^9, {3.686539660173296*^9, 
   3.686539676284913*^9}, 3.686540430297463*^9, 3.6865404686446457`*^9, 
   3.686540635133182*^9, {3.6865406842132797`*^9, 3.686540693545837*^9}, {
   3.686540739648712*^9, 3.686540887984923*^9}, {3.6865409242676897`*^9, 
   3.686540975141891*^9}, 3.68654109472471*^9, 3.686541229316741*^9, {
   3.686548038875207*^9, 3.6865480678026237`*^9}, {3.686548552358945*^9, 
   3.68654857870896*^9}, {3.686560846310523*^9, 3.686560874813472*^9}, 
   3.686560920314561*^9, 3.686567752670578*^9, 3.6865683254955273`*^9, 
   3.6866341563628893`*^9, 3.6866342024538803`*^9, 3.6869160605558443`*^9, 
   3.686977934218483*^9, 3.6869924491358624`*^9, 3.687005647261243*^9, {
   3.687006327104587*^9, 3.6870063509101343`*^9}, {3.687006739148435*^9, 
   3.687006743192583*^9}, 3.687006860355164*^9, 3.687006969357514*^9, 
   3.6870078723796053`*^9, 3.687007984509199*^9, {3.687013603476469*^9, 
   3.6870136251788397`*^9}, {3.68701368381498*^9, 3.687013878382998*^9}, 
   3.687014278393908*^9, 3.687060925046609*^9, 3.687068037236874*^9, 
   3.68706814547361*^9, 3.687073086978191*^9, 3.6870920690867767`*^9, 
   3.687092121363718*^9, 3.687094123680655*^9, {3.687182986261169*^9, 
   3.687183013838031*^9}, 3.688302107856238*^9, 3.688302165975431*^9}],

Cell[BoxData[
 TagBox["36.64001751784826`",
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.686473763596736*^9, 3.686473773221821*^9}, {
   3.6864738171616087`*^9, 3.686473854222948*^9}, {3.686474100758129*^9, 
   3.6864741067479897`*^9}, 3.6864742018667717`*^9, {3.686474269241839*^9, 
   3.6864743528188143`*^9}, {3.686474516238736*^9, 3.686474536895372*^9}, {
   3.686474580688911*^9, 3.6864746392661533`*^9}, 3.686474884248437*^9, 
   3.686476201883898*^9, {3.6864763925676003`*^9, 3.68647641099632*^9}, 
   3.686478510201799*^9, 3.686478540971189*^9, {3.686484011580543*^9, 
   3.686484057155943*^9}, {3.686484393915229*^9, 3.686484418768743*^9}, {
   3.686484481731678*^9, 3.686484555448494*^9}, 3.686484788091015*^9, 
   3.686484858270067*^9, 3.686485263456214*^9, 3.686485442743699*^9, {
   3.686485476943461*^9, 3.686485496855516*^9}, {3.686485991148059*^9, 
   3.6864860458208933`*^9}, 3.686486084862822*^9, {3.686539660173296*^9, 
   3.686539676284913*^9}, 3.686540430297463*^9, 3.6865404686446457`*^9, 
   3.686540635133182*^9, {3.6865406842132797`*^9, 3.686540693545837*^9}, {
   3.686540739648712*^9, 3.686540887984923*^9}, {3.6865409242676897`*^9, 
   3.686540975141891*^9}, 3.68654109472471*^9, 3.686541229316741*^9, {
   3.686548038875207*^9, 3.6865480678026237`*^9}, {3.686548552358945*^9, 
   3.68654857870896*^9}, {3.686560846310523*^9, 3.686560874813472*^9}, 
   3.686560920314561*^9, 3.686567752670578*^9, 3.6865683254955273`*^9, 
   3.6866341563628893`*^9, 3.6866342024538803`*^9, 3.6869160605558443`*^9, 
   3.686977934218483*^9, 3.6869924491358624`*^9, 3.687005647261243*^9, {
   3.687006327104587*^9, 3.6870063509101343`*^9}, {3.687006739148435*^9, 
   3.687006743192583*^9}, 3.687006860355164*^9, 3.687006969357514*^9, 
   3.6870078723796053`*^9, 3.687007984509199*^9, {3.687013603476469*^9, 
   3.6870136251788397`*^9}, {3.68701368381498*^9, 3.687013878382998*^9}, 
   3.687014278393908*^9, 3.687060925046609*^9, 3.687068037236874*^9, 
   3.68706814547361*^9, 3.687073086978191*^9, 3.6870920690867767`*^9, 
   3.687092121363718*^9, 3.687094123680655*^9, {3.687182986261169*^9, 
   3.687183013838031*^9}, 3.688302107856238*^9, 3.688302165994185*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Simulate the phase offset calibration", "Subsubsection",
 CellChangeTimes->{{3.686557253214086*^9, 3.686557258212644*^9}}],

Cell["\<\
The only phase adding element is the trigger duration (plus 2 extra \
microseconds that are added on each side)\
\>", "Text",
 CellChangeTimes->{{3.68655710446556*^9, 3.68655713268616*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"triggerRODuration", "=", "90*^-6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phaseAfterTrig", "=", 
   RowBox[{"Mod", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"triggerRODuration", "+", "2*^-6"}], ")"}], "*", 
      "\[Omega]L3"}], ",", 
     RowBox[{"2", "\[Pi]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"phaseToComp", "=", 
    RowBox[{"Mod", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"2", "\[Pi]"}], "-", "phaseAfterTrig"}], ",", 
      RowBox[{"2", "\[Pi]"}]}], "]"}]}], " ", ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "is", " ", "therefore", " ", "the", " ", "phase", " ", "that",
     " ", "needs", " ", "to", " ", 
    RowBox[{"be", " ", "'"}], 
    RowBox[{"added", "'"}], " ", "to", " ", "get", " ", "back", " ", "to", 
    " ", 
    RowBox[{"zero", "."}]}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InitLT3", "=", 
   RowBox[{"compiledPulse", "[", 
    RowBox[{"LT3C", ",", 
     RowBox[{"LT3phase", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", "LT3WrongRotate"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"initState", "=", 
   RowBox[{"KP", "[", 
    RowBox[{
     SubscriptBox["\[ScriptCapitalP]", "0"], ",", 
     RowBox[{
      SubscriptBox["\[Sigma]", "0"], "/", "2"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ZProj", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", 
       RowBox[{"Re", "@", 
        RowBox[{"Tr", "[", 
         RowBox[{
          SubscriptBox["\[ScriptCapitalP]", "0"], ".", 
          RowBox[{"PTr", "[", 
           RowBox[{
            RowBox[{"{", "2", "}"}], ",", 
            RowBox[{"transformAndNorm", "[", 
             RowBox[{"initState", ",", 
              RowBox[{"InitLT3", ".", 
               RowBox[{"Usys", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Round", "[", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"phaseToComp", "+", 
                    RowBox[{"\[Theta]", " ", 
                    RowBox[{"\[Pi]", "/", "180"}]}]}], ")"}], " ", "/", 
                    "\[Omega]L3"}], ")"}], "*", "1*^9"}], "]"}], "*", 
                  "1*^-9"}], ",", "LT3C"}], "]"}], ".", 
               RowBox[{"KP", "[", 
                RowBox[{
                 SubscriptBox["\[ScriptCapitalP]", "0"], ",", 
                 SubscriptBox["\[Sigma]", "0"]}], "]"}], ".", "InitLT3"}]}], 
             "]"}]}], "]"}]}], "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", "phase"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nlmLT3", "=", 
   RowBox[{"NonlinearModelFit", "[", 
    RowBox[{"ZProj", ",", 
     RowBox[{
      RowBox[{"Amp", "*", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", "\[Pi]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"f", " ", "x"}], "+", 
           RowBox[{"a", "/", "360"}]}], ")"}]}], "]"}]}], "+", "off"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"f", ",", 
         RowBox[{"1", "/", "360"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Amp", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"off", ",", "0.5"}], "}"}]}], "}"}], ",", "x"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"plot2", " ", "=", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"ListPlot", "[", 
     RowBox[{"ZProj", ",", 
      RowBox[{"Joined", "\[Rule]", 
       RowBox[{"{", "False", "}"}]}]}], "]"}], ",", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"Normal", "[", "nlmLT3", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"ZProj", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"ZProj", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ColorData", "[", 
          RowBox[{"97", ",", "\"\<ColorList\>\""}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "}"}]}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"aout", "=", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"Amp", ">", "0"}], ",", 
     RowBox[{"Mod", "[", 
      RowBox[{"a", ",", "360"}], "]"}], ",", 
     RowBox[{"Mod", "[", 
      RowBox[{
       RowBox[{"a", "+", "180"}], ",", "360"}], "]"}]}], "]"}], "/.", 
   RowBox[{
   "nlmLT3", "[", "\"\<BestFitParameters\>\"", 
    "]"}]}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.686541576935083*^9, 3.68654162453118*^9}, {
   3.68654166041891*^9, 3.6865418007120667`*^9}, {3.686541841215205*^9, 
   3.6865419852271214`*^9}, {3.686542389892214*^9, 3.686542399337966*^9}, {
   3.686542429538813*^9, 3.68654249091702*^9}, {3.686542599360292*^9, 
   3.686542636236602*^9}, {3.68654266976742*^9, 3.686542711861766*^9}, {
   3.6865428275446243`*^9, 3.686542884519163*^9}, {3.686545451919592*^9, 
   3.6865455941003036`*^9}, {3.686545702444227*^9, 3.686545734104954*^9}, {
   3.6865457646111593`*^9, 3.686545830136656*^9}, {3.6865458645759363`*^9, 
   3.6865459343458014`*^9}, {3.6865464210203342`*^9, 3.68654642150637*^9}, {
   3.6865464559090357`*^9, 3.686546473194869*^9}, {3.686549064276119*^9, 
   3.686549064506768*^9}, {3.6865561949415627`*^9, 3.686556200747735*^9}, {
   3.686556909848901*^9, 3.686556910302525*^9}, {3.686557060996511*^9, 
   3.686557091017144*^9}, {3.686557203978477*^9, 3.686557205913137*^9}, {
   3.686557281239862*^9, 3.686557324245544*^9}, 3.6865573783517313`*^9, {
   3.686557418142352*^9, 3.686557433426626*^9}, {3.686557490420044*^9, 
   3.6865575373131123`*^9}, {3.686557571396649*^9, 3.686557655537858*^9}, 
   3.686558339839075*^9, {3.6865583779464912`*^9, 3.686558379778133*^9}, {
   3.6865584170108137`*^9, 3.686558444563999*^9}, {3.6865585614448347`*^9, 
   3.686558572376584*^9}, {3.686634120010921*^9, 3.686634127306961*^9}, {
   3.687006797733555*^9, 3.687006822034884*^9}, {3.6870068786267843`*^9, 
   3.687006878758008*^9}, {3.687006911056613*^9, 3.687006953190476*^9}, {
   3.6870078647545652`*^9, 3.687007864881406*^9}, {3.687007974496911*^9, 
   3.687007975096767*^9}, 3.688302017799521*^9}],

Cell[BoxData[
 TagBox[
  GraphicsBox[{{{}, {{}, 
      {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
       0.012833333333333334`], AbsoluteThickness[1.6], 
       PointBox[CompressedData["
1:eJxTTMoPSmViYGCQBGIQDQF+By4kHZ+/esM7+9WrgCDL5UDZx1vRiZ/f268B
8VeZHmC4ebrSt/q9vQBYPcuBWZFbdbhi3tqvAMsbOFix9Gw4deIlhP/K0WHf
27CrHFpP7f/9B4J6b4f4p82JEswP7MHKu4Ic8vq3K984c9U+JBQEwh1WPLjm
6T31JES9fIzDhEfPP6/6tx0iX5rgoPDkh+u79IUQ/beSHBZU1N2e8WW2PUj5
f/tUhxfhMvUfuTZD1C9NdyiTYT4WffgoRD1XlkPQOY+8k5GXIebn5zjwvDOP
2hl3F6L+ap5DX//cVRcfPrYHO2dugcOLX+/7Oje8gJh/vtDhOnOr591JbyDm
MRU7iGktNkiVeg/Rb1ri8MV2kaP1//cQ9emlDtMCzK59U38PUT+rzGFTUe+j
ujVvIOrPljt0zZzQlXQZav7/CgefsmV1zFxP7AH6dNek
        "]]}, {}}, {}}, {{{}, {}, 
      {RGBColor[0.880722, 0.611041, 0.142051], AbsoluteThickness[1.6], 
       Opacity[1.], LineBox[CompressedData["
1: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
CQXd6o0aL/mE/Q97eTSDoKC6toSpxK8kJLYWf9hTR0FTZ/SlmL+TcI6j3OFh
AwUdOvJkt3M/jlds3T3/Fgr6dvAaM/sPEuaf9fSadlOQ/MJO1i2jJJRNfL/c
+BnrHT9VrjRGwnXZYUbVXgqyvuLEbfOLBKaSaUnxfgryn2rpjJrA+lZm3yYO
UhCHx265lEkS7qstm+0YpqDuR0JK2VMkcDYw+f8do6Dvv65CGp2EblZWdsoE
BW0xb0UxJAk0o21pv6Yo6NmXDROBMyQIdfO0dP2moF8VJxXUZ0mQHZbem/OH
gtz2yj50XsD5IqbwUnCdgvgP8tTzLpLw2u2I5mMGKtqa35z0HrPqrIZbEAsV
iVFV1Xctk8CgpLu+sImKuBSdmPMx118zir60hYrY9HmvaKyQYMh4psJiOxXZ
J8keMF0lgV3HxqSVk4pK+LYEtmL+GOYwpMFFRTrevhSNPyQ8aT3vU8pNRc6+
wJaP2YrDfYvMHioSvSyrs2uNBAHzq8lpvFR0YS+XMBXzj1gfhd0CVLReWZf8
HnPG1+uND4So6NVWrirevyS4CgZbbRChIrdjA4HOmKWdQul++7G9BaYfmZjJ
Z+G36OJUtNfefmQAc9FEFLezFBU18n0L27FOgo/sk5xeaSpa0rFr++++XMUr
Qf2EHBV1eH585YB5/XXKx/qDVDSYK64aiLl2JfO8yiEqEggxdX6E+Y7ai9V8
JSpaXNWUSf3vvj+4IHL/USoyjFp+8t/9/taG1/sSjlFRgNqV1P/u9ztY35Rw
qFPReZ8Mo//u92OMCINQhOMn+ZQWidkyqqH/jyYVHat2ueOLmbe7xeuqDhUh
3g07z2Lu5+nYOKZLRZIJdzQUMadZf4q3MaAiPp5/HBsxZ8vavm40oqJM1fS7
H7HePMaf7fInqIh1MXo49j/93e4T8WZUVE//JWqBuSxrnpnFnIoo2+oMt2Gu
8r8h6GFBRWUUTcu3ON71xswqvZZUpBQYbnAec/vcTo88Wyqa2833Iw0/v+7G
hHs89lTUElZ5RwlzX5xIRrAjFY1a93DU4ec/Coq9py9QkYPnma+NOF+mdryZ
q75IRfLnZXjVMf/+qcku5U5FU+LOmi9xfq2Fn9Ra96Si1eU13WtLuF7O9dm6
UqjIKHJSrBvn5yYFR7+P3lRk8ucUXRzzjp6rec/8qWhtuO1IxTwJu1+sNHEE
UJFa8d2K5TmcT4HBQ/43qWgL4yZxecySov/jORGC9R16V3XvN66Ppd0K5aE4
PkdaJ17g+jnUkmIkco+KXGd2MTXh+kKeBcFLD3A+yQnPj02TYFHZPvk0loqW
X2rPdo+TYPPwzMYt8VSUkR8TUoXr28FxQIiaSEUq9o0sqbj+3VnJ03qpVHTu
Qu9n058k3DZnJ2ZyqOgIW2Wt9SAJYeJP+qzyqOjiJsavWwdIiFzlX6jPp6Ih
m6jREtx/4lNkpOJe4fyy/de70EdCwZRRjEYVFUnITGoJ4v5VUt398gVBRe7z
yqy0LtwPo23e7aqjovv0jQ2bcb9rVHZfH2+iohiFP1I9bSR8Cwl3je7Eega+
Vwo1k7CZv0V1eATXR3pLlkM5CVHpDl0iY1S0O/iFRQTuv9xSKxedx7GeG7Wz
Bbg/7zsiEftzmop+Vd9ZGCvE/cIs9PfYItZXEKGyLYeEK3c0n02xeiOJki7K
4TjcH9n6VGXYvNFv+9BT//D54B99tevyNm9Uz2wmU4fPj7tPUxhITm+UbF7x
UTmKhJTydavfe70RcfjI+tdQErqmK7YvSnujHQd8c5gouF9QTz5TkvNG2V8Z
Etzx+TW4Oq7qe9AbcYSOxnTg821q0x635cPeiDtzPDvUlYSN+3zrV9W90SNO
E48XtiQoWyhe+2fqjU6Iw8We4yQkVb0YYvX2Ruw7RKWaufD5GP6Cy9/XG92X
DvCT4SRB4eyL45PXvJHFLp2Z8G34fJrLyfkQ6I267446HtqI9UnkeEWHeSN9
FBqiuEQHo0fZTHyJ3mj5lon2FD7/Vy9k7pOr80bPd7QVm8fQQedwpnlKgzfy
jxEsHnpIhyimzFDOZm/knM662y2cDmJJGRNzrd5I+cPiXhf8/mH2Mb2o7LM3
zmdttNWTDtmqaZqaE96Ib+b1hNB/7y+cTx1Pc/qgThvbK5SVadgX/ZIjaacP
WpUPHA2fn4bpHVVVI7t8EF+lxrdkchpCuL7vpe71QT4DBXqvfk5DMQ9vV7SI
D/ro+8I2qXMaOARitToO+yBa7lEtt+xpeCf1UNTQygf1651699dsGlS1b46i
dB/E9UJd+d7jKTAw5+QNyPRBn85H3r/6cArOOKefKM/yQRxfaHyn702BV0hT
2cFcHxRRen4ze8AUZNdvD9/32gfJLbDp6zpPwS6dFDnmJh9U1PXiZu/BKaDr
1Pg1TfigPQzV+yLfTUKq7gY2EwVfVKJ6qrV5cgKk12ibb33wReeFw+6tdP2C
kSjeraft/JBlulVfa9YoxNfWlX6190PDbh+Si5NGwXT+kpOjkx+SeGqtG/to
FCrPVFZ4uPqhhm/TlqdvjkKMgO3F+15+aEZcmS3PYhS0cpMbq0P9UAdzDW87
8yikNQkHS+X7oU8Zo0WM536C5co76cJCP/T1S86XSPOfwH7Aq+fIKz807+Yc
ssfgJ/hH1srplPshBsGI++KHf8LJ00795+r80NUrxFcxtp/ANJxx7PEXP+SI
ZMVKS0agjMt4jLfPD6n3pKgJ5o7AleML0Wnf/FCLypD8ndQR6HuuM5H/ww9R
6+nVBhEjUOQ5SmuZ9ENWh45wvXUYAde0SG0zuh/KHRZK5jozAgLdSjNfZvyQ
4EY5WTejEbh/5K7uzwU/dOLxovf2IyOALsrNXVr2Q0PnzZTPSY/AYvyX5NlV
P/TdYyd3nvAI5LbeNLj21w9tqHvItcI9Ag7r4ov//uF4Oew9qrV1BP4Pi0lT
1w==
        "]]}}, {}}},
   AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
   Axes->{True, True},
   AxesLabel->{None, None},
   AxesOrigin->{0, 0},
   DisplayFunction->Identity,
   Frame->{{False, False}, {False, False}},
   FrameLabel->{{None, None}, {None, None}},
   FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
   GridLines->{None, None},
   GridLinesStyle->Directive[
     GrayLevel[0.5, 0.4]],
   ImagePadding->All,
   Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
         (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
          Part[#, 1]], 
         (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
          Part[#, 2]]}& ), "CopiedValueFunction" -> ({
         (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
          Part[#, 1]], 
         (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
          Part[#, 2]]}& )}},
   PlotRange->{{-60., 399.99999999999994`}, {0, 0.9999061853322346}},
   PlotRangeClipping->True,
   PlotRangePadding->{{
      Scaled[0.02], 
      Scaled[0.02]}, {
      Scaled[0.02], 
      Scaled[0.05]}},
   Ticks->{Automatic, Automatic}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6865419371264143`*^9, 3.686541985789657*^9}, {
   3.686542430840075*^9, 3.6865424403658752`*^9}, {3.6865424720191383`*^9, 
   3.686542491446506*^9}, 3.686542602797411*^9, {3.6865427047506227`*^9, 
   3.68654271212569*^9}, 3.686542831583559*^9, {3.686542861634651*^9, 
   3.686542884774621*^9}, {3.6865455380057917`*^9, 3.686545594738501*^9}, {
   3.686545725922078*^9, 3.6865457347336807`*^9}, 3.686545771536426*^9, {
   3.686545804383078*^9, 3.686545830699154*^9}, 3.686545891394388*^9, {
   3.686545930021784*^9, 3.686545935264482*^9}, 3.686546423407386*^9, {
   3.686546465068982*^9, 3.68654647425102*^9}, 3.686549069387773*^9, 
   3.686556956252413*^9, {3.6865570639763813`*^9, 3.6865570919258223`*^9}, 
   3.686557212220983*^9, {3.6865573100720654`*^9, 3.686557324919175*^9}, 
   3.686557378845118*^9, 3.686557540643362*^9, {3.686557576029929*^9, 
   3.6865575862728786`*^9}, {3.6865576343420353`*^9, 3.686557655853324*^9}, 
   3.686558307579051*^9, {3.6865583733673887`*^9, 3.686558380334867*^9}, {
   3.6865584274557*^9, 3.686558445023226*^9}, {3.686558563300543*^9, 
   3.6865585731632833`*^9}, {3.686560844950132*^9, 3.686560873455936*^9}, 
   3.6865609187484217`*^9, 3.6865677512529383`*^9, 3.6865683238806047`*^9, {
   3.686634118056233*^9, 3.686634154354785*^9}, 3.686634200895157*^9, 
   3.6869160589016743`*^9, 3.686977932493805*^9, 3.686992447658745*^9, 
   3.68700564573427*^9, 3.687006616472499*^9, 3.687006711177898*^9, 
   3.6870068256509542`*^9, {3.687006861033456*^9, 3.687006879674192*^9}, {
   3.6870069176947107`*^9, 3.6870069699051857`*^9}, {3.6870078658255663`*^9, 
   3.687007872912479*^9}, 3.6870079856737022`*^9, 3.6870609273932667`*^9, 
   3.68706803783532*^9, 3.6870681460518017`*^9, 3.687073087469614*^9, 
   3.68709207022536*^9, 3.687092121766428*^9, 3.687094124162722*^9, {
   3.687182986692039*^9, 3.68718301428792*^9}, 3.688302108289522*^9, 
   3.688302166385413*^9}],

Cell[BoxData[
 TagBox["36.30293524416653`",
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6865419371264143`*^9, 3.686541985789657*^9}, {
   3.686542430840075*^9, 3.6865424403658752`*^9}, {3.6865424720191383`*^9, 
   3.686542491446506*^9}, 3.686542602797411*^9, {3.6865427047506227`*^9, 
   3.68654271212569*^9}, 3.686542831583559*^9, {3.686542861634651*^9, 
   3.686542884774621*^9}, {3.6865455380057917`*^9, 3.686545594738501*^9}, {
   3.686545725922078*^9, 3.6865457347336807`*^9}, 3.686545771536426*^9, {
   3.686545804383078*^9, 3.686545830699154*^9}, 3.686545891394388*^9, {
   3.686545930021784*^9, 3.686545935264482*^9}, 3.686546423407386*^9, {
   3.686546465068982*^9, 3.68654647425102*^9}, 3.686549069387773*^9, 
   3.686556956252413*^9, {3.6865570639763813`*^9, 3.6865570919258223`*^9}, 
   3.686557212220983*^9, {3.6865573100720654`*^9, 3.686557324919175*^9}, 
   3.686557378845118*^9, 3.686557540643362*^9, {3.686557576029929*^9, 
   3.6865575862728786`*^9}, {3.6865576343420353`*^9, 3.686557655853324*^9}, 
   3.686558307579051*^9, {3.6865583733673887`*^9, 3.686558380334867*^9}, {
   3.6865584274557*^9, 3.686558445023226*^9}, {3.686558563300543*^9, 
   3.6865585731632833`*^9}, {3.686560844950132*^9, 3.686560873455936*^9}, 
   3.6865609187484217`*^9, 3.6865677512529383`*^9, 3.6865683238806047`*^9, {
   3.686634118056233*^9, 3.686634154354785*^9}, 3.686634200895157*^9, 
   3.6869160589016743`*^9, 3.686977932493805*^9, 3.686992447658745*^9, 
   3.68700564573427*^9, 3.687006616472499*^9, 3.687006711177898*^9, 
   3.6870068256509542`*^9, {3.687006861033456*^9, 3.687006879674192*^9}, {
   3.6870069176947107`*^9, 3.6870069699051857`*^9}, {3.6870078658255663`*^9, 
   3.687007872912479*^9}, 3.6870079856737022`*^9, 3.6870609273932667`*^9, 
   3.68706803783532*^9, 3.6870681460518017`*^9, 3.687073087469614*^9, 
   3.68709207022536*^9, 3.687092121766428*^9, 3.687094124162722*^9, {
   3.687182986692039*^9, 3.68718301428792*^9}, 3.688302108289522*^9, 
   3.688302166405073*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Init methods", "Subchapter",
 CellChangeTimes->{{3.686625112083316*^9, 3.686625112402349*^9}, {
  3.686625431201563*^9, 3.6866254326401663`*^9}}],

Cell[CellGroupData[{

Cell["MBI", "Subsection",
 CellChangeTimes->{{3.686625434536603*^9, 3.686625447328678*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MBI", "=", 
   RowBox[{"getPulses", "[", 
    RowBox[{"basedirLT4", ",", "\"\<AWG_seqs_MBI\>\""}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.686625120021977*^9, 3.686625134089362*^9}, 
   3.6870920548412848`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MBI", "[", 
  RowBox[{"[", 
   RowBox[{";;", ",", "1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6866251404845963`*^9, 3.686625146521822*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"MBI_0\"\>", 
      "1", "\<\"MBI_0\"\>", "\<\"C_MBI1_C4_y_pt0_tau_0_N_0\"\>", 
      "0.000029756`"},
     {"\<\"C_MBI1_C4_y_pt0_tau_0_N_0\"\>", 
      "1", "\<\"MBI_0\"\>", "\<\"Tomo_y_pi2_init0_tau_0_N_0\"\>", 
      "0.0005176080000000024`"},
     {"\<\"Tomo_y_pi2_init0_tau_0_N_0\"\>", 
      "0", "\<\"MBI_1\"\>", "\<\"C_MBI1_C4_y_pt1_tau_0_N_0\"\>", 
      "0.00047804400000000234`"},
     {"\<\"MBI_1\"\>", 
      "1", "\<\"MBI_1\"\>", "\<\"C_MBI1_C4_y_pt1_tau_0_N_0\"\>", 
      "0.00047804400000000234`"},
     {"\<\"C_MBI1_C4_y_pt1_tau_0_N_0\"\>", 
      "1", "\<\"MBI_1\"\>", "\<\"Tomo_y_pi2_init1_tau_0_N_0\"\>", 
      "0.0005176080000000024`"},
     {"\<\"Tomo_y_pi2_init1_tau_0_N_0\"\>", 
      "0", "\<\"MBI_2\"\>", "\<\"C_MBI1_C4_y_pt2_tau_0_N_0\"\>", 
      "0.00047748000000000235`"},
     {"\<\"MBI_2\"\>", 
      "1", "\<\"MBI_2\"\>", "\<\"C_MBI1_C4_y_pt2_tau_0_N_0\"\>", 
      "0.00047748000000000235`"},
     {"\<\"C_MBI1_C4_y_pt2_tau_0_N_0\"\>", 
      "1", "\<\"MBI_2\"\>", "\<\"phase_gate_Tomo4_Ren_a_24_2_tau_0_N_0\"\>", 
      "0.0005176080000000024`"},
     {"\<\"phase_gate_Tomo4_Ren_a_24_2_tau_0_N_0\"\>", 
      "0", "\<\"None\"\>", "\<\"None\"\>", "0.0008852280000000084`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.686625147040658*^9, 3.686628291195631*^9, 3.6866341568354807`*^9, 
   3.68663420270539*^9, 3.686916060976624*^9, 3.686977934381563*^9, 
   3.686992449402534*^9, 3.687005647540984*^9, 3.6870069704986467`*^9, 
   3.687007873183475*^9, 3.687007985961317*^9, 3.687014288798997*^9, 
   3.687060927680936*^9, 3.68706803811583*^9, 3.687068146370757*^9, 
   3.6870730878227577`*^9, 3.6870920709091063`*^9, 3.687092122141636*^9, 
   3.687094124658849*^9, {3.687182987198832*^9, 3.687183015024417*^9}, 
   3.688302108817415*^9, 3.6883021670562973`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MBIinit", "=", 
    RowBox[{
     RowBox[{"KP", "[", 
      RowBox[{
       SubscriptBox["\[ScriptCapitalP]", "0"], ",", 
       SubscriptBox["\[Sigma]", "0"]}], "]"}], ".", 
     RowBox[{"compiledPulse", "[", 
      RowBox[{"LT4C", ",", 
       RowBox[{"MBI", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TomoLT4MBIX", "=", 
   RowBox[{"compiledPulse", "[", 
    RowBox[{"LT4C", ",", 
     RowBox[{"MBI", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TomoLT4MBIY", "=", 
   RowBox[{"compiledPulse", "[", 
    RowBox[{"LT4C", ",", 
     RowBox[{"MBI", "[", 
      RowBox[{"[", "6", "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TomoLT4MBIZ", "=", 
    RowBox[{"compiledPulse", "[", 
     RowBox[{"LT4C", ",", 
      RowBox[{"MBI", "[", 
       RowBox[{"[", "9", "]"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TomoMBI", "=", 
   RowBox[{"{", 
    RowBox[{"TomoLT4MBIX", ",", "TomoLT4MBIY", ",", "TomoLT4MBIZ"}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.686204250901569*^9, 3.6862043388278847`*^9}, {
   3.686204399421981*^9, 3.686204454400817*^9}, {3.686204635936344*^9, 
   3.6862046643738813`*^9}, {3.686204700797379*^9, 3.686204770994527*^9}, 
   3.686204846968647*^9, {3.6862048953542957`*^9, 3.686205018415694*^9}, {
   3.686205409140966*^9, 3.686205410255733*^9}, {3.686205746988648*^9, 
   3.6862057727718763`*^9}, {3.6862058117622223`*^9, 3.686205866322283*^9}, 
   3.6862073268265533`*^9, {3.686210218631989*^9, 3.686210219136548*^9}, {
   3.6862102619823*^9, 3.6862102918879967`*^9}, {3.686211789753356*^9, 
   3.686211820355667*^9}, {3.6862145552413816`*^9, 3.6862145553514643`*^9}, {
   3.686282347336713*^9, 3.686282454253824*^9}, {3.6862824956067457`*^9, 
   3.686282501762891*^9}, {3.6862825899611263`*^9, 3.6862825949995747`*^9}, {
   3.686282642143592*^9, 3.686282643438635*^9}, {3.686282701815427*^9, 
   3.6862827421531982`*^9}, {3.6862870166613817`*^9, 
   3.6862870498965693`*^9}, {3.6862872482883387`*^9, 3.6862872787972193`*^9}, 
   3.686287538861377*^9, {3.68628998535781*^9, 3.686290034243812*^9}, 
   3.686290210875903*^9, {3.6862902410725527`*^9, 3.6862902423432217`*^9}, {
   3.686563146781413*^9, 3.686563168954999*^9}, {3.6866251724103327`*^9, 
   3.686625265885684*^9}, {3.686625576171874*^9, 3.686625576431719*^9}, {
   3.686635860162251*^9, 3.686635878157276*^9}, {3.686637094526258*^9, 
   3.6866371050519867`*^9}, 3.6870142906588297`*^9}],

Cell["Init sets the carbon to something along the equator", "Text",
 CellChangeTimes->{{3.686571880724828*^9, 3.6865718839386387`*^9}, {
  3.686625287357882*^9, 3.686625291420733*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"pulseLT4", "=", "MBIinit"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"initState", "=", 
    RowBox[{"KP", "[", 
     RowBox[{
      SubscriptBox["\[ScriptCapitalP]", "0"], ",", 
      RowBox[{
       SubscriptBox["\[Sigma]", "0"], "/", "2"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"outState", "=", 
   RowBox[{"PTr", "[", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"transformAndNorm", "[", 
      RowBox[{"initState", ",", "pulseLT4"}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MBIrot", "=", 
   RowBox[{"compiledRotMat", "[", 
    RowBox[{"LT4C", ",", 
     RowBox[{"MBI", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"\[Rho]from\[Psi]", "[", 
      RowBox[{"Ket", "[", "0", "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"refX", "=", 
    RowBox[{
     RowBox[{"MBIrot", "\[ConjugateTranspose]"}], ".", "outState", ".", 
     "MBIrot"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MBIrot", "=", 
   RowBox[{"compiledRotMat", "[", 
    RowBox[{"LT4C", ",", 
     RowBox[{"MBI", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"\[Rho]from\[Psi]", "[", 
      RowBox[{"Ket", "[", "0", "]"}], "]"}], ",", "refX"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"outStateNFrame", "=", 
  RowBox[{
   RowBox[{"MBIrot", "\[ConjugateTranspose]"}], ".", "outState", ".", 
   "MBIrot"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.686282460485449*^9, 3.686282470631975*^9}, 
   3.6862875476279993`*^9, {3.686485215204461*^9, 3.68648521611836*^9}, 
   3.686625278586438*^9, {3.686637091429226*^9, 3.6866371715119867`*^9}, {
   3.686637581570655*^9, 3.6866375817190437`*^9}, {3.686637646374968*^9, 
   3.6866376465261*^9}, {3.686637735212188*^9, 3.686637742057613*^9}, {
   3.686638252467635*^9, 3.6866382942640877`*^9}, 3.6866383759798594`*^9, {
   3.6866387285963697`*^9, 3.6866387287262363`*^9}, {3.686638888979138*^9, 
   3.686638936108036*^9}, {3.686638988876012*^9, 3.6866389906006527`*^9}, {
   3.6866390413768263`*^9, 3.686639041589924*^9}, {3.686639097679895*^9, 
   3.686639127770845*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.48913908404718287`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.44337382675242787`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.23045048490926792`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.44337382675242787`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.23045048490926792`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.5108609159528171`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.68628246508217*^9, 3.686282472627087*^9}, 
   3.686282504493012*^9, 3.686282877196406*^9, 3.686287547961443*^9, 
   3.686290051161714*^9, 3.686290105379146*^9, 3.686290152417107*^9, 
   3.686290248398324*^9, 3.686299433782044*^9, 3.6863014220107718`*^9, 
   3.686301554450942*^9, 3.686303560437243*^9, 3.68630474528617*^9, 
   3.6863050399023037`*^9, 3.686306366666206*^9, 3.686306517880472*^9, 
   3.6863069671067467`*^9, 3.686307128159088*^9, 3.686309643577671*^9, 
   3.686309814091411*^9, 3.686312894828292*^9, 3.686313961559877*^9, 
   3.68636932080977*^9, 3.686369652040264*^9, 3.686371599127583*^9, 
   3.68637241007134*^9, 3.686372466131439*^9, 3.686374544948386*^9, 
   3.686375896595016*^9, 3.686473862649774*^9, 3.6864741082515907`*^9, 
   3.686474354140605*^9, {3.686474626980974*^9, 3.686474639954053*^9}, 
   3.686474885475119*^9, 3.686476203457204*^9, {3.6864763933170547`*^9, 
   3.686476411707259*^9}, 3.686478511393585*^9, 3.686478541979762*^9, {
   3.686484016332652*^9, 3.6864840345595627`*^9}, 3.68648479239027*^9, 
   3.686484862624865*^9, 3.686485226083433*^9, 3.686485444820953*^9, {
   3.686485992267687*^9, 3.686486046970426*^9}, 3.686486086125338*^9, 
   3.686539677274074*^9, 3.686541109855142*^9, {3.686560847257739*^9, 
   3.686560875959004*^9}, 3.6865609212362213`*^9, 3.686562764067292*^9, {
   3.686563150724677*^9, 3.686563174723487*^9}, 3.686567765703278*^9, 
   3.686568326644129*^9, 3.686625279640193*^9, 3.6866341569722147`*^9, 
   3.686634202804063*^9, 3.6866358897405*^9, 3.6866371719768457`*^9, 
   3.686637582540408*^9, {3.686637624459816*^9, 3.6866376469214897`*^9}, {
   3.6866377190149813`*^9, 3.686637743923914*^9}, {3.686638253317601*^9, 
   3.686638269282529*^9}, 3.686638382787109*^9, 3.686638729355094*^9, 
   3.6866388118623857`*^9, {3.686638870444841*^9, 3.686638883136478*^9}, 
   3.686638937259151*^9, {3.686638978322824*^9, 3.686639004903303*^9}, 
   3.6866390423132343`*^9, {3.6866390889550257`*^9, 3.686639128047668*^9}, 
   3.686916061211606*^9, 3.686977934524991*^9, 3.686992449530114*^9, 
   3.687005647733954*^9, 3.6870069706434803`*^9, 3.6870078733167*^9, 
   3.687007986121442*^9, 3.6870142937408333`*^9, 3.6870609277979307`*^9, 
   3.687068038239853*^9, 3.6870681465619297`*^9, 3.687073087959697*^9, 
   3.687092071473023*^9, 3.687092122287147*^9, 3.687094124810294*^9, {
   3.687182987328878*^9, 3.687183015428944*^9}, 3.68830210904213*^9, 
   3.688302167281932*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.4891390840471836`", "\[VeryThinSpace]", "+", 
       RowBox[{"1.3877787807814457`*^-17", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.49968767869941455`", "\[VeryThinSpace]", "-", 
       RowBox[{"8.326672684688674`*^-17", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.49968767869941455`", "\[VeryThinSpace]", "+", 
       RowBox[{"8.326672684688674`*^-17", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.5108609159528179`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.68628246508217*^9, 3.686282472627087*^9}, 
   3.686282504493012*^9, 3.686282877196406*^9, 3.686287547961443*^9, 
   3.686290051161714*^9, 3.686290105379146*^9, 3.686290152417107*^9, 
   3.686290248398324*^9, 3.686299433782044*^9, 3.6863014220107718`*^9, 
   3.686301554450942*^9, 3.686303560437243*^9, 3.68630474528617*^9, 
   3.6863050399023037`*^9, 3.686306366666206*^9, 3.686306517880472*^9, 
   3.6863069671067467`*^9, 3.686307128159088*^9, 3.686309643577671*^9, 
   3.686309814091411*^9, 3.686312894828292*^9, 3.686313961559877*^9, 
   3.68636932080977*^9, 3.686369652040264*^9, 3.686371599127583*^9, 
   3.68637241007134*^9, 3.686372466131439*^9, 3.686374544948386*^9, 
   3.686375896595016*^9, 3.686473862649774*^9, 3.6864741082515907`*^9, 
   3.686474354140605*^9, {3.686474626980974*^9, 3.686474639954053*^9}, 
   3.686474885475119*^9, 3.686476203457204*^9, {3.6864763933170547`*^9, 
   3.686476411707259*^9}, 3.686478511393585*^9, 3.686478541979762*^9, {
   3.686484016332652*^9, 3.6864840345595627`*^9}, 3.68648479239027*^9, 
   3.686484862624865*^9, 3.686485226083433*^9, 3.686485444820953*^9, {
   3.686485992267687*^9, 3.686486046970426*^9}, 3.686486086125338*^9, 
   3.686539677274074*^9, 3.686541109855142*^9, {3.686560847257739*^9, 
   3.686560875959004*^9}, 3.6865609212362213`*^9, 3.686562764067292*^9, {
   3.686563150724677*^9, 3.686563174723487*^9}, 3.686567765703278*^9, 
   3.686568326644129*^9, 3.686625279640193*^9, 3.6866341569722147`*^9, 
   3.686634202804063*^9, 3.6866358897405*^9, 3.6866371719768457`*^9, 
   3.686637582540408*^9, {3.686637624459816*^9, 3.6866376469214897`*^9}, {
   3.6866377190149813`*^9, 3.686637743923914*^9}, {3.686638253317601*^9, 
   3.686638269282529*^9}, 3.686638382787109*^9, 3.686638729355094*^9, 
   3.6866388118623857`*^9, {3.686638870444841*^9, 3.686638883136478*^9}, 
   3.686638937259151*^9, {3.686638978322824*^9, 3.686639004903303*^9}, 
   3.6866390423132343`*^9, {3.6866390889550257`*^9, 3.686639128047668*^9}, 
   3.686916061211606*^9, 3.686977934524991*^9, 3.686992449530114*^9, 
   3.687005647733954*^9, 3.6870069706434803`*^9, 3.6870078733167*^9, 
   3.687007986121442*^9, 3.6870142937408333`*^9, 3.6870609277979307`*^9, 
   3.687068038239853*^9, 3.6870681465619297`*^9, 3.687073087959697*^9, 
   3.687092071473023*^9, 3.687092122287147*^9, 3.687094124810294*^9, {
   3.687182987328878*^9, 3.687183015428944*^9}, 3.68830210904213*^9, 
   3.6883021672907887`*^9}]
}, Open  ]],

Cell["How does it look in different bases?", "Text",
 CellChangeTimes->{{3.68657188696192*^9, 3.6865718911696997`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bases", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "\[LessEqual]", "3"}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pulseLT4", "=", 
     RowBox[{
      RowBox[{"TomoMBI", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ".", "MBIinit"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"initState", "=", 
     RowBox[{"KP", "[", 
      RowBox[{
       SubscriptBox["\[ScriptCapitalP]", "0"], ",", 
       RowBox[{
        SubscriptBox["\[Sigma]", "0"], "/", "2"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"outState", "=", 
     RowBox[{"PTr", "[", 
      RowBox[{
       RowBox[{"{", "2", "}"}], ",", 
       RowBox[{"transformAndNorm", "[", 
        RowBox[{"initState", ",", "pulseLT4"}], "]"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
      RowBox[{"bases", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "<>", "\"\< \>\"", "<>", 
      RowBox[{"ToString", "[", 
       RowBox[{"Re", "[", 
        RowBox[{"Tr", "[", 
         RowBox[{
          SubscriptBox["\[Sigma]", "3"], ".", "outState"}], "]"}], "]"}], 
       "]"}]}], "]"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.686282460485449*^9, 3.686282470631975*^9}, {
   3.6862825183559637`*^9, 3.686282523375268*^9}, {3.6862825993943644`*^9, 
   3.686282628340599*^9}, {3.6862828891826773`*^9, 3.6862828967909517`*^9}, {
   3.686287286513729*^9, 3.686287353057444*^9}, {3.686287385376472*^9, 
   3.686287385528781*^9}, {3.686287423601384*^9, 3.6862874508597803`*^9}, {
   3.686287485927495*^9, 3.6862874861241207`*^9}, 3.6862875424098043`*^9, {
   3.686303735254549*^9, 3.686303838110813*^9}, {3.686303894589242*^9, 
   3.686303918201098*^9}, {3.6864738817849827`*^9, 3.6864738861137466`*^9}, {
   3.686485216928506*^9, 3.686485217716219*^9}, {3.6866253030068502`*^9, 
   3.6866253225264387`*^9}, {3.686625581690349*^9, 3.6866255820483093`*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"X 0.999226\"\>"], "Print",
 CellChangeTimes->{
  3.686625323732518*^9, 3.686625585710388*^9, 3.686634157083735*^9, 
   3.686634202917747*^9, 3.686916061351931*^9, 3.6869779346579933`*^9, 
   3.686992449644718*^9, 3.687005647888023*^9, 3.687006970777978*^9, 
   3.687007873523876*^9, 3.687007986255808*^9, 3.687060927905345*^9, 
   3.687068038364718*^9, 3.687068146759218*^9, 3.6870730881012163`*^9, 
   3.687092072516632*^9, 3.6870921224266567`*^9, 3.687094124945643*^9, {
   3.68718298747008*^9, 3.687183015640736*^9}, 3.688302109274478*^9, 
   3.6883021674040537`*^9}],

Cell[BoxData["\<\"Y 0.00155502\"\>"], "Print",
 CellChangeTimes->{
  3.686625323732518*^9, 3.686625585710388*^9, 3.686634157083735*^9, 
   3.686634202917747*^9, 3.686916061351931*^9, 3.6869779346579933`*^9, 
   3.686992449644718*^9, 3.687005647888023*^9, 3.687006970777978*^9, 
   3.687007873523876*^9, 3.687007986255808*^9, 3.687060927905345*^9, 
   3.687068038364718*^9, 3.687068146759218*^9, 3.6870730881012163`*^9, 
   3.687092072516632*^9, 3.6870921224266567`*^9, 3.687094124945643*^9, {
   3.68718298747008*^9, 3.687183015640736*^9}, 3.688302109274478*^9, 
   3.688302167418283*^9}],

Cell[BoxData["\<\"Z -0.120371\"\>"], "Print",
 CellChangeTimes->{
  3.686625323732518*^9, 3.686625585710388*^9, 3.686634157083735*^9, 
   3.686634202917747*^9, 3.686916061351931*^9, 3.6869779346579933`*^9, 
   3.686992449644718*^9, 3.687005647888023*^9, 3.687006970777978*^9, 
   3.687007873523876*^9, 3.687007986255808*^9, 3.687060927905345*^9, 
   3.687068038364718*^9, 3.687068146759218*^9, 3.6870730881012163`*^9, 
   3.687092072516632*^9, 3.6870921224266567`*^9, 3.687094124945643*^9, {
   3.68718298747008*^9, 3.687183015640736*^9}, 3.688302109274478*^9, 
   3.68830216743337*^9}]
}, Open  ]]
}, Open  ]],

Cell["Well that seems to work!", "Text",
 CellChangeTimes->{{3.6866253332363777`*^9, 3.686625336196816*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Swap", "Subsection",
 CellChangeTimes->{{3.686625434536603*^9, 3.686625435000729*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"swapInit", "=", 
   RowBox[{"getPulses", "[", 
    RowBox[{"basedirLT4", ",", "\"\<AWG_seqs_swap\>\""}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.686625120021977*^9, 3.686625134089362*^9}, {
   3.686625453950246*^9, 3.686625462416232*^9}, 3.687092054859613*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"swapInit", "[", 
  RowBox[{"[", 
   RowBox[{";;", ",", "1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6866251404845963`*^9, 3.686625146521822*^9}, 
   3.6866254656141253`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"MBI_0\"\>", 
      "1", "\<\"MBI_0\"\>", "\<\"C_swap1_C4_y_pt0_tau_0_N_0\"\>", 
      "0.000029756`"},
     {"\<\"C_swap1_C4_y_pt0_tau_0_N_0\"\>", 
      "1", "\<\"MBI_0\"\>", "\<\"Tomo_y_pi2_init0_tau_0_N_0\"\>", 
      "0.0009672480000000083`"},
     {"\<\"Tomo_y_pi2_init0_tau_0_N_0\"\>", 
      "0", "\<\"MBI_1\"\>", "\<\"C_swap1_C4_y_pt1_tau_0_N_0\"\>", 
      "0.0004794800000000024`"},
     {"\<\"MBI_1\"\>", 
      "1", "\<\"MBI_1\"\>", "\<\"C_swap1_C4_y_pt1_tau_0_N_0\"\>", 
      "0.0004794800000000024`"},
     {"\<\"C_swap1_C4_y_pt1_tau_0_N_0\"\>", 
      "1", "\<\"MBI_1\"\>", "\<\"Tomo_y_pi2_init1_tau_0_N_0\"\>", 
      "0.0009672480000000083`"},
     {"\<\"Tomo_y_pi2_init1_tau_0_N_0\"\>", 
      "0", "\<\"MBI_2\"\>", "\<\"C_swap1_C4_y_pt2_tau_0_N_0\"\>", 
      "0.00047891600000000235`"},
     {"\<\"MBI_2\"\>", 
      "1", "\<\"MBI_2\"\>", "\<\"C_swap1_C4_y_pt2_tau_0_N_0\"\>", 
      "0.00047891600000000235`"},
     {"\<\"C_swap1_C4_y_pt2_tau_0_N_0\"\>", 
      "1", "\<\"MBI_2\"\>", "\<\"phase_gate_Tomo4_Ren_a_25_2_tau_0_N_0\"\>", 
      "0.0009672480000000083`"},
     {"\<\"phase_gate_Tomo4_Ren_a_25_2_tau_0_N_0\"\>", 
      "0", "\<\"None\"\>", "\<\"None\"\>", "0.0008852280000000084`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.686625147040658*^9, 3.686625468115142*^9, 3.68662555050744*^9, 
   3.68663415741096*^9, 3.686634203130898*^9, 3.686916061754548*^9, 
   3.686977935058633*^9, 3.686992449823843*^9, 3.687005648098679*^9, 
   3.68700697117336*^9, 3.68700787391254*^9, 3.687007986435787*^9, 
   3.687060928147772*^9, 3.687068038570024*^9, 3.687068146999104*^9, 
   3.687073088358831*^9, 3.687092072968315*^9, 3.687092122790835*^9, 
   3.687094125481167*^9, {3.687182987912569*^9, 3.687183015988016*^9}, 
   3.6883021100753*^9, 3.688302167816361*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"swapinit", "=", 
    RowBox[{
     RowBox[{"KP", "[", 
      RowBox[{
       SubscriptBox["\[ScriptCapitalP]", "0"], ",", 
       SubscriptBox["\[Sigma]", "0"]}], "]"}], ".", 
     RowBox[{"compiledPulse", "[", 
      RowBox[{"LT4C", ",", 
       RowBox[{"swapInit", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TomoLT4swapX", "=", 
   RowBox[{"compiledPulse", "[", 
    RowBox[{"LT4C", ",", 
     RowBox[{"swapInit", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TomoLT4swapY", "=", 
   RowBox[{"compiledPulse", "[", 
    RowBox[{"LT4C", ",", 
     RowBox[{"swapInit", "[", 
      RowBox[{"[", "6", "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TomoLT4swapZ", "=", 
    RowBox[{"compiledPulse", "[", 
     RowBox[{"LT4C", ",", 
      RowBox[{"swapInit", "[", 
       RowBox[{"[", "9", "]"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TomoSwap", "=", 
   RowBox[{"{", 
    RowBox[{"TomoLT4swapX", ",", "TomoLT4swapY", ",", "TomoLT4swapZ"}], 
    "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.686204250901569*^9, 3.6862043388278847`*^9}, {
   3.686204399421981*^9, 3.686204454400817*^9}, {3.686204635936344*^9, 
   3.6862046643738813`*^9}, {3.686204700797379*^9, 3.686204770994527*^9}, 
   3.686204846968647*^9, {3.6862048953542957`*^9, 3.686205018415694*^9}, {
   3.686205409140966*^9, 3.686205410255733*^9}, {3.686205746988648*^9, 
   3.6862057727718763`*^9}, {3.6862058117622223`*^9, 3.686205866322283*^9}, 
   3.6862073268265533`*^9, {3.686210218631989*^9, 3.686210219136548*^9}, {
   3.6862102619823*^9, 3.6862102918879967`*^9}, {3.686211789753356*^9, 
   3.686211820355667*^9}, {3.6862145552413816`*^9, 3.6862145553514643`*^9}, {
   3.686282347336713*^9, 3.686282454253824*^9}, {3.6862824956067457`*^9, 
   3.686282501762891*^9}, {3.6862825899611263`*^9, 3.6862825949995747`*^9}, {
   3.686282642143592*^9, 3.686282643438635*^9}, {3.686282701815427*^9, 
   3.6862827421531982`*^9}, {3.6862870166613817`*^9, 
   3.6862870498965693`*^9}, {3.6862872482883387`*^9, 3.6862872787972193`*^9}, 
   3.686287538861377*^9, {3.68628998535781*^9, 3.686290034243812*^9}, 
   3.686290210875903*^9, {3.6862902410725527`*^9, 3.6862902423432217`*^9}, {
   3.686563146781413*^9, 3.686563168954999*^9}, {3.6866251724103327`*^9, 
   3.686625265885684*^9}, {3.6866254716827374`*^9, 3.686625542523162*^9}, 
   3.686639187182208*^9}],

Cell["Init sets the carbon to Z", "Text",
 CellChangeTimes->{{3.686571880724828*^9, 3.6865718839386387`*^9}, {
   3.686625287357882*^9, 3.686625291420733*^9}, 3.6866255621583233`*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"pulseLT4", "=", "swapinit"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"initState", "=", 
   RowBox[{"KP", "[", 
    RowBox[{
     SubscriptBox["\[ScriptCapitalP]", "0"], ",", 
     RowBox[{
      SubscriptBox["\[Sigma]", "0"], "/", "2"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"outState", "=", 
  RowBox[{"PTr", "[", 
   RowBox[{
    RowBox[{"{", "1", "}"}], ",", 
    RowBox[{"transformAndNorm", "[", 
     RowBox[{"initState", ",", "pulseLT4"}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.686282460485449*^9, 3.686282470631975*^9}, 
   3.6862875476279993`*^9, {3.686485215204461*^9, 3.68648521611836*^9}, 
   3.686625278586438*^9, 3.6866255071331453`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.9985315455403462`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.03518205445354916`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.005852938144577463`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.03518205445354916`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.005852938144577463`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.001468454459654045`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.68628246508217*^9, 3.686282472627087*^9}, 
   3.686282504493012*^9, 3.686282877196406*^9, 3.686287547961443*^9, 
   3.686290051161714*^9, 3.686290105379146*^9, 3.686290152417107*^9, 
   3.686290248398324*^9, 3.686299433782044*^9, 3.6863014220107718`*^9, 
   3.686301554450942*^9, 3.686303560437243*^9, 3.68630474528617*^9, 
   3.6863050399023037`*^9, 3.686306366666206*^9, 3.686306517880472*^9, 
   3.6863069671067467`*^9, 3.686307128159088*^9, 3.686309643577671*^9, 
   3.686309814091411*^9, 3.686312894828292*^9, 3.686313961559877*^9, 
   3.68636932080977*^9, 3.686369652040264*^9, 3.686371599127583*^9, 
   3.68637241007134*^9, 3.686372466131439*^9, 3.686374544948386*^9, 
   3.686375896595016*^9, 3.686473862649774*^9, 3.6864741082515907`*^9, 
   3.686474354140605*^9, {3.686474626980974*^9, 3.686474639954053*^9}, 
   3.686474885475119*^9, 3.686476203457204*^9, {3.6864763933170547`*^9, 
   3.686476411707259*^9}, 3.686478511393585*^9, 3.686478541979762*^9, {
   3.686484016332652*^9, 3.6864840345595627`*^9}, 3.68648479239027*^9, 
   3.686484862624865*^9, 3.686485226083433*^9, 3.686485444820953*^9, {
   3.686485992267687*^9, 3.686486046970426*^9}, 3.686486086125338*^9, 
   3.686539677274074*^9, 3.686541109855142*^9, {3.686560847257739*^9, 
   3.686560875959004*^9}, 3.6865609212362213`*^9, 3.686562764067292*^9, {
   3.686563150724677*^9, 3.686563174723487*^9}, 3.686567765703278*^9, 
   3.686568326644129*^9, 3.686625279640193*^9, 3.686625556261685*^9, 
   3.686634157823495*^9, 3.6866342032528133`*^9, 3.686916062268778*^9, 
   3.686977935209404*^9, 3.686992449940442*^9, 3.6870056482496367`*^9, 
   3.6870069716398783`*^9, 3.687007874047398*^9, 3.687007986572865*^9, 
   3.6870609282652693`*^9, 3.68706803869298*^9, 3.687068147216382*^9, 
   3.6870730884923887`*^9, 3.687092073109482*^9, 3.687092122939496*^9, 
   3.6870941255993433`*^9, {3.6871829880466423`*^9, 3.6871830161169662`*^9}, 
   3.688302110249082*^9, 3.688302167947259*^9}]
}, Open  ]],

Cell["How does it look in different bases?", "Text",
 CellChangeTimes->{{3.68657188696192*^9, 3.6865718911696997`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bases", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "\[LessEqual]", "3"}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pulseLT4", "=", 
     RowBox[{
      RowBox[{"TomoSwap", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ".", "swapinit"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"initState", "=", 
     RowBox[{"KP", "[", 
      RowBox[{
       SubscriptBox["\[ScriptCapitalP]", "0"], ",", 
       RowBox[{
        SubscriptBox["\[Sigma]", "0"], "/", "2"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"outState", "=", 
     RowBox[{"PTr", "[", 
      RowBox[{
       RowBox[{"{", "2", "}"}], ",", 
       RowBox[{"transformAndNorm", "[", 
        RowBox[{"initState", ",", "pulseLT4"}], "]"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
      RowBox[{"bases", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "<>", "\"\< \>\"", "<>", 
      RowBox[{"ToString", "[", 
       RowBox[{"Re", "[", 
        RowBox[{"Tr", "[", 
         RowBox[{
          SubscriptBox["\[Sigma]", "3"], ".", "outState"}], "]"}], "]"}], 
       "]"}]}], "]"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.686282460485449*^9, 3.686282470631975*^9}, {
   3.6862825183559637`*^9, 3.686282523375268*^9}, {3.6862825993943644`*^9, 
   3.686282628340599*^9}, {3.6862828891826773`*^9, 3.6862828967909517`*^9}, {
   3.686287286513729*^9, 3.686287353057444*^9}, {3.686287385376472*^9, 
   3.686287385528781*^9}, {3.686287423601384*^9, 3.6862874508597803`*^9}, {
   3.686287485927495*^9, 3.6862874861241207`*^9}, 3.6862875424098043`*^9, {
   3.686303735254549*^9, 3.686303838110813*^9}, {3.686303894589242*^9, 
   3.686303918201098*^9}, {3.6864738817849827`*^9, 3.6864738861137466`*^9}, {
   3.686485216928506*^9, 3.686485217716219*^9}, {3.6866253030068502`*^9, 
   3.6866253225264387`*^9}, 3.6866255131812162`*^9}],

Cell[CellGroupData[{

Cell[BoxData["\<\"X -0.0910959\"\>"], "Print",
 CellChangeTimes->{
  3.686625323732518*^9, 3.686625595657772*^9, 3.686634157929823*^9, 
   3.6866342033521967`*^9, 3.686916062354003*^9, 3.6869779353264914`*^9, 
   3.6869924500447187`*^9, 3.687005648513619*^9, 3.687006971829884*^9, 
   3.687007874147114*^9, 3.6870079866788607`*^9, 3.687060928366242*^9, 
   3.6870680388097057`*^9, 3.687068147404828*^9, 3.687073088617625*^9, 
   3.687092073230691*^9, 3.687092123077188*^9, 3.6870941257386713`*^9, {
   3.68718298815138*^9, 3.68718301622865*^9}, 3.688302110340797*^9, 
   3.688302168053315*^9}],

Cell[BoxData["\<\"Y -0.0365607\"\>"], "Print",
 CellChangeTimes->{
  3.686625323732518*^9, 3.686625595657772*^9, 3.686634157929823*^9, 
   3.6866342033521967`*^9, 3.686916062354003*^9, 3.6869779353264914`*^9, 
   3.6869924500447187`*^9, 3.687005648513619*^9, 3.687006971829884*^9, 
   3.687007874147114*^9, 3.6870079866788607`*^9, 3.687060928366242*^9, 
   3.6870680388097057`*^9, 3.687068147404828*^9, 3.687073088617625*^9, 
   3.687092073230691*^9, 3.687092123077188*^9, 3.6870941257386713`*^9, {
   3.68718298815138*^9, 3.68718301622865*^9}, 3.688302110340797*^9, 
   3.6883021680668716`*^9}],

Cell[BoxData["\<\"Z 0.986593\"\>"], "Print",
 CellChangeTimes->{
  3.686625323732518*^9, 3.686625595657772*^9, 3.686634157929823*^9, 
   3.6866342033521967`*^9, 3.686916062354003*^9, 3.6869779353264914`*^9, 
   3.6869924500447187`*^9, 3.687005648513619*^9, 3.687006971829884*^9, 
   3.687007874147114*^9, 3.6870079866788607`*^9, 3.687060928366242*^9, 
   3.6870680388097057`*^9, 3.687068147404828*^9, 3.687073088617625*^9, 
   3.687092073230691*^9, 3.687092123077188*^9, 3.6870941257386713`*^9, {
   3.68718298815138*^9, 3.68718301622865*^9}, 3.688302110340797*^9, 
   3.6883021680789137`*^9}]
}, Open  ]]
}, Open  ]],

Cell["That also seems to work!", "Text",
 CellChangeTimes->{{3.6866253332363777`*^9, 3.686625336196816*^9}, {
  3.686625601161495*^9, 3.686625605118492*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["MBI y", "Subsection",
 CellChangeTimes->{{3.686625434536603*^9, 3.686625447328678*^9}, {
  3.686627748238015*^9, 3.68662774849048*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MBIy", "=", 
   RowBox[{"getPulses", "[", 
    RowBox[{"basedirLT4", ",", "\"\<AWG_seqs_MBI_y\>\""}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6866341887618847`*^9, 3.686634192775004*^9}, 
   3.687092054882069*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"MBI", "[", 
   RowBox[{"[", 
    RowBox[{"2", ",", "2"}], "]"}], "]"}], "\[Equal]", 
  RowBox[{"MBIy", "[", 
   RowBox[{"[", 
    RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MBI", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1", ",", "5"}], "]"}], "]"}], "\[Equal]", 
   RowBox[{"MBIy", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1", ",", "5"}], "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MBI", "[", 
   RowBox[{"[", 
    RowBox[{"3", ",", "2"}], "]"}], "]"}], "\[Equal]", 
  RowBox[{"MBIy", "[", 
   RowBox[{"[", 
    RowBox[{"3", ",", "2"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MBI", "[", 
   RowBox[{"[", 
    RowBox[{"3", ",", "1", ",", "5"}], "]"}], "]"}], "\[Equal]", 
  RowBox[{"MBIy", "[", 
   RowBox[{"[", 
    RowBox[{"3", ",", "1", ",", "5"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.686628301431383*^9, 3.686628346053588*^9}}],

Cell[BoxData[
 TagBox["True",
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6866283127986727`*^9, 3.686628346556302*^9}, 
   3.6866341580551453`*^9, {3.686634194513732*^9, 3.686634203548944*^9}, 
   3.686916062686798*^9, 3.686977935509262*^9, 3.686992450323736*^9, 
   3.687005648859672*^9, 3.687006972233638*^9, 3.687007874329137*^9, 
   3.687007986976659*^9, 3.687060928738751*^9, 3.687068039057962*^9, 
   3.687068147619011*^9, 3.687073089047324*^9, 3.687092073976953*^9, 
   3.687092123548594*^9, 3.687094126185351*^9, {3.687182988553637*^9, 
   3.6871830169607353`*^9}, 3.6883021107448072`*^9, 3.688302168454854*^9}],

Cell[BoxData[
 TagBox["True",
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6866283127986727`*^9, 3.686628346556302*^9}, 
   3.6866341580551453`*^9, {3.686634194513732*^9, 3.686634203548944*^9}, 
   3.686916062686798*^9, 3.686977935509262*^9, 3.686992450323736*^9, 
   3.687005648859672*^9, 3.687006972233638*^9, 3.687007874329137*^9, 
   3.687007986976659*^9, 3.687060928738751*^9, 3.687068039057962*^9, 
   3.687068147619011*^9, 3.687073089047324*^9, 3.687092073976953*^9, 
   3.687092123548594*^9, 3.687094126185351*^9, {3.687182988553637*^9, 
   3.6871830169607353`*^9}, 3.6883021107448072`*^9, 3.688302168470375*^9}],

Cell[BoxData[
 TagBox["False",
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6866283127986727`*^9, 3.686628346556302*^9}, 
   3.6866341580551453`*^9, {3.686634194513732*^9, 3.686634203548944*^9}, 
   3.686916062686798*^9, 3.686977935509262*^9, 3.686992450323736*^9, 
   3.687005648859672*^9, 3.687006972233638*^9, 3.687007874329137*^9, 
   3.687007986976659*^9, 3.687060928738751*^9, 3.687068039057962*^9, 
   3.687068147619011*^9, 3.687073089047324*^9, 3.687092073976953*^9, 
   3.687092123548594*^9, 3.687094126185351*^9, {3.687182988553637*^9, 
   3.6871830169607353`*^9}, 3.6883021107448072`*^9, 3.6883021684784117`*^9}],

Cell[BoxData[
 TagBox["False",
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6866283127986727`*^9, 3.686628346556302*^9}, 
   3.6866341580551453`*^9, {3.686634194513732*^9, 3.686634203548944*^9}, 
   3.686916062686798*^9, 3.686977935509262*^9, 3.686992450323736*^9, 
   3.687005648859672*^9, 3.687006972233638*^9, 3.687007874329137*^9, 
   3.687007986976659*^9, 3.687060928738751*^9, 3.687068039057962*^9, 
   3.687068147619011*^9, 3.687073089047324*^9, 3.687092073976953*^9, 
   3.687092123548594*^9, 3.687094126185351*^9, {3.687182988553637*^9, 
   3.6871830169607353`*^9}, 3.6883021107448072`*^9, 3.688302168486775*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MBIy", "[", 
  RowBox[{"[", 
   RowBox[{";;", ",", "1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6866251404845963`*^9, 3.686625146521822*^9}, 
   3.6866282735792723`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"MBI_0\"\>", 
      "1", "\<\"MBI_0\"\>", "\<\"C_MBI_y1_C4_y_pt0_tau_0_N_0\"\>", 
      "0.000029756`"},
     {"\<\"C_MBI_y1_C4_y_pt0_tau_0_N_0\"\>", 
      "1", "\<\"MBI_0\"\>", "\<\"Tomo_y_pi2_init0_tau_0_N_0\"\>", 
      "0.0005176080000000024`"},
     {"\<\"Tomo_y_pi2_init0_tau_0_N_0\"\>", 
      "0", "\<\"MBI_1\"\>", "\<\"C_MBI_y1_C4_y_pt1_tau_0_N_0\"\>", 
      "0.0004786080000000024`"},
     {"\<\"MBI_1\"\>", 
      "1", "\<\"MBI_1\"\>", "\<\"C_MBI_y1_C4_y_pt1_tau_0_N_0\"\>", 
      "0.0004786080000000024`"},
     {"\<\"C_MBI_y1_C4_y_pt1_tau_0_N_0\"\>", 
      "1", "\<\"MBI_1\"\>", "\<\"Tomo_y_pi2_init1_tau_0_N_0\"\>", 
      "0.0005176080000000024`"},
     {"\<\"Tomo_y_pi2_init1_tau_0_N_0\"\>", 
      "0", "\<\"MBI_2\"\>", "\<\"C_MBI_y1_C4_y_pt2_tau_0_N_0\"\>", 
      "0.00047804400000000234`"},
     {"\<\"MBI_2\"\>", 
      "1", "\<\"MBI_2\"\>", "\<\"C_MBI_y1_C4_y_pt2_tau_0_N_0\"\>", 
      "0.00047804400000000234`"},
     {"\<\"C_MBI_y1_C4_y_pt2_tau_0_N_0\"\>", 
      "1", "\<\"MBI_2\"\>", "\<\"phase_gate_Tomo4_Ren_a_24_2_tau_0_N_0\"\>", 
      "0.0005176080000000024`"},
     {"\<\"phase_gate_Tomo4_Ren_a_24_2_tau_0_N_0\"\>", 
      "0", "\<\"None\"\>", "\<\"None\"\>", "0.0008852280000000084`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.686625147040658*^9, 3.686627754678315*^9, 3.686628284908663*^9, 
   3.6866341589048557`*^9, 3.686634203774885*^9, 3.686916062894649*^9, 
   3.6869779356628103`*^9, 3.686992450443692*^9, 3.687005649003524*^9, 
   3.687006972371029*^9, 3.6870078744571953`*^9, 3.687007987127592*^9, 
   3.6870609288703117`*^9, 3.687068039200171*^9, 3.687068147806563*^9, 
   3.6870730892059193`*^9, 3.687092074114662*^9, 3.6870921236933727`*^9, 
   3.6870941263249903`*^9, {3.6871829886913843`*^9, 3.68718301709313*^9}, 
   3.688302110876693*^9, 3.688302168589546*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MBIinit", "=", 
    RowBox[{
     RowBox[{"KP", "[", 
      RowBox[{
       SubscriptBox["\[ScriptCapitalP]", "0"], ",", 
       SubscriptBox["\[Sigma]", "0"]}], "]"}], ".", 
     RowBox[{"compiledPulse", "[", 
      RowBox[{"LT4C", ",", 
       RowBox[{"MBIy", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TomoLT4MBIX", "=", 
   RowBox[{"compiledPulse", "[", 
    RowBox[{"LT4C", ",", 
     RowBox[{"MBIy", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TomoLT4MBIY", "=", 
   RowBox[{"compiledPulse", "[", 
    RowBox[{"LT4C", ",", 
     RowBox[{"MBIy", "[", 
      RowBox[{"[", "6", "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TomoLT4MBIZ", "=", 
    RowBox[{"compiledPulse", "[", 
     RowBox[{"LT4C", ",", 
      RowBox[{"MBIy", "[", 
       RowBox[{"[", "9", "]"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TomoMBI", "=", 
   RowBox[{"{", 
    RowBox[{"TomoLT4MBIX", ",", "TomoLT4MBIY", ",", "TomoLT4MBIZ"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.686204250901569*^9, 3.6862043388278847`*^9}, {
   3.686204399421981*^9, 3.686204454400817*^9}, {3.686204635936344*^9, 
   3.6862046643738813`*^9}, {3.686204700797379*^9, 3.686204770994527*^9}, 
   3.686204846968647*^9, {3.6862048953542957`*^9, 3.686205018415694*^9}, {
   3.686205409140966*^9, 3.686205410255733*^9}, {3.686205746988648*^9, 
   3.6862057727718763`*^9}, {3.6862058117622223`*^9, 3.686205866322283*^9}, 
   3.6862073268265533`*^9, {3.686210218631989*^9, 3.686210219136548*^9}, {
   3.6862102619823*^9, 3.6862102918879967`*^9}, {3.686211789753356*^9, 
   3.686211820355667*^9}, {3.6862145552413816`*^9, 3.6862145553514643`*^9}, {
   3.686282347336713*^9, 3.686282454253824*^9}, {3.6862824956067457`*^9, 
   3.686282501762891*^9}, {3.6862825899611263`*^9, 3.6862825949995747`*^9}, {
   3.686282642143592*^9, 3.686282643438635*^9}, {3.686282701815427*^9, 
   3.6862827421531982`*^9}, {3.6862870166613817`*^9, 
   3.6862870498965693`*^9}, {3.6862872482883387`*^9, 3.6862872787972193`*^9}, 
   3.686287538861377*^9, {3.68628998535781*^9, 3.686290034243812*^9}, 
   3.686290210875903*^9, {3.6862902410725527`*^9, 3.6862902423432217`*^9}, {
   3.686563146781413*^9, 3.686563168954999*^9}, {3.6866251724103327`*^9, 
   3.686625265885684*^9}, {3.686625576171874*^9, 3.686625576431719*^9}, 
   3.6866277567558603`*^9, {3.6866282757387733`*^9, 3.686628279440502*^9}, {
   3.687013908123959*^9, 3.687013939907516*^9}}],

Cell["Init sets the carbon to something along the equator", "Text",
 CellChangeTimes->{{3.686571880724828*^9, 3.6865718839386387`*^9}, {
  3.686625287357882*^9, 3.686625291420733*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"pulseLT4", "=", "MBIinit"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"initState", "=", 
   RowBox[{"KP", "[", 
    RowBox[{
     SubscriptBox["\[ScriptCapitalP]", "0"], ",", 
     RowBox[{
      SubscriptBox["\[Sigma]", "0"], "/", "2"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"outState", "=", 
  RowBox[{"PTr", "[", 
   RowBox[{
    RowBox[{"{", "1", "}"}], ",", 
    RowBox[{"transformAndNorm", "[", 
     RowBox[{"initState", ",", "pulseLT4"}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.686282460485449*^9, 3.686282470631975*^9}, 
   3.6862875476279993`*^9, {3.686485215204461*^9, 3.68648521611836*^9}, 
   3.686625278586438*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.48913908404718287`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.44337382675242787`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.23045048490926792`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.44337382675242787`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.23045048490926792`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.5108609159528171`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.68628246508217*^9, 3.686282472627087*^9}, 
   3.686282504493012*^9, 3.686282877196406*^9, 3.686287547961443*^9, 
   3.686290051161714*^9, 3.686290105379146*^9, 3.686290152417107*^9, 
   3.686290248398324*^9, 3.686299433782044*^9, 3.6863014220107718`*^9, 
   3.686301554450942*^9, 3.686303560437243*^9, 3.68630474528617*^9, 
   3.6863050399023037`*^9, 3.686306366666206*^9, 3.686306517880472*^9, 
   3.6863069671067467`*^9, 3.686307128159088*^9, 3.686309643577671*^9, 
   3.686309814091411*^9, 3.686312894828292*^9, 3.686313961559877*^9, 
   3.68636932080977*^9, 3.686369652040264*^9, 3.686371599127583*^9, 
   3.68637241007134*^9, 3.686372466131439*^9, 3.686374544948386*^9, 
   3.686375896595016*^9, 3.686473862649774*^9, 3.6864741082515907`*^9, 
   3.686474354140605*^9, {3.686474626980974*^9, 3.686474639954053*^9}, 
   3.686474885475119*^9, 3.686476203457204*^9, {3.6864763933170547`*^9, 
   3.686476411707259*^9}, 3.686478511393585*^9, 3.686478541979762*^9, {
   3.686484016332652*^9, 3.6864840345595627`*^9}, 3.68648479239027*^9, 
   3.686484862624865*^9, 3.686485226083433*^9, 3.686485444820953*^9, {
   3.686485992267687*^9, 3.686486046970426*^9}, 3.686486086125338*^9, 
   3.686539677274074*^9, 3.686541109855142*^9, {3.686560847257739*^9, 
   3.686560875959004*^9}, 3.6865609212362213`*^9, 3.686562764067292*^9, {
   3.686563150724677*^9, 3.686563174723487*^9}, 3.686567765703278*^9, 
   3.686568326644129*^9, 3.686625279640193*^9, 3.686627764844419*^9, 
   3.6866341591842747`*^9, 3.686634203895863*^9, 3.686639222928974*^9, 
   3.6869160630612803`*^9, 3.686977935942265*^9, 3.686992450551889*^9, 
   3.6870056491146593`*^9, 3.6870069725060377`*^9, 3.687007874690843*^9, 
   3.6870079873005543`*^9, 3.6870609289898767`*^9, 3.687068039314805*^9, 
   3.687068147966606*^9, 3.687073089343934*^9, 3.687092074275611*^9, 
   3.6870921238397493`*^9, 3.687094126551836*^9, {3.6871829888158913`*^9, 
   3.687183017222981*^9}, 3.6883021110041122`*^9, 3.688302168718952*^9}]
}, Open  ]],

Cell["How does it look in different bases?", "Text",
 CellChangeTimes->{{3.68657188696192*^9, 3.6865718911696997`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bases", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "\[LessEqual]", "3"}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pulseLT4", "=", 
     RowBox[{
      RowBox[{"TomoMBI", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ".", "MBIinit"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"initState", "=", 
     RowBox[{"KP", "[", 
      RowBox[{
       SubscriptBox["\[ScriptCapitalP]", "0"], ",", 
       RowBox[{
        SubscriptBox["\[Sigma]", "0"], "/", "2"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"outState", "=", 
     RowBox[{"PTr", "[", 
      RowBox[{
       RowBox[{"{", "2", "}"}], ",", 
       RowBox[{"transformAndNorm", "[", 
        RowBox[{"initState", ",", "pulseLT4"}], "]"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
      RowBox[{"bases", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "<>", "\"\< \>\"", "<>", 
      RowBox[{"ToString", "[", 
       RowBox[{"Re", "[", 
        RowBox[{"Tr", "[", 
         RowBox[{
          SubscriptBox["\[Sigma]", "3"], ".", "outState"}], "]"}], "]"}], 
       "]"}]}], "]"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.686282460485449*^9, 3.686282470631975*^9}, {
   3.6862825183559637`*^9, 3.686282523375268*^9}, {3.6862825993943644`*^9, 
   3.686282628340599*^9}, {3.6862828891826773`*^9, 3.6862828967909517`*^9}, {
   3.686287286513729*^9, 3.686287353057444*^9}, {3.686287385376472*^9, 
   3.686287385528781*^9}, {3.686287423601384*^9, 3.6862874508597803`*^9}, {
   3.686287485927495*^9, 3.6862874861241207`*^9}, 3.6862875424098043`*^9, {
   3.686303735254549*^9, 3.686303838110813*^9}, {3.686303894589242*^9, 
   3.686303918201098*^9}, {3.6864738817849827`*^9, 3.6864738861137466`*^9}, {
   3.686485216928506*^9, 3.686485217716219*^9}, {3.6866253030068502`*^9, 
   3.6866253225264387`*^9}, {3.686625581690349*^9, 3.6866255820483093`*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"X 0.0000177902\"\>"], "Print",
 CellChangeTimes->{
  3.686625323732518*^9, 3.686625585710388*^9, 3.6866277722347107`*^9, 
   3.686634159632186*^9, 3.686634204001273*^9, 3.686916063517424*^9, 
   3.686977936077332*^9, 3.6869924506450872`*^9, 3.687005649227017*^9, 
   3.68700697261097*^9, 3.687007875029003*^9, 3.6870079874279003`*^9, 
   3.687060929076851*^9, 3.6870680394328012`*^9, 3.687068148105397*^9, 
   3.687073089466625*^9, 3.6870920743992*^9, 3.6870921239621077`*^9, 
   3.687094126655737*^9, {3.6871829889830217`*^9, 3.687183017344227*^9}, 
   3.6883021111101*^9, 3.688302168822125*^9}],

Cell[BoxData["\<\"Y 0.999226\"\>"], "Print",
 CellChangeTimes->{
  3.686625323732518*^9, 3.686625585710388*^9, 3.6866277722347107`*^9, 
   3.686634159632186*^9, 3.686634204001273*^9, 3.686916063517424*^9, 
   3.686977936077332*^9, 3.6869924506450872`*^9, 3.687005649227017*^9, 
   3.68700697261097*^9, 3.687007875029003*^9, 3.6870079874279003`*^9, 
   3.687060929076851*^9, 3.6870680394328012`*^9, 3.687068148105397*^9, 
   3.687073089466625*^9, 3.6870920743992*^9, 3.6870921239621077`*^9, 
   3.687094126655737*^9, {3.6871829889830217`*^9, 3.687183017344227*^9}, 
   3.6883021111101*^9, 3.688302168834085*^9}],

Cell[BoxData["\<\"Z -0.120371\"\>"], "Print",
 CellChangeTimes->{
  3.686625323732518*^9, 3.686625585710388*^9, 3.6866277722347107`*^9, 
   3.686634159632186*^9, 3.686634204001273*^9, 3.686916063517424*^9, 
   3.686977936077332*^9, 3.6869924506450872`*^9, 3.687005649227017*^9, 
   3.68700697261097*^9, 3.687007875029003*^9, 3.6870079874279003`*^9, 
   3.687060929076851*^9, 3.6870680394328012`*^9, 3.687068148105397*^9, 
   3.687073089466625*^9, 3.6870920743992*^9, 3.6870921239621077`*^9, 
   3.687094126655737*^9, {3.6871829889830217`*^9, 3.687183017344227*^9}, 
   3.6883021111101*^9, 3.688302168848702*^9}]
}, Open  ]]
}, Open  ]],

Cell["That also seems to work...", "Text",
 CellChangeTimes->{{3.6866253332363777`*^9, 3.686625336196816*^9}, {
  3.686627780506414*^9, 3.686627784008469*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Elec to carbon swap", "Subchapter",
 CellChangeTimes->{{3.686288250029621*^9, 3.686288254410158*^9}, {
  3.686571691546171*^9, 3.6865716957108088`*^9}}],

Cell[CellGroupData[{

Cell["LT4", "Subsection",
 CellChangeTimes->{{3.6864845822869453`*^9, 3.686484583557056*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LT4SwapX", "=", 
   RowBox[{"getPulses", "[", 
    RowBox[{"basedirLT4", ",", "\"\<AWG_seqs_elc_carb_swap_X\>\""}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.68621226078228*^9, 3.6862122614118223`*^9}, {
   3.6862130000838127`*^9, 3.6862130114014673`*^9}, 3.6862135326294947`*^9, {
   3.68621454877389*^9, 3.68621454879186*^9}, {3.6862822817670927`*^9, 
   3.686282311673664*^9}, {3.686289852863875*^9, 3.686289895871109*^9}, 
   3.686483378626306*^9, 3.687092054903843*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LT4SwapY", "=", 
   RowBox[{"getPulses", "[", 
    RowBox[{"basedirLT4", ",", "\"\<AWG_seqs_elc_carb_swap_Y\>\""}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.68621226078228*^9, 3.6862122614118223`*^9}, {
   3.6862130000838127`*^9, 3.6862130114014673`*^9}, 3.6862135326294947`*^9, {
   3.68621454877389*^9, 3.68621454879186*^9}, {3.6862822817670927`*^9, 
   3.686282311673664*^9}, {3.686286935892568*^9, 3.6862869489854507`*^9}, {
   3.686289871206646*^9, 3.686289908030209*^9}, 3.6864833786402817`*^9, 
   3.6870920549141912`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LT4SwapZ", "=", 
   RowBox[{"getPulses", "[", 
    RowBox[{"basedirLT4", ",", "\"\<AWG_seqs_elc_carb_swap_Z\>\""}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.686287093080871*^9, 3.686287101950189*^9}, {
   3.686289874096245*^9, 3.686289910286207*^9}, 3.6864833786553497`*^9, 
   3.687092054928892*^9}],

Cell["\<\
Check that the pulses match in the different files (apart from where \
deliberately different):\
\>", "Text",
 CellChangeTimes->{{3.686481931836651*^9, 3.686481935170651*^9}, {
  3.686571705319121*^9, 3.6865717253259277`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"z", "=", "1"}], ",", 
   RowBox[{"z", "<=", 
    RowBox[{
     RowBox[{"Dimensions", "[", "LT4SwapX", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ",", 
   RowBox[{"z", "++"}], ",", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"LT4SwapX", "[", 
       RowBox[{"[", 
        RowBox[{"z", ",", "2"}], "]"}], "]"}], "!=", 
      RowBox[{"LT4SwapZ", "[", 
       RowBox[{"[", 
        RowBox[{"z", ",", "2"}], "]"}], "]"}]}], ",", 
     RowBox[{"Print", "[", "z", "]"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"z", "=", "1"}], ",", 
    RowBox[{"z", "<=", 
     RowBox[{
      RowBox[{"Dimensions", "[", "LT4SwapX", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ",", 
    RowBox[{"z", "++"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"LT4SwapX", "[", 
        RowBox[{"[", 
         RowBox[{"z", ",", "2"}], "]"}], "]"}], "!=", 
       RowBox[{"LT4SwapY", "[", 
        RowBox[{"[", 
         RowBox[{"z", ",", "2"}], "]"}], "]"}]}], ",", 
      RowBox[{"Print", "[", "z", "]"}]}], "]"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"z", "=", "1"}], ",", 
   RowBox[{"z", "<=", 
    RowBox[{
     RowBox[{"Dimensions", "[", "LT4SwapX", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ",", 
   RowBox[{"z", "++"}], ",", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"LT4SwapX", "[", 
       RowBox[{"[", 
        RowBox[{"z", ",", "1", ",", "5"}], "]"}], "]"}], "!=", 
      RowBox[{"LT4SwapZ", "[", 
       RowBox[{"[", 
        RowBox[{"z", ",", "1", ",", "5"}], "]"}], "]"}]}], ",", 
     RowBox[{"Print", "[", "z", "]"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"z", "=", "1"}], ",", 
   RowBox[{"z", "<=", 
    RowBox[{
     RowBox[{"Dimensions", "[", "LT4SwapX", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ",", 
   RowBox[{"z", "++"}], ",", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"LT4SwapX", "[", 
       RowBox[{"[", 
        RowBox[{"z", ",", "1", ",", "5"}], "]"}], "]"}], "!=", 
      RowBox[{"LT4SwapY", "[", 
       RowBox[{"[", 
        RowBox[{"z", ",", "1", ",", "5"}], "]"}], "]"}]}], ",", 
     RowBox[{"Print", "[", "z", "]"}]}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6864817674429092`*^9, 3.686481831910016*^9}, {
  3.686485065102128*^9, 3.686485078113824*^9}, {3.686571737377654*^9, 
  3.686571748702404*^9}}],

Cell[CellGroupData[{

Cell[BoxData["3"], "Print",
 CellChangeTimes->{
  3.686484048917919*^9, 3.6864850791679277`*^9, 3.686485225709589*^9, 
   3.68648544435109*^9, {3.686485991888577*^9, 3.686486046583147*^9}, 
   3.686486085591667*^9, 3.686539676987302*^9, 3.6865411090972157`*^9, {
   3.6865608469482718`*^9, 3.686560875618485*^9}, 3.68656092090724*^9, 
   3.686567764871338*^9, 3.68656832612173*^9, 3.6865717495152607`*^9, 
   3.6866256946047983`*^9, 3.686627865725525*^9, 3.686634161084429*^9, 
   3.686639286241544*^9, 3.686916064416007*^9, 3.68697793668827*^9, 
   3.686992451366798*^9, 3.6870056498910522`*^9, 3.68700697377813*^9, 
   3.687007875648971*^9, 3.687007988028228*^9, 3.687060929803808*^9, 
   3.68706804008997*^9, 3.6870681488761063`*^9, 3.687073090402382*^9, 
   3.6870920756442213`*^9, 3.687092125111528*^9, 3.68709412805368*^9, {
   3.687182990188397*^9, 3.6871830186951227`*^9}, 3.688302112327716*^9, 
   3.688302170494035*^9}],

Cell[BoxData["7"], "Print",
 CellChangeTimes->{
  3.686484048917919*^9, 3.6864850791679277`*^9, 3.686485225709589*^9, 
   3.68648544435109*^9, {3.686485991888577*^9, 3.686486046583147*^9}, 
   3.686486085591667*^9, 3.686539676987302*^9, 3.6865411090972157`*^9, {
   3.6865608469482718`*^9, 3.686560875618485*^9}, 3.68656092090724*^9, 
   3.686567764871338*^9, 3.68656832612173*^9, 3.6865717495152607`*^9, 
   3.6866256946047983`*^9, 3.686627865725525*^9, 3.686634161084429*^9, 
   3.686639286241544*^9, 3.686916064416007*^9, 3.68697793668827*^9, 
   3.686992451366798*^9, 3.6870056498910522`*^9, 3.68700697377813*^9, 
   3.687007875648971*^9, 3.687007988028228*^9, 3.687060929803808*^9, 
   3.68706804008997*^9, 3.6870681488761063`*^9, 3.687073090402382*^9, 
   3.6870920756442213`*^9, 3.687092125111528*^9, 3.68709412805368*^9, {
   3.687182990188397*^9, 3.6871830186951227`*^9}, 3.688302112327716*^9, 
   3.688302170506422*^9}],

Cell[BoxData["11"], "Print",
 CellChangeTimes->{
  3.686484048917919*^9, 3.6864850791679277`*^9, 3.686485225709589*^9, 
   3.68648544435109*^9, {3.686485991888577*^9, 3.686486046583147*^9}, 
   3.686486085591667*^9, 3.686539676987302*^9, 3.6865411090972157`*^9, {
   3.6865608469482718`*^9, 3.686560875618485*^9}, 3.68656092090724*^9, 
   3.686567764871338*^9, 3.68656832612173*^9, 3.6865717495152607`*^9, 
   3.6866256946047983`*^9, 3.686627865725525*^9, 3.686634161084429*^9, 
   3.686639286241544*^9, 3.686916064416007*^9, 3.68697793668827*^9, 
   3.686992451366798*^9, 3.6870056498910522`*^9, 3.68700697377813*^9, 
   3.687007875648971*^9, 3.687007988028228*^9, 3.687060929803808*^9, 
   3.68706804008997*^9, 3.6870681488761063`*^9, 3.687073090402382*^9, 
   3.6870920756442213`*^9, 3.687092125111528*^9, 3.68709412805368*^9, {
   3.687182990188397*^9, 3.6871830186951227`*^9}, 3.688302112327716*^9, 
   3.688302170517223*^9}],

Cell[BoxData["3"], "Print",
 CellChangeTimes->{
  3.686484048917919*^9, 3.6864850791679277`*^9, 3.686485225709589*^9, 
   3.68648544435109*^9, {3.686485991888577*^9, 3.686486046583147*^9}, 
   3.686486085591667*^9, 3.686539676987302*^9, 3.6865411090972157`*^9, {
   3.6865608469482718`*^9, 3.686560875618485*^9}, 3.68656092090724*^9, 
   3.686567764871338*^9, 3.68656832612173*^9, 3.6865717495152607`*^9, 
   3.6866256946047983`*^9, 3.686627865725525*^9, 3.686634161084429*^9, 
   3.686639286241544*^9, 3.686916064416007*^9, 3.68697793668827*^9, 
   3.686992451366798*^9, 3.6870056498910522`*^9, 3.68700697377813*^9, 
   3.687007875648971*^9, 3.687007988028228*^9, 3.687060929803808*^9, 
   3.68706804008997*^9, 3.6870681488761063`*^9, 3.687073090402382*^9, 
   3.6870920756442213`*^9, 3.687092125111528*^9, 3.68709412805368*^9, {
   3.687182990188397*^9, 3.6871830186951227`*^9}, 3.688302112327716*^9, 
   3.688302170527574*^9}],

Cell[BoxData["7"], "Print",
 CellChangeTimes->{
  3.686484048917919*^9, 3.6864850791679277`*^9, 3.686485225709589*^9, 
   3.68648544435109*^9, {3.686485991888577*^9, 3.686486046583147*^9}, 
   3.686486085591667*^9, 3.686539676987302*^9, 3.6865411090972157`*^9, {
   3.6865608469482718`*^9, 3.686560875618485*^9}, 3.68656092090724*^9, 
   3.686567764871338*^9, 3.68656832612173*^9, 3.6865717495152607`*^9, 
   3.6866256946047983`*^9, 3.686627865725525*^9, 3.686634161084429*^9, 
   3.686639286241544*^9, 3.686916064416007*^9, 3.68697793668827*^9, 
   3.686992451366798*^9, 3.6870056498910522`*^9, 3.68700697377813*^9, 
   3.687007875648971*^9, 3.687007988028228*^9, 3.687060929803808*^9, 
   3.68706804008997*^9, 3.6870681488761063`*^9, 3.687073090402382*^9, 
   3.6870920756442213`*^9, 3.687092125111528*^9, 3.68709412805368*^9, {
   3.687182990188397*^9, 3.6871830186951227`*^9}, 3.688302112327716*^9, 
   3.688302170539693*^9}],

Cell[BoxData["11"], "Print",
 CellChangeTimes->{
  3.686484048917919*^9, 3.6864850791679277`*^9, 3.686485225709589*^9, 
   3.68648544435109*^9, {3.686485991888577*^9, 3.686486046583147*^9}, 
   3.686486085591667*^9, 3.686539676987302*^9, 3.6865411090972157`*^9, {
   3.6865608469482718`*^9, 3.686560875618485*^9}, 3.68656092090724*^9, 
   3.686567764871338*^9, 3.68656832612173*^9, 3.6865717495152607`*^9, 
   3.6866256946047983`*^9, 3.686627865725525*^9, 3.686634161084429*^9, 
   3.686639286241544*^9, 3.686916064416007*^9, 3.68697793668827*^9, 
   3.686992451366798*^9, 3.6870056498910522`*^9, 3.68700697377813*^9, 
   3.687007875648971*^9, 3.687007988028228*^9, 3.687060929803808*^9, 
   3.68706804008997*^9, 3.6870681488761063`*^9, 3.687073090402382*^9, 
   3.6870920756442213`*^9, 3.687092125111528*^9, 3.68709412805368*^9, {
   3.687182990188397*^9, 3.6871830186951227`*^9}, 3.688302112327716*^9, 
   3.688302170551903*^9}],

Cell[BoxData["3"], "Print",
 CellChangeTimes->{
  3.686484048917919*^9, 3.6864850791679277`*^9, 3.686485225709589*^9, 
   3.68648544435109*^9, {3.686485991888577*^9, 3.686486046583147*^9}, 
   3.686486085591667*^9, 3.686539676987302*^9, 3.6865411090972157`*^9, {
   3.6865608469482718`*^9, 3.686560875618485*^9}, 3.68656092090724*^9, 
   3.686567764871338*^9, 3.68656832612173*^9, 3.6865717495152607`*^9, 
   3.6866256946047983`*^9, 3.686627865725525*^9, 3.686634161084429*^9, 
   3.686639286241544*^9, 3.686916064416007*^9, 3.68697793668827*^9, 
   3.686992451366798*^9, 3.6870056498910522`*^9, 3.68700697377813*^9, 
   3.687007875648971*^9, 3.687007988028228*^9, 3.687060929803808*^9, 
   3.68706804008997*^9, 3.6870681488761063`*^9, 3.687073090402382*^9, 
   3.6870920756442213`*^9, 3.687092125111528*^9, 3.68709412805368*^9, {
   3.687182990188397*^9, 3.6871830186951227`*^9}, 3.688302112327716*^9, 
   3.688302170565133*^9}],

Cell[BoxData["7"], "Print",
 CellChangeTimes->{
  3.686484048917919*^9, 3.6864850791679277`*^9, 3.686485225709589*^9, 
   3.68648544435109*^9, {3.686485991888577*^9, 3.686486046583147*^9}, 
   3.686486085591667*^9, 3.686539676987302*^9, 3.6865411090972157`*^9, {
   3.6865608469482718`*^9, 3.686560875618485*^9}, 3.68656092090724*^9, 
   3.686567764871338*^9, 3.68656832612173*^9, 3.6865717495152607`*^9, 
   3.6866256946047983`*^9, 3.686627865725525*^9, 3.686634161084429*^9, 
   3.686639286241544*^9, 3.686916064416007*^9, 3.68697793668827*^9, 
   3.686992451366798*^9, 3.6870056498910522`*^9, 3.68700697377813*^9, 
   3.687007875648971*^9, 3.687007988028228*^9, 3.687060929803808*^9, 
   3.68706804008997*^9, 3.6870681488761063`*^9, 3.687073090402382*^9, 
   3.6870920756442213`*^9, 3.687092125111528*^9, 3.68709412805368*^9, {
   3.687182990188397*^9, 3.6871830186951227`*^9}, 3.688302112327716*^9, 
   3.688302170578733*^9}],

Cell[BoxData["11"], "Print",
 CellChangeTimes->{
  3.686484048917919*^9, 3.6864850791679277`*^9, 3.686485225709589*^9, 
   3.68648544435109*^9, {3.686485991888577*^9, 3.686486046583147*^9}, 
   3.686486085591667*^9, 3.686539676987302*^9, 3.6865411090972157`*^9, {
   3.6865608469482718`*^9, 3.686560875618485*^9}, 3.68656092090724*^9, 
   3.686567764871338*^9, 3.68656832612173*^9, 3.6865717495152607`*^9, 
   3.6866256946047983`*^9, 3.686627865725525*^9, 3.686634161084429*^9, 
   3.686639286241544*^9, 3.686916064416007*^9, 3.68697793668827*^9, 
   3.686992451366798*^9, 3.6870056498910522`*^9, 3.68700697377813*^9, 
   3.687007875648971*^9, 3.687007988028228*^9, 3.687060929803808*^9, 
   3.68706804008997*^9, 3.6870681488761063`*^9, 3.687073090402382*^9, 
   3.6870920756442213`*^9, 3.687092125111528*^9, 3.68709412805368*^9, {
   3.687182990188397*^9, 3.6871830186951227`*^9}, 3.688302112327716*^9, 
   3.6883021705904713`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"LT4SwapX", "[", 
   RowBox[{"[", 
    RowBox[{"3", ",", "2"}], "]"}], "]"}], "==", 
  RowBox[{"LT4SwapX", "[", 
   RowBox[{"[", 
    RowBox[{"7", ",", "2"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LT4SwapX", "[", 
   RowBox[{"[", 
    RowBox[{"3", ",", "2"}], "]"}], "]"}], "==", 
  RowBox[{"LT4SwapX", "[", 
   RowBox[{"[", 
    RowBox[{"11", ",", "2"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.6864818870709753`*^9, 3.686481927333952*^9}, {
  3.686485110864305*^9, 3.686485132160327*^9}}],

Cell[BoxData[
 TagBox["True",
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.686481904729212*^9, 3.686481927641671*^9}, {
   3.686484019187028*^9, 3.686484049105763*^9}, 3.6864851329697638`*^9, 
   3.686485225909548*^9, 3.686485444540371*^9, {3.686485992113352*^9, 
   3.686486046817748*^9}, 3.686486085786718*^9, 3.686539677144046*^9, 
   3.686541109293195*^9, {3.6865608471218348`*^9, 3.686560875814742*^9}, 
   3.6865609211006327`*^9, 3.686562763750029*^9, 3.6865677654661083`*^9, 
   3.68656832630436*^9, 3.686625694797352*^9, 3.686627865975439*^9, 
   3.686634161368918*^9, 3.68663928650347*^9, 3.686916064757948*^9, 
   3.686977936968337*^9, 3.68699245156229*^9, 3.687005650155387*^9, 
   3.6870069741997766`*^9, 3.687007875921117*^9, 3.687007988263577*^9, 
   3.687060930006691*^9, 3.687068040351177*^9, 3.687068149183792*^9, 
   3.687073090678952*^9, 3.687092075934484*^9, 3.68709212542651*^9, 
   3.687094128304241*^9, {3.687182990407593*^9, 3.687183019043746*^9}, 
   3.688302112528759*^9, 3.6883021707092447`*^9}],

Cell[BoxData[
 TagBox["True",
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.686481904729212*^9, 3.686481927641671*^9}, {
   3.686484019187028*^9, 3.686484049105763*^9}, 3.6864851329697638`*^9, 
   3.686485225909548*^9, 3.686485444540371*^9, {3.686485992113352*^9, 
   3.686486046817748*^9}, 3.686486085786718*^9, 3.686539677144046*^9, 
   3.686541109293195*^9, {3.6865608471218348`*^9, 3.686560875814742*^9}, 
   3.6865609211006327`*^9, 3.686562763750029*^9, 3.6865677654661083`*^9, 
   3.68656832630436*^9, 3.686625694797352*^9, 3.686627865975439*^9, 
   3.686634161368918*^9, 3.68663928650347*^9, 3.686916064757948*^9, 
   3.686977936968337*^9, 3.68699245156229*^9, 3.687005650155387*^9, 
   3.6870069741997766`*^9, 3.687007875921117*^9, 3.687007988263577*^9, 
   3.687060930006691*^9, 3.687068040351177*^9, 3.687068149183792*^9, 
   3.687073090678952*^9, 3.687092075934484*^9, 3.68709212542651*^9, 
   3.687094128304241*^9, {3.687182990407593*^9, 3.687183019043746*^9}, 
   3.688302112528759*^9, 3.6883021707216253`*^9}]
}, Open  ]],

Cell["Ok, setup the different bits of the sequence!", "Text",
 CellChangeTimes->{{3.686571857260857*^9, 3.6865718651152*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"LT4SwapX", "[", 
  RowBox[{"[", 
   RowBox[{";;", ",", "1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.686571870085585*^9, 3.686571872090109*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"MBI_0\"\>", 
      "1", "\<\"MBI_0\"\>", "\<\"init_C4_y_pt0_tau_0_N_0\"\>", "0.000029756`"},
     {"\<\"init_C4_y_pt0_tau_0_N_0\"\>", 
      "1", "\<\"MBI_0\"\>", "\<\"init_E_y_pt0_tau_0_N_0\"\>", 
      "0.0009672480000000083`"},
     {"\<\"init_E_y_pt0_tau_0_N_0\"\>", 
      "0", "\<\"MBI_0\"\>", "\<\"Tomo_y_pi2_init0_tau_0_N_0\"\>", 
      "0.0009708000000000084`"},
     {"\<\"Tomo_y_pi2_init0_tau_0_N_0\"\>", 
      "0", "\<\"MBI_1\"\>", "\<\"init_C4_y_pt1_tau_0_N_0\"\>", 
      "0.00047804400000000234`"},
     {"\<\"MBI_1\"\>", 
      "1", "\<\"MBI_1\"\>", "\<\"init_C4_y_pt1_tau_0_N_0\"\>", 
      "0.00047804400000000234`"},
     {"\<\"init_C4_y_pt1_tau_0_N_0\"\>", 
      "1", "\<\"MBI_1\"\>", "\<\"init_E_y_pt1_tau_0_N_0\"\>", 
      "0.0009672480000000083`"},
     {"\<\"init_E_y_pt1_tau_0_N_0\"\>", 
      "0", "\<\"MBI_1\"\>", "\<\"Tomo_y_pi2_init1_tau_0_N_0\"\>", 
      "0.0009708000000000084`"},
     {"\<\"Tomo_y_pi2_init1_tau_0_N_0\"\>", 
      "0", "\<\"MBI_2\"\>", "\<\"init_C4_y_pt2_tau_0_N_0\"\>", 
      "0.00047748000000000235`"},
     {"\<\"MBI_2\"\>", 
      "1", "\<\"MBI_2\"\>", "\<\"init_C4_y_pt2_tau_0_N_0\"\>", 
      "0.00047748000000000235`"},
     {"\<\"init_C4_y_pt2_tau_0_N_0\"\>", 
      "1", "\<\"MBI_2\"\>", "\<\"init_E_y_pt2_tau_0_N_0\"\>", 
      "0.0009672480000000083`"},
     {"\<\"init_E_y_pt2_tau_0_N_0\"\>", 
      "0", "\<\"MBI_2\"\>", "\<\"phase_gate_Tomo4_Ren_a_211_2_tau_0_N_0\"\>", 
      "0.0009708000000000084`"},
     {"\<\"phase_gate_Tomo4_Ren_a_211_2_tau_0_N_0\"\>", 
      "0", "\<\"None\"\>", "\<\"None\"\>", "0.0008852280000000084`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.686571872398116*^9, 3.686625694897608*^9, 3.6866278661175117`*^9, 
   3.6866341615191593`*^9, 3.6866392866351357`*^9, 3.6869160649010763`*^9, 
   3.686977937079661*^9, 3.686992451663353*^9, 3.6870056503110743`*^9, 
   3.687006974406279*^9, 3.687007876052868*^9, 3.68700798840254*^9, 
   3.687060930089532*^9, 3.687068040482284*^9, 3.6870681493687963`*^9, 
   3.687073090823262*^9, 3.687092076217814*^9, 3.68709212558235*^9, 
   3.68709412845468*^9, {3.687182990523603*^9, 3.687183019147645*^9}, 
   3.688302112629986*^9, 3.688302170885878*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"InitLT4Swap", "=", 
    RowBox[{
     RowBox[{"KP", "[", 
      RowBox[{
       SubscriptBox["\[ScriptCapitalP]", "0"], ",", 
       SubscriptBox["\[Sigma]", "0"]}], "]"}], ".", 
     RowBox[{"compiledPulse", "[", 
      RowBox[{"LT4C", ",", 
       RowBox[{"LT4SwapX", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InitEAndSwapLT4SwapX", "=", 
   RowBox[{
    RowBox[{"KP", "[", 
     RowBox[{
      SubscriptBox["\[ScriptCapitalP]", "0"], ",", 
      SubscriptBox["\[Sigma]", "0"]}], "]"}], ".", 
    RowBox[{"compiledPulse", "[", 
     RowBox[{"LT4C", ",", 
      RowBox[{"LT4SwapX", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InitEAndSwapLT4SwapY", "=", 
   RowBox[{
    RowBox[{"KP", "[", 
     RowBox[{
      SubscriptBox["\[ScriptCapitalP]", "0"], ",", 
      SubscriptBox["\[Sigma]", "0"]}], "]"}], ".", 
    RowBox[{"compiledPulse", "[", 
     RowBox[{"LT4C", ",", 
      RowBox[{"LT4SwapY", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InitEAndSwapLT4SwapZ", "=", 
    RowBox[{
     RowBox[{"KP", "[", 
      RowBox[{
       SubscriptBox["\[ScriptCapitalP]", "0"], ",", 
       SubscriptBox["\[Sigma]", "0"]}], "]"}], ".", 
     RowBox[{"compiledPulse", "[", 
      RowBox[{"LT4C", ",", 
       RowBox[{"LT4SwapZ", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InitSwap", "=", 
    RowBox[{"{", 
     RowBox[{
     "InitEAndSwapLT4SwapX", ",", "InitEAndSwapLT4SwapY", ",", 
      "InitEAndSwapLT4SwapZ"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TomoLT4XSwapX", "=", 
   RowBox[{"compiledPulse", "[", 
    RowBox[{"LT4C", ",", 
     RowBox[{"LT4SwapX", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TomoLT4XSwapY", "=", 
   RowBox[{"compiledPulse", "[", 
    RowBox[{"LT4C", ",", 
     RowBox[{"LT4SwapX", "[", 
      RowBox[{"[", "8", "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TomoLT4XSwapZ", "=", 
    RowBox[{"compiledPulse", "[", 
     RowBox[{"LT4C", ",", 
      RowBox[{"LT4SwapX", "[", 
       RowBox[{"[", "12", "]"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TomoSwap", "=", 
   RowBox[{"{", 
    RowBox[{"TomoLT4XSwapX", ",", "TomoLT4XSwapY", ",", "TomoLT4XSwapZ"}], 
    "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.686204250901569*^9, 3.6862043388278847`*^9}, {
   3.686204399421981*^9, 3.686204454400817*^9}, {3.686204635936344*^9, 
   3.6862046643738813`*^9}, {3.686204700797379*^9, 3.686204770994527*^9}, 
   3.686204846968647*^9, {3.6862048953542957`*^9, 3.686205018415694*^9}, {
   3.686205409140966*^9, 3.686205410255733*^9}, {3.686205746988648*^9, 
   3.6862057727718763`*^9}, {3.6862058117622223`*^9, 3.686205866322283*^9}, 
   3.6862073268265533`*^9, {3.686210218631989*^9, 3.686210219136548*^9}, {
   3.6862102619823*^9, 3.6862102918879967`*^9}, {3.686211789753356*^9, 
   3.686211820355667*^9}, {3.6862145552413816`*^9, 3.6862145553514643`*^9}, {
   3.686282347336713*^9, 3.686282454253824*^9}, {3.6862824956067457`*^9, 
   3.686282501762891*^9}, {3.6862825899611263`*^9, 3.6862825949995747`*^9}, {
   3.686282642143592*^9, 3.686282643438635*^9}, {3.686282701815427*^9, 
   3.6862827421531982`*^9}, {3.6862870166613817`*^9, 
   3.6862870498965693`*^9}, {3.6862872482883387`*^9, 3.6862872787972193`*^9}, 
   3.686287538861377*^9, {3.68628998535781*^9, 3.686290034243812*^9}, 
   3.686290210875903*^9, {3.6862902410725527`*^9, 3.6862902423432217`*^9}, {
   3.686563146781413*^9, 3.686563168954999*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"addPhaseEvInfo", "[", 
   RowBox[{"LT4C", ",", 
    RowBox[{"LT4SwapX", "[", 
     RowBox[{"[", "3", "]"}], "]"}], ",", 
    RowBox[{"Ket", "[", "0", "]"}], ",", "\[Omega]sup4", ",", 
    "156.66376790160004`"}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.686628484628581*^9, 3.6866285042480173`*^9}, 
   3.686628551933421*^9, {3.686629047305204*^9, 3.686629051280672*^9}, {
   3.686629140380858*^9, 3.68662914054112*^9}, {3.6866292193263474`*^9, 
   3.686629219460487*^9}, {3.686629966782905*^9, 3.686629971963627*^9}, {
   3.686630456505377*^9, 3.686630462495822*^9}, {3.686630679952153*^9, 
   3.68663068753316*^9}, 3.68663078036432*^9}],

Cell["Init sets the carbon to Z", "Text",
 CellChangeTimes->{{3.686571880724828*^9, 3.6865718839386387`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"pulseLT4", "=", "InitLT4Swap"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"initState", "=", 
   RowBox[{"KP", "[", 
    RowBox[{
     SubscriptBox["\[ScriptCapitalP]", "0"], ",", 
     RowBox[{
      SubscriptBox["\[Sigma]", "0"], "/", "2"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"outState", "=", 
  RowBox[{"PTr", "[", 
   RowBox[{
    RowBox[{"{", "1", "}"}], ",", 
    RowBox[{"transformAndNorm", "[", 
     RowBox[{"initState", ",", "pulseLT4"}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.686282460485449*^9, 3.686282470631975*^9}, 
   3.6862875476279993`*^9, {3.686485215204461*^9, 3.68648521611836*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.9985315455403462`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.03518205445354916`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.005852938144577463`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.03518205445354916`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.005852938144577463`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.001468454459654045`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.68628246508217*^9, 3.686282472627087*^9}, 
   3.686282504493012*^9, 3.686282877196406*^9, 3.686287547961443*^9, 
   3.686290051161714*^9, 3.686290105379146*^9, 3.686290152417107*^9, 
   3.686290248398324*^9, 3.686299433782044*^9, 3.6863014220107718`*^9, 
   3.686301554450942*^9, 3.686303560437243*^9, 3.68630474528617*^9, 
   3.6863050399023037`*^9, 3.686306366666206*^9, 3.686306517880472*^9, 
   3.6863069671067467`*^9, 3.686307128159088*^9, 3.686309643577671*^9, 
   3.686309814091411*^9, 3.686312894828292*^9, 3.686313961559877*^9, 
   3.68636932080977*^9, 3.686369652040264*^9, 3.686371599127583*^9, 
   3.68637241007134*^9, 3.686372466131439*^9, 3.686374544948386*^9, 
   3.686375896595016*^9, 3.686473862649774*^9, 3.6864741082515907`*^9, 
   3.686474354140605*^9, {3.686474626980974*^9, 3.686474639954053*^9}, 
   3.686474885475119*^9, 3.686476203457204*^9, {3.6864763933170547`*^9, 
   3.686476411707259*^9}, 3.686478511393585*^9, 3.686478541979762*^9, {
   3.686484016332652*^9, 3.6864840345595627`*^9}, 3.68648479239027*^9, 
   3.686484862624865*^9, 3.686485226083433*^9, 3.686485444820953*^9, {
   3.686485992267687*^9, 3.686486046970426*^9}, 3.686486086125338*^9, 
   3.686539677274074*^9, 3.686541109855142*^9, {3.686560847257739*^9, 
   3.686560875959004*^9}, 3.6865609212362213`*^9, 3.686562764067292*^9, {
   3.686563150724677*^9, 3.686563174723487*^9}, 3.686567765703278*^9, 
   3.686568326644129*^9, 3.6866256950835648`*^9, 3.686627866242045*^9, 
   3.6866341616926117`*^9, 3.686639287460432*^9, 3.686916065070023*^9, 
   3.686977937217866*^9, 3.6869924519587917`*^9, 3.6870056504912*^9, 
   3.6870069752976923`*^9, 3.687007876577458*^9, 3.687007988548444*^9, 
   3.687060930236619*^9, 3.687068040628085*^9, 3.687068149537335*^9, 
   3.687073091084112*^9, 3.68709207657316*^9, 3.6870921257388372`*^9, 
   3.687094128723772*^9, {3.687182990674638*^9, 3.687183019613546*^9}, 
   3.688302112765115*^9, 3.688302172245384*^9}]
}, Open  ]],

Cell["Swap sets the carbon to Z", "Text",
 CellChangeTimes->{{3.686571880724828*^9, 3.6865718839386387`*^9}, {
  3.68662564004093*^9, 3.686625640622587*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bases", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"initPulseSeqs", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"LT4SwapX", "[", 
       RowBox[{"[", "3", "]"}], "]"}], ",", 
      RowBox[{"LT4SwapY", "[", 
       RowBox[{"[", "3", "]"}], "]"}], ",", 
      RowBox[{"LT4SwapZ", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"j", "=", "1"}], ",", 
   RowBox[{"j", "\[LessEqual]", "3"}], ",", 
   RowBox[{"j", "++"}], ",", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Input: \>\"", "<>", 
      RowBox[{"bases", "[", 
       RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"pulseLT4", "=", 
     RowBox[{
      RowBox[{"InitSwap", "[", 
       RowBox[{"[", "j", "]"}], "]"}], ".", "InitLT4Swap"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"initState", "=", 
     RowBox[{"KP", "[", 
      RowBox[{
       SubscriptBox["\[ScriptCapitalP]", "0"], ",", 
       RowBox[{
        SubscriptBox["\[Sigma]", "0"], "/", "2"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"outState", "=", 
     RowBox[{"PTr", "[", 
      RowBox[{
       RowBox[{"{", "1", "}"}], ",", 
       RowBox[{"transformAndNorm", "[", 
        RowBox[{"initState", ",", "pulseLT4"}], "]"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"outState", "//", "TableForm"}], "]"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", "\"\<C Frame\>\"", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"MBIrot", "=", 
     RowBox[{"compiledRotMat", "[", 
      RowBox[{"LT4C", ",", 
       RowBox[{"initPulseSeqs", "[", 
        RowBox[{"[", "j", "]"}], "]"}], ",", 
       SubscriptBox["\[ScriptCapitalP]", "0"]}], "]"}]}], ";", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{".", 
       RowBox[{"compiledRotMat", "[", 
        RowBox[{"LT4C", ",", 
         RowBox[{"LT4SwapX", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         SubscriptBox["\[ScriptCapitalP]", "0"], ",", "refX"}], "]"}]}], 
      ";"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"180", "/", "\[Pi]"}], ")"}], 
      RowBox[{"Arg", "[", 
       RowBox[{
        RowBox[{"MBIrot", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}], "*", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", 
          RowBox[{"Arg", "[", 
           RowBox[{"MBIrot", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}]}], "]"}]}],
      "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"outStateNFrame", "=", 
     RowBox[{"Chop", "[", 
      RowBox[{
       RowBox[{"MBIrot", "\[ConjugateTranspose]"}], ".", "outState", ".", 
       "MBIrot"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"outStateNFrame", "//", "TableForm"}], "]"}], ";"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.686282460485449*^9, 3.686282470631975*^9}, 
   3.6862875476279993`*^9, {3.686485215204461*^9, 3.68648521611836*^9}, {
   3.686625651488496*^9, 3.686625676253912*^9}, {3.686625707505121*^9, 
   3.6866257431676073`*^9}, {3.6866393061622963`*^9, 3.686639499897078*^9}, {
   3.686639561873967*^9, 3.68663959130402*^9}, {3.686639700188562*^9, 
   3.686639710929035*^9}, {3.686639759491478*^9, 3.686639759721106*^9}, {
   3.6866399637674713`*^9, 3.6866400861611547`*^9}, {3.686992476620566*^9, 
   3.6869924769160347`*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"Input: X\"\>"], "Print",
 CellChangeTimes->{{3.686640069080427*^9, 3.686640086668515*^9}, 
   3.6869160653736*^9, 3.686977937425516*^9, {3.686992452178711*^9, 
   3.686992478544614*^9}, 3.687005650640243*^9, 3.687006975495779*^9, 
   3.6870078768905993`*^9, 3.687007988662787*^9, 3.687060930329883*^9, 
   3.687068040730833*^9, 3.687068149678451*^9, 3.6870730911672688`*^9, 
   3.6870920766847897`*^9, 3.687092125867116*^9, 3.6870941288385763`*^9, {
   3.687182990790983*^9, 3.687183019982044*^9}, 3.688302112861424*^9, 
   3.688302172622691*^9}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"0.9992573029831227`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
     RowBox[{"0.021374006195954264`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.01688745875148669`", " ", "\[ImaginaryI]"}]}]},
    {
     RowBox[{"0.021374006195954264`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.01688745875148669`", " ", "\[ImaginaryI]"}]}], 
     RowBox[{"0.0007426970168772362`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{{3.686640069080427*^9, 3.686640086668515*^9}, 
   3.6869160653736*^9, 3.686977937425516*^9, {3.686992452178711*^9, 
   3.686992478544614*^9}, 3.687005650640243*^9, 3.687006975495779*^9, 
   3.6870078768905993`*^9, 3.687007988662787*^9, 3.687060930329883*^9, 
   3.687068040730833*^9, 3.687068149678451*^9, 3.6870730911672688`*^9, 
   3.6870920766847897`*^9, 3.687092125867116*^9, 3.6870941288385763`*^9, {
   3.687182990790983*^9, 3.687183019982044*^9}, 3.688302112861424*^9, 
   3.688302172631486*^9}],

Cell[BoxData["\<\"C Frame\"\>"], "Print",
 CellChangeTimes->{{3.686640069080427*^9, 3.686640086668515*^9}, 
   3.6869160653736*^9, 3.686977937425516*^9, {3.686992452178711*^9, 
   3.686992478544614*^9}, 3.687005650640243*^9, 3.687006975495779*^9, 
   3.6870078768905993`*^9, 3.687007988662787*^9, 3.687060930329883*^9, 
   3.687068040730833*^9, 3.687068149678451*^9, 3.6870730911672688`*^9, 
   3.6870920766847897`*^9, 3.687092125867116*^9, 3.6870941288385763`*^9, {
   3.687182990790983*^9, 3.687183019982044*^9}, 3.688302112861424*^9, 
   3.6883021726444483`*^9}],

Cell[BoxData["155.21522170089492`"], "Print",
 CellChangeTimes->{{3.686640069080427*^9, 3.686640086668515*^9}, 
   3.6869160653736*^9, 3.686977937425516*^9, {3.686992452178711*^9, 
   3.686992478544614*^9}, 3.687005650640243*^9, 3.687006975495779*^9, 
   3.6870078768905993`*^9, 3.687007988662787*^9, 3.687060930329883*^9, 
   3.687068040730833*^9, 3.687068149678451*^9, 3.6870730911672688`*^9, 
   3.6870920766847897`*^9, 3.687092125867116*^9, 3.6870941288385763`*^9, {
   3.687182990790983*^9, 3.687183019982044*^9}, 3.688302112861424*^9, 
   3.6883021726597013`*^9}],

Cell[BoxData[
 TagBox[GridBox[{
    {"0.9992573029831214`", 
     RowBox[{
      RowBox[{"-", "0.026484629358795576`"}], "-", 
      RowBox[{"0.006371719679574527`", " ", "\[ImaginaryI]"}]}]},
    {
     RowBox[{
      RowBox[{"-", "0.026484629358795576`"}], "+", 
      RowBox[{"0.006371719679574527`", " ", "\[ImaginaryI]"}]}], 
     "0.0007426970168772352`"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{{3.686640069080427*^9, 3.686640086668515*^9}, 
   3.6869160653736*^9, 3.686977937425516*^9, {3.686992452178711*^9, 
   3.686992478544614*^9}, 3.687005650640243*^9, 3.687006975495779*^9, 
   3.6870078768905993`*^9, 3.687007988662787*^9, 3.687060930329883*^9, 
   3.687068040730833*^9, 3.687068149678451*^9, 3.6870730911672688`*^9, 
   3.6870920766847897`*^9, 3.687092125867116*^9, 3.6870941288385763`*^9, {
   3.687182990790983*^9, 3.687183019982044*^9}, 3.688302112861424*^9, 
   3.688302172673768*^9}],

Cell[BoxData["\<\"Input: Y\"\>"], "Print",
 CellChangeTimes->{{3.686640069080427*^9, 3.686640086668515*^9}, 
   3.6869160653736*^9, 3.686977937425516*^9, {3.686992452178711*^9, 
   3.686992478544614*^9}, 3.687005650640243*^9, 3.687006975495779*^9, 
   3.6870078768905993`*^9, 3.687007988662787*^9, 3.687060930329883*^9, 
   3.687068040730833*^9, 3.687068149678451*^9, 3.6870730911672688`*^9, 
   3.6870920766847897`*^9, 3.687092125867116*^9, 3.6870941288385763`*^9, {
   3.687182990790983*^9, 3.687183019982044*^9}, 3.688302112861424*^9, 
   3.688302172689646*^9}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"0.47521144179510644`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
     RowBox[{"0.2262712037783553`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.4451817946454483`", " ", "\[ImaginaryI]"}]}]},
    {
     RowBox[{"0.2262712037783553`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.4451817946454483`", " ", "\[ImaginaryI]"}]}], 
     RowBox[{"0.5247885582048936`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{{3.686640069080427*^9, 3.686640086668515*^9}, 
   3.6869160653736*^9, 3.686977937425516*^9, {3.686992452178711*^9, 
   3.686992478544614*^9}, 3.687005650640243*^9, 3.687006975495779*^9, 
   3.6870078768905993`*^9, 3.687007988662787*^9, 3.687060930329883*^9, 
   3.687068040730833*^9, 3.687068149678451*^9, 3.6870730911672688`*^9, 
   3.6870920766847897`*^9, 3.687092125867116*^9, 3.6870941288385763`*^9, {
   3.687182990790983*^9, 3.687183019982044*^9}, 3.688302112861424*^9, 
   3.6883021727017803`*^9}],

Cell[BoxData["\<\"C Frame\"\>"], "Print",
 CellChangeTimes->{{3.686640069080427*^9, 3.686640086668515*^9}, 
   3.6869160653736*^9, 3.686977937425516*^9, {3.686992452178711*^9, 
   3.686992478544614*^9}, 3.687005650640243*^9, 3.687006975495779*^9, 
   3.6870078768905993`*^9, 3.687007988662787*^9, 3.687060930329883*^9, 
   3.687068040730833*^9, 3.687068149678451*^9, 3.6870730911672688`*^9, 
   3.6870920766847897`*^9, 3.687092125867116*^9, 3.6870941288385763`*^9, {
   3.687182990790983*^9, 3.687183019982044*^9}, 3.688302112861424*^9, 
   3.688302172716259*^9}],

Cell[BoxData["127.39042930087942`"], "Print",
 CellChangeTimes->{{3.686640069080427*^9, 3.686640086668515*^9}, 
   3.6869160653736*^9, 3.686977937425516*^9, {3.686992452178711*^9, 
   3.686992478544614*^9}, 3.687005650640243*^9, 3.687006975495779*^9, 
   3.6870078768905993`*^9, 3.687007988662787*^9, 3.687060930329883*^9, 
   3.687068040730833*^9, 3.687068149678451*^9, 3.6870730911672688`*^9, 
   3.6870920766847897`*^9, 3.687092125867116*^9, 3.6870941288385763`*^9, {
   3.687182990790983*^9, 3.687183019982044*^9}, 3.688302112861424*^9, 
   3.688302172729704*^9}],

Cell[BoxData[
 TagBox[GridBox[{
    {"0.4752114417951104`", 
     RowBox[{
      RowBox[{"-", "0.49110572245479506`"}], "-", 
      RowBox[{"0.09055748072470896`", " ", "\[ImaginaryI]"}]}]},
    {
     RowBox[{
      RowBox[{"-", "0.49110572245479506`"}], "+", 
      RowBox[{"0.09055748072470896`", " ", "\[ImaginaryI]"}]}], 
     "0.5247885582048979`"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{{3.686640069080427*^9, 3.686640086668515*^9}, 
   3.6869160653736*^9, 3.686977937425516*^9, {3.686992452178711*^9, 
   3.686992478544614*^9}, 3.687005650640243*^9, 3.687006975495779*^9, 
   3.6870078768905993`*^9, 3.687007988662787*^9, 3.687060930329883*^9, 
   3.687068040730833*^9, 3.687068149678451*^9, 3.6870730911672688`*^9, 
   3.6870920766847897`*^9, 3.687092125867116*^9, 3.6870941288385763`*^9, {
   3.687182990790983*^9, 3.687183019982044*^9}, 3.688302112861424*^9, 
   3.688302172743449*^9}],

Cell[BoxData["\<\"Input: Z\"\>"], "Print",
 CellChangeTimes->{{3.686640069080427*^9, 3.686640086668515*^9}, 
   3.6869160653736*^9, 3.686977937425516*^9, {3.686992452178711*^9, 
   3.686992478544614*^9}, 3.687005650640243*^9, 3.687006975495779*^9, 
   3.6870078768905993`*^9, 3.687007988662787*^9, 3.687060930329883*^9, 
   3.687068040730833*^9, 3.687068149678451*^9, 3.6870730911672688`*^9, 
   3.6870920766847897`*^9, 3.687092125867116*^9, 3.6870941288385763`*^9, {
   3.687182990790983*^9, 3.687183019982044*^9}, 3.688302112861424*^9, 
   3.688302172756513*^9}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"0.48966733657174966`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
     RowBox[{"0.4433810667282894`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.23088184882056606`", " ", "\[ImaginaryI]"}]}]},
    {
     RowBox[{"0.4433810667282894`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.23088184882056606`", " ", "\[ImaginaryI]"}]}], 
     RowBox[{"0.5103326634282503`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{{3.686640069080427*^9, 3.686640086668515*^9}, 
   3.6869160653736*^9, 3.686977937425516*^9, {3.686992452178711*^9, 
   3.686992478544614*^9}, 3.687005650640243*^9, 3.687006975495779*^9, 
   3.6870078768905993`*^9, 3.687007988662787*^9, 3.687060930329883*^9, 
   3.687068040730833*^9, 3.687068149678451*^9, 3.6870730911672688`*^9, 
   3.6870920766847897`*^9, 3.687092125867116*^9, 3.6870941288385763`*^9, {
   3.687182990790983*^9, 3.687183019982044*^9}, 3.688302112861424*^9, 
   3.688302172768147*^9}],

Cell[BoxData["\<\"C Frame\"\>"], "Print",
 CellChangeTimes->{{3.686640069080427*^9, 3.686640086668515*^9}, 
   3.6869160653736*^9, 3.686977937425516*^9, {3.686992452178711*^9, 
   3.686992478544614*^9}, 3.687005650640243*^9, 3.687006975495779*^9, 
   3.6870078768905993`*^9, 3.687007988662787*^9, 3.687060930329883*^9, 
   3.687068040730833*^9, 3.687068149678451*^9, 3.6870730911672688`*^9, 
   3.6870920766847897`*^9, 3.687092125867116*^9, 3.6870941288385763`*^9, {
   3.687182990790983*^9, 3.687183019982044*^9}, 3.688302112861424*^9, 
   3.688302172781209*^9}],

Cell[BoxData["168.2154289488976`"], "Print",
 CellChangeTimes->{{3.686640069080427*^9, 3.686640086668515*^9}, 
   3.6869160653736*^9, 3.686977937425516*^9, {3.686992452178711*^9, 
   3.686992478544614*^9}, 3.687005650640243*^9, 3.687006975495779*^9, 
   3.6870078768905993`*^9, 3.687007988662787*^9, 3.687060930329883*^9, 
   3.687068040730833*^9, 3.687068149678451*^9, 3.6870730911672688`*^9, 
   3.6870920766847897`*^9, 3.687092125867116*^9, 3.6870941288385763`*^9, {
   3.687182990790983*^9, 3.687183019982044*^9}, 3.688302112861424*^9, 
   3.688302172792762*^9}],

Cell[BoxData[
 TagBox[GridBox[{
    {"0.489667336571745`", 
     RowBox[{
      RowBox[{"-", "0.386882101891701`"}], "+", 
      RowBox[{"0.31656821963642107`", " ", "\[ImaginaryI]"}]}]},
    {
     RowBox[{
      RowBox[{"-", "0.386882101891701`"}], "-", 
      RowBox[{"0.31656821963642107`", " ", "\[ImaginaryI]"}]}], 
     "0.5103326634282456`"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{{3.686640069080427*^9, 3.686640086668515*^9}, 
   3.6869160653736*^9, 3.686977937425516*^9, {3.686992452178711*^9, 
   3.686992478544614*^9}, 3.687005650640243*^9, 3.687006975495779*^9, 
   3.6870078768905993`*^9, 3.687007988662787*^9, 3.687060930329883*^9, 
   3.687068040730833*^9, 3.687068149678451*^9, 3.6870730911672688`*^9, 
   3.6870920766847897`*^9, 3.687092125867116*^9, 3.6870941288385763`*^9, {
   3.687182990790983*^9, 3.687183019982044*^9}, 3.688302112861424*^9, 
   3.68830217280413*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"pulseLT4", "=", "MBIinit"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"initState", "=", 
   RowBox[{"KP", "[", 
    RowBox[{
     SubscriptBox["\[ScriptCapitalP]", "0"], ",", 
     RowBox[{
      SubscriptBox["\[Sigma]", "0"], "/", "2"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"outState", "=", 
  RowBox[{"PTr", "[", 
   RowBox[{
    RowBox[{"{", "1", "}"}], ",", 
    RowBox[{"transformAndNorm", "[", 
     RowBox[{"initState", ",", "pulseLT4"}], "]"}]}], "]"}]}]}], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.48913908404718287`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.44337382675242787`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.23045048490926792`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.44337382675242787`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.23045048490926792`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.5108609159528171`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.686627866555084*^9, 3.686634162106292*^9, 
  3.686639287792632*^9, 3.6869160657382708`*^9, 3.6869779377473383`*^9, 
  3.686992452503666*^9, 3.6870056510813093`*^9, 3.687006976318884*^9, 
  3.68700787732449*^9, 3.687007990232829*^9, 3.687060930688953*^9, 
  3.6870680411007233`*^9, 3.687068150136636*^9, 3.687073091583317*^9, 
  3.6870920770321083`*^9, 3.687092126263041*^9, 3.687094129157131*^9, 
  3.687182991119752*^9, 3.687183021918727*^9, 3.688302113271797*^9, 
  3.688302173081112*^9}]
}, Open  ]],

Cell["How does it look in different tomo bases?", "Text",
 CellChangeTimes->{{3.68657188696192*^9, 3.6865718911696997`*^9}, {
  3.686626167160488*^9, 3.686626167795385*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bases", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"j", "=", "1"}], ",", 
   RowBox[{"j", "\[LessEqual]", "3"}], ",", 
   RowBox[{"j", "++"}], ",", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Input: \>\"", "<>", 
      RowBox[{"bases", "[", 
       RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ";", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "\[LessEqual]", "3"}], ",", 
      RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pulseLT4", "=", 
        RowBox[{
         RowBox[{"TomoSwap", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ".", 
         RowBox[{"InitSwap", "[", 
          RowBox[{"[", "j", "]"}], "]"}], ".", "InitLT4Swap"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"initState", "=", 
        RowBox[{"KP", "[", 
         RowBox[{
          SubscriptBox["\[ScriptCapitalP]", "0"], ",", 
          RowBox[{
           SubscriptBox["\[Sigma]", "0"], "/", "2"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"outState", "=", 
        RowBox[{"PTr", "[", 
         RowBox[{
          RowBox[{"{", "2", "}"}], ",", 
          RowBox[{"transformAndNorm", "[", 
           RowBox[{"initState", ",", "pulseLT4"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
         RowBox[{"bases", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "<>", "\"\< \>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"Re", "[", 
           RowBox[{"Tr", "[", 
            RowBox[{
             SubscriptBox["\[Sigma]", "3"], ".", "outState"}], "]"}], "]"}], 
          "]"}]}], "]"}]}]}], "]"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.686282460485449*^9, 3.686282470631975*^9}, {
   3.6862825183559637`*^9, 3.686282523375268*^9}, {3.6862825993943644`*^9, 
   3.686282628340599*^9}, {3.6862828891826773`*^9, 3.6862828967909517`*^9}, {
   3.686287286513729*^9, 3.686287353057444*^9}, {3.686287385376472*^9, 
   3.686287385528781*^9}, {3.686287423601384*^9, 3.6862874508597803`*^9}, {
   3.686287485927495*^9, 3.6862874861241207`*^9}, 3.6862875424098043`*^9, {
   3.686303735254549*^9, 3.686303838110813*^9}, {3.686303894589242*^9, 
   3.686303918201098*^9}, {3.6864738817849827`*^9, 3.6864738861137466`*^9}, {
   3.686485216928506*^9, 3.686485217716219*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"Input: X\"\>"], "Print",
 CellChangeTimes->{
  3.686287451145059*^9, 3.6862874865741653`*^9, 3.686287550003029*^9, 
   3.686290059243334*^9, 3.686290105717408*^9, 3.686290256607218*^9, 
   3.6862994514171963`*^9, 3.686301426286298*^9, 3.68630155924797*^9, 
   3.68630357283491*^9, {3.6863037473273087`*^9, 3.686303838488949*^9}, 
   3.686303919064446*^9, 3.686304760774735*^9, 3.686306367068056*^9, 
   3.686306518277248*^9, 3.68630696793642*^9, 3.686307128519987*^9, 
   3.686309644185211*^9, 3.6863098193046703`*^9, 3.686312900819681*^9, 
   3.6863139621909523`*^9, 3.6863693214964933`*^9, 3.686369652729047*^9, 
   3.686371599802937*^9, 3.686372410648528*^9, 3.686372466663102*^9, 
   3.6863745454399757`*^9, 3.6863751394369717`*^9, 3.6863758969776297`*^9, {
   3.6864738628929253`*^9, 3.686473887482531*^9}, 3.6864741083662663`*^9, 
   3.6864743542639236`*^9, {3.686474627111546*^9, 3.686474640056353*^9}, 
   3.686474885665637*^9, 3.6864762036763678`*^9, {3.6864763934430532`*^9, 
   3.6864764118304167`*^9}, 3.6864785115344267`*^9, 3.686478542143656*^9, {
   3.686484016460088*^9, 3.68648403469625*^9}, 3.686484792509206*^9, 
   3.686484862868883*^9, 3.686485226208563*^9, 3.686485444959845*^9, {
   3.686485998080852*^9, 3.6864860471149483`*^9}, 3.686486086236793*^9, 
   3.686539677394307*^9, 3.686541109978907*^9, {3.68656084737492*^9, 
   3.6865608760609217`*^9}, 3.686560921321844*^9, 3.686562764198472*^9, {
   3.686563150952256*^9, 3.686563174934256*^9}, 3.686567765791109*^9, 
   3.686568326864026*^9, 3.6866256953043833`*^9, 3.686627866667658*^9, 
   3.686634162236991*^9, 3.6866392879108143`*^9, 3.686916065870009*^9, 
   3.68697793784509*^9, 3.686992452612999*^9, 3.687005651237278*^9, 
   3.6870069765973997`*^9, 3.687007877444675*^9, 3.68700799126336*^9, 
   3.687060930774557*^9, 3.687068041652754*^9, 3.6870681502746973`*^9, 
   3.6870730916867313`*^9, 3.687092077200364*^9, 3.6870921263990593`*^9, 
   3.687094129257394*^9, 3.68718299122569*^9, 3.687183022060851*^9, 
   3.688302113363765*^9, 3.6883021733659143`*^9}],

Cell[BoxData["\<\"X 0.000918591\"\>"], "Print",
 CellChangeTimes->{
  3.686287451145059*^9, 3.6862874865741653`*^9, 3.686287550003029*^9, 
   3.686290059243334*^9, 3.686290105717408*^9, 3.686290256607218*^9, 
   3.6862994514171963`*^9, 3.686301426286298*^9, 3.68630155924797*^9, 
   3.68630357283491*^9, {3.6863037473273087`*^9, 3.686303838488949*^9}, 
   3.686303919064446*^9, 3.686304760774735*^9, 3.686306367068056*^9, 
   3.686306518277248*^9, 3.68630696793642*^9, 3.686307128519987*^9, 
   3.686309644185211*^9, 3.6863098193046703`*^9, 3.686312900819681*^9, 
   3.6863139621909523`*^9, 3.6863693214964933`*^9, 3.686369652729047*^9, 
   3.686371599802937*^9, 3.686372410648528*^9, 3.686372466663102*^9, 
   3.6863745454399757`*^9, 3.6863751394369717`*^9, 3.6863758969776297`*^9, {
   3.6864738628929253`*^9, 3.686473887482531*^9}, 3.6864741083662663`*^9, 
   3.6864743542639236`*^9, {3.686474627111546*^9, 3.686474640056353*^9}, 
   3.686474885665637*^9, 3.6864762036763678`*^9, {3.6864763934430532`*^9, 
   3.6864764118304167`*^9}, 3.6864785115344267`*^9, 3.686478542143656*^9, {
   3.686484016460088*^9, 3.68648403469625*^9}, 3.686484792509206*^9, 
   3.686484862868883*^9, 3.686485226208563*^9, 3.686485444959845*^9, {
   3.686485998080852*^9, 3.6864860471149483`*^9}, 3.686486086236793*^9, 
   3.686539677394307*^9, 3.686541109978907*^9, {3.68656084737492*^9, 
   3.6865608760609217`*^9}, 3.686560921321844*^9, 3.686562764198472*^9, {
   3.686563150952256*^9, 3.686563174934256*^9}, 3.686567765791109*^9, 
   3.686568326864026*^9, 3.6866256953043833`*^9, 3.686627866667658*^9, 
   3.686634162236991*^9, 3.6866392879108143`*^9, 3.686916065870009*^9, 
   3.68697793784509*^9, 3.686992452612999*^9, 3.687005651237278*^9, 
   3.6870069765973997`*^9, 3.687007877444675*^9, 3.68700799126336*^9, 
   3.687060930774557*^9, 3.687068041652754*^9, 3.6870681502746973`*^9, 
   3.6870730916867313`*^9, 3.687092077200364*^9, 3.6870921263990593`*^9, 
   3.687094129257394*^9, 3.68718299122569*^9, 3.687183022060851*^9, 
   3.688302113363765*^9, 3.6883021733775597`*^9}],

Cell[BoxData["\<\"Y -0.0710881\"\>"], "Print",
 CellChangeTimes->{
  3.686287451145059*^9, 3.6862874865741653`*^9, 3.686287550003029*^9, 
   3.686290059243334*^9, 3.686290105717408*^9, 3.686290256607218*^9, 
   3.6862994514171963`*^9, 3.686301426286298*^9, 3.68630155924797*^9, 
   3.68630357283491*^9, {3.6863037473273087`*^9, 3.686303838488949*^9}, 
   3.686303919064446*^9, 3.686304760774735*^9, 3.686306367068056*^9, 
   3.686306518277248*^9, 3.68630696793642*^9, 3.686307128519987*^9, 
   3.686309644185211*^9, 3.6863098193046703`*^9, 3.686312900819681*^9, 
   3.6863139621909523`*^9, 3.6863693214964933`*^9, 3.686369652729047*^9, 
   3.686371599802937*^9, 3.686372410648528*^9, 3.686372466663102*^9, 
   3.6863745454399757`*^9, 3.6863751394369717`*^9, 3.6863758969776297`*^9, {
   3.6864738628929253`*^9, 3.686473887482531*^9}, 3.6864741083662663`*^9, 
   3.6864743542639236`*^9, {3.686474627111546*^9, 3.686474640056353*^9}, 
   3.686474885665637*^9, 3.6864762036763678`*^9, {3.6864763934430532`*^9, 
   3.6864764118304167`*^9}, 3.6864785115344267`*^9, 3.686478542143656*^9, {
   3.686484016460088*^9, 3.68648403469625*^9}, 3.686484792509206*^9, 
   3.686484862868883*^9, 3.686485226208563*^9, 3.686485444959845*^9, {
   3.686485998080852*^9, 3.6864860471149483`*^9}, 3.686486086236793*^9, 
   3.686539677394307*^9, 3.686541109978907*^9, {3.68656084737492*^9, 
   3.6865608760609217`*^9}, 3.686560921321844*^9, 3.686562764198472*^9, {
   3.686563150952256*^9, 3.686563174934256*^9}, 3.686567765791109*^9, 
   3.686568326864026*^9, 3.6866256953043833`*^9, 3.686627866667658*^9, 
   3.686634162236991*^9, 3.6866392879108143`*^9, 3.686916065870009*^9, 
   3.68697793784509*^9, 3.686992452612999*^9, 3.687005651237278*^9, 
   3.6870069765973997`*^9, 3.687007877444675*^9, 3.68700799126336*^9, 
   3.687060930774557*^9, 3.687068041652754*^9, 3.6870681502746973`*^9, 
   3.6870730916867313`*^9, 3.687092077200364*^9, 3.6870921263990593`*^9, 
   3.687094129257394*^9, 3.68718299122569*^9, 3.687183022060851*^9, 
   3.688302113363765*^9, 3.688302173390891*^9}],

Cell[BoxData["\<\"Z 0.991544\"\>"], "Print",
 CellChangeTimes->{
  3.686287451145059*^9, 3.6862874865741653`*^9, 3.686287550003029*^9, 
   3.686290059243334*^9, 3.686290105717408*^9, 3.686290256607218*^9, 
   3.6862994514171963`*^9, 3.686301426286298*^9, 3.68630155924797*^9, 
   3.68630357283491*^9, {3.6863037473273087`*^9, 3.686303838488949*^9}, 
   3.686303919064446*^9, 3.686304760774735*^9, 3.686306367068056*^9, 
   3.686306518277248*^9, 3.68630696793642*^9, 3.686307128519987*^9, 
   3.686309644185211*^9, 3.6863098193046703`*^9, 3.686312900819681*^9, 
   3.6863139621909523`*^9, 3.6863693214964933`*^9, 3.686369652729047*^9, 
   3.686371599802937*^9, 3.686372410648528*^9, 3.686372466663102*^9, 
   3.6863745454399757`*^9, 3.6863751394369717`*^9, 3.6863758969776297`*^9, {
   3.6864738628929253`*^9, 3.686473887482531*^9}, 3.6864741083662663`*^9, 
   3.6864743542639236`*^9, {3.686474627111546*^9, 3.686474640056353*^9}, 
   3.686474885665637*^9, 3.6864762036763678`*^9, {3.6864763934430532`*^9, 
   3.6864764118304167`*^9}, 3.6864785115344267`*^9, 3.686478542143656*^9, {
   3.686484016460088*^9, 3.68648403469625*^9}, 3.686484792509206*^9, 
   3.686484862868883*^9, 3.686485226208563*^9, 3.686485444959845*^9, {
   3.686485998080852*^9, 3.6864860471149483`*^9}, 3.686486086236793*^9, 
   3.686539677394307*^9, 3.686541109978907*^9, {3.68656084737492*^9, 
   3.6865608760609217`*^9}, 3.686560921321844*^9, 3.686562764198472*^9, {
   3.686563150952256*^9, 3.686563174934256*^9}, 3.686567765791109*^9, 
   3.686568326864026*^9, 3.6866256953043833`*^9, 3.686627866667658*^9, 
   3.686634162236991*^9, 3.6866392879108143`*^9, 3.686916065870009*^9, 
   3.68697793784509*^9, 3.686992452612999*^9, 3.687005651237278*^9, 
   3.6870069765973997`*^9, 3.687007877444675*^9, 3.68700799126336*^9, 
   3.687060930774557*^9, 3.687068041652754*^9, 3.6870681502746973`*^9, 
   3.6870730916867313`*^9, 3.687092077200364*^9, 3.6870921263990593`*^9, 
   3.687094129257394*^9, 3.68718299122569*^9, 3.687183022060851*^9, 
   3.688302113363765*^9, 3.688302173405931*^9}],

Cell[BoxData["\<\"Input: Y\"\>"], "Print",
 CellChangeTimes->{
  3.686287451145059*^9, 3.6862874865741653`*^9, 3.686287550003029*^9, 
   3.686290059243334*^9, 3.686290105717408*^9, 3.686290256607218*^9, 
   3.6862994514171963`*^9, 3.686301426286298*^9, 3.68630155924797*^9, 
   3.68630357283491*^9, {3.6863037473273087`*^9, 3.686303838488949*^9}, 
   3.686303919064446*^9, 3.686304760774735*^9, 3.686306367068056*^9, 
   3.686306518277248*^9, 3.68630696793642*^9, 3.686307128519987*^9, 
   3.686309644185211*^9, 3.6863098193046703`*^9, 3.686312900819681*^9, 
   3.6863139621909523`*^9, 3.6863693214964933`*^9, 3.686369652729047*^9, 
   3.686371599802937*^9, 3.686372410648528*^9, 3.686372466663102*^9, 
   3.6863745454399757`*^9, 3.6863751394369717`*^9, 3.6863758969776297`*^9, {
   3.6864738628929253`*^9, 3.686473887482531*^9}, 3.6864741083662663`*^9, 
   3.6864743542639236`*^9, {3.686474627111546*^9, 3.686474640056353*^9}, 
   3.686474885665637*^9, 3.6864762036763678`*^9, {3.6864763934430532`*^9, 
   3.6864764118304167`*^9}, 3.6864785115344267`*^9, 3.686478542143656*^9, {
   3.686484016460088*^9, 3.68648403469625*^9}, 3.686484792509206*^9, 
   3.686484862868883*^9, 3.686485226208563*^9, 3.686485444959845*^9, {
   3.686485998080852*^9, 3.6864860471149483`*^9}, 3.686486086236793*^9, 
   3.686539677394307*^9, 3.686541109978907*^9, {3.68656084737492*^9, 
   3.6865608760609217`*^9}, 3.686560921321844*^9, 3.686562764198472*^9, {
   3.686563150952256*^9, 3.686563174934256*^9}, 3.686567765791109*^9, 
   3.686568326864026*^9, 3.6866256953043833`*^9, 3.686627866667658*^9, 
   3.686634162236991*^9, 3.6866392879108143`*^9, 3.686916065870009*^9, 
   3.68697793784509*^9, 3.686992452612999*^9, 3.687005651237278*^9, 
   3.6870069765973997`*^9, 3.687007877444675*^9, 3.68700799126336*^9, 
   3.687060930774557*^9, 3.687068041652754*^9, 3.6870681502746973`*^9, 
   3.6870730916867313`*^9, 3.687092077200364*^9, 3.6870921263990593`*^9, 
   3.687094129257394*^9, 3.68718299122569*^9, 3.687183022060851*^9, 
   3.688302113363765*^9, 3.688302173421406*^9}],

Cell[BoxData["\<\"X -0.00724499\"\>"], "Print",
 CellChangeTimes->{
  3.686287451145059*^9, 3.6862874865741653`*^9, 3.686287550003029*^9, 
   3.686290059243334*^9, 3.686290105717408*^9, 3.686290256607218*^9, 
   3.6862994514171963`*^9, 3.686301426286298*^9, 3.68630155924797*^9, 
   3.68630357283491*^9, {3.6863037473273087`*^9, 3.686303838488949*^9}, 
   3.686303919064446*^9, 3.686304760774735*^9, 3.686306367068056*^9, 
   3.686306518277248*^9, 3.68630696793642*^9, 3.686307128519987*^9, 
   3.686309644185211*^9, 3.6863098193046703`*^9, 3.686312900819681*^9, 
   3.6863139621909523`*^9, 3.6863693214964933`*^9, 3.686369652729047*^9, 
   3.686371599802937*^9, 3.686372410648528*^9, 3.686372466663102*^9, 
   3.6863745454399757`*^9, 3.6863751394369717`*^9, 3.6863758969776297`*^9, {
   3.6864738628929253`*^9, 3.686473887482531*^9}, 3.6864741083662663`*^9, 
   3.6864743542639236`*^9, {3.686474627111546*^9, 3.686474640056353*^9}, 
   3.686474885665637*^9, 3.6864762036763678`*^9, {3.6864763934430532`*^9, 
   3.6864764118304167`*^9}, 3.6864785115344267`*^9, 3.686478542143656*^9, {
   3.686484016460088*^9, 3.68648403469625*^9}, 3.686484792509206*^9, 
   3.686484862868883*^9, 3.686485226208563*^9, 3.686485444959845*^9, {
   3.686485998080852*^9, 3.6864860471149483`*^9}, 3.686486086236793*^9, 
   3.686539677394307*^9, 3.686541109978907*^9, {3.68656084737492*^9, 
   3.6865608760609217`*^9}, 3.686560921321844*^9, 3.686562764198472*^9, {
   3.686563150952256*^9, 3.686563174934256*^9}, 3.686567765791109*^9, 
   3.686568326864026*^9, 3.6866256953043833`*^9, 3.686627866667658*^9, 
   3.686634162236991*^9, 3.6866392879108143`*^9, 3.686916065870009*^9, 
   3.68697793784509*^9, 3.686992452612999*^9, 3.687005651237278*^9, 
   3.6870069765973997`*^9, 3.687007877444675*^9, 3.68700799126336*^9, 
   3.687060930774557*^9, 3.687068041652754*^9, 3.6870681502746973`*^9, 
   3.6870730916867313`*^9, 3.687092077200364*^9, 3.6870921263990593`*^9, 
   3.687094129257394*^9, 3.68718299122569*^9, 3.687183022060851*^9, 
   3.688302113363765*^9, 3.6883021734324293`*^9}],

Cell[BoxData["\<\"Y -0.997057\"\>"], "Print",
 CellChangeTimes->{
  3.686287451145059*^9, 3.6862874865741653`*^9, 3.686287550003029*^9, 
   3.686290059243334*^9, 3.686290105717408*^9, 3.686290256607218*^9, 
   3.6862994514171963`*^9, 3.686301426286298*^9, 3.68630155924797*^9, 
   3.68630357283491*^9, {3.6863037473273087`*^9, 3.686303838488949*^9}, 
   3.686303919064446*^9, 3.686304760774735*^9, 3.686306367068056*^9, 
   3.686306518277248*^9, 3.68630696793642*^9, 3.686307128519987*^9, 
   3.686309644185211*^9, 3.6863098193046703`*^9, 3.686312900819681*^9, 
   3.6863139621909523`*^9, 3.6863693214964933`*^9, 3.686369652729047*^9, 
   3.686371599802937*^9, 3.686372410648528*^9, 3.686372466663102*^9, 
   3.6863745454399757`*^9, 3.6863751394369717`*^9, 3.6863758969776297`*^9, {
   3.6864738628929253`*^9, 3.686473887482531*^9}, 3.6864741083662663`*^9, 
   3.6864743542639236`*^9, {3.686474627111546*^9, 3.686474640056353*^9}, 
   3.686474885665637*^9, 3.6864762036763678`*^9, {3.6864763934430532`*^9, 
   3.6864764118304167`*^9}, 3.6864785115344267`*^9, 3.686478542143656*^9, {
   3.686484016460088*^9, 3.68648403469625*^9}, 3.686484792509206*^9, 
   3.686484862868883*^9, 3.686485226208563*^9, 3.686485444959845*^9, {
   3.686485998080852*^9, 3.6864860471149483`*^9}, 3.686486086236793*^9, 
   3.686539677394307*^9, 3.686541109978907*^9, {3.68656084737492*^9, 
   3.6865608760609217`*^9}, 3.686560921321844*^9, 3.686562764198472*^9, {
   3.686563150952256*^9, 3.686563174934256*^9}, 3.686567765791109*^9, 
   3.686568326864026*^9, 3.6866256953043833`*^9, 3.686627866667658*^9, 
   3.686634162236991*^9, 3.6866392879108143`*^9, 3.686916065870009*^9, 
   3.68697793784509*^9, 3.686992452612999*^9, 3.687005651237278*^9, 
   3.6870069765973997`*^9, 3.687007877444675*^9, 3.68700799126336*^9, 
   3.687060930774557*^9, 3.687068041652754*^9, 3.6870681502746973`*^9, 
   3.6870730916867313`*^9, 3.687092077200364*^9, 3.6870921263990593`*^9, 
   3.687094129257394*^9, 3.68718299122569*^9, 3.687183022060851*^9, 
   3.688302113363765*^9, 3.688302173452812*^9}],

Cell[BoxData["\<\"Z -0.0366998\"\>"], "Print",
 CellChangeTimes->{
  3.686287451145059*^9, 3.6862874865741653`*^9, 3.686287550003029*^9, 
   3.686290059243334*^9, 3.686290105717408*^9, 3.686290256607218*^9, 
   3.6862994514171963`*^9, 3.686301426286298*^9, 3.68630155924797*^9, 
   3.68630357283491*^9, {3.6863037473273087`*^9, 3.686303838488949*^9}, 
   3.686303919064446*^9, 3.686304760774735*^9, 3.686306367068056*^9, 
   3.686306518277248*^9, 3.68630696793642*^9, 3.686307128519987*^9, 
   3.686309644185211*^9, 3.6863098193046703`*^9, 3.686312900819681*^9, 
   3.6863139621909523`*^9, 3.6863693214964933`*^9, 3.686369652729047*^9, 
   3.686371599802937*^9, 3.686372410648528*^9, 3.686372466663102*^9, 
   3.6863745454399757`*^9, 3.6863751394369717`*^9, 3.6863758969776297`*^9, {
   3.6864738628929253`*^9, 3.686473887482531*^9}, 3.6864741083662663`*^9, 
   3.6864743542639236`*^9, {3.686474627111546*^9, 3.686474640056353*^9}, 
   3.686474885665637*^9, 3.6864762036763678`*^9, {3.6864763934430532`*^9, 
   3.6864764118304167`*^9}, 3.6864785115344267`*^9, 3.686478542143656*^9, {
   3.686484016460088*^9, 3.68648403469625*^9}, 3.686484792509206*^9, 
   3.686484862868883*^9, 3.686485226208563*^9, 3.686485444959845*^9, {
   3.686485998080852*^9, 3.6864860471149483`*^9}, 3.686486086236793*^9, 
   3.686539677394307*^9, 3.686541109978907*^9, {3.68656084737492*^9, 
   3.6865608760609217`*^9}, 3.686560921321844*^9, 3.686562764198472*^9, {
   3.686563150952256*^9, 3.686563174934256*^9}, 3.686567765791109*^9, 
   3.686568326864026*^9, 3.6866256953043833`*^9, 3.686627866667658*^9, 
   3.686634162236991*^9, 3.6866392879108143`*^9, 3.686916065870009*^9, 
   3.68697793784509*^9, 3.686992452612999*^9, 3.687005651237278*^9, 
   3.6870069765973997`*^9, 3.687007877444675*^9, 3.68700799126336*^9, 
   3.687060930774557*^9, 3.687068041652754*^9, 3.6870681502746973`*^9, 
   3.6870730916867313`*^9, 3.687092077200364*^9, 3.6870921263990593`*^9, 
   3.687094129257394*^9, 3.68718299122569*^9, 3.687183022060851*^9, 
   3.688302113363765*^9, 3.688302173467579*^9}],

Cell[BoxData["\<\"Input: Z\"\>"], "Print",
 CellChangeTimes->{
  3.686287451145059*^9, 3.6862874865741653`*^9, 3.686287550003029*^9, 
   3.686290059243334*^9, 3.686290105717408*^9, 3.686290256607218*^9, 
   3.6862994514171963`*^9, 3.686301426286298*^9, 3.68630155924797*^9, 
   3.68630357283491*^9, {3.6863037473273087`*^9, 3.686303838488949*^9}, 
   3.686303919064446*^9, 3.686304760774735*^9, 3.686306367068056*^9, 
   3.686306518277248*^9, 3.68630696793642*^9, 3.686307128519987*^9, 
   3.686309644185211*^9, 3.6863098193046703`*^9, 3.686312900819681*^9, 
   3.6863139621909523`*^9, 3.6863693214964933`*^9, 3.686369652729047*^9, 
   3.686371599802937*^9, 3.686372410648528*^9, 3.686372466663102*^9, 
   3.6863745454399757`*^9, 3.6863751394369717`*^9, 3.6863758969776297`*^9, {
   3.6864738628929253`*^9, 3.686473887482531*^9}, 3.6864741083662663`*^9, 
   3.6864743542639236`*^9, {3.686474627111546*^9, 3.686474640056353*^9}, 
   3.686474885665637*^9, 3.6864762036763678`*^9, {3.6864763934430532`*^9, 
   3.6864764118304167`*^9}, 3.6864785115344267`*^9, 3.686478542143656*^9, {
   3.686484016460088*^9, 3.68648403469625*^9}, 3.686484792509206*^9, 
   3.686484862868883*^9, 3.686485226208563*^9, 3.686485444959845*^9, {
   3.686485998080852*^9, 3.6864860471149483`*^9}, 3.686486086236793*^9, 
   3.686539677394307*^9, 3.686541109978907*^9, {3.68656084737492*^9, 
   3.6865608760609217`*^9}, 3.686560921321844*^9, 3.686562764198472*^9, {
   3.686563150952256*^9, 3.686563174934256*^9}, 3.686567765791109*^9, 
   3.686568326864026*^9, 3.6866256953043833`*^9, 3.686627866667658*^9, 
   3.686634162236991*^9, 3.6866392879108143`*^9, 3.686916065870009*^9, 
   3.68697793784509*^9, 3.686992452612999*^9, 3.687005651237278*^9, 
   3.6870069765973997`*^9, 3.687007877444675*^9, 3.68700799126336*^9, 
   3.687060930774557*^9, 3.687068041652754*^9, 3.6870681502746973`*^9, 
   3.6870730916867313`*^9, 3.687092077200364*^9, 3.6870921263990593`*^9, 
   3.687094129257394*^9, 3.68718299122569*^9, 3.687183022060851*^9, 
   3.688302113363765*^9, 3.6883021734780283`*^9}],

Cell[BoxData["\<\"X 0.999613\"\>"], "Print",
 CellChangeTimes->{
  3.686287451145059*^9, 3.6862874865741653`*^9, 3.686287550003029*^9, 
   3.686290059243334*^9, 3.686290105717408*^9, 3.686290256607218*^9, 
   3.6862994514171963`*^9, 3.686301426286298*^9, 3.68630155924797*^9, 
   3.68630357283491*^9, {3.6863037473273087`*^9, 3.686303838488949*^9}, 
   3.686303919064446*^9, 3.686304760774735*^9, 3.686306367068056*^9, 
   3.686306518277248*^9, 3.68630696793642*^9, 3.686307128519987*^9, 
   3.686309644185211*^9, 3.6863098193046703`*^9, 3.686312900819681*^9, 
   3.6863139621909523`*^9, 3.6863693214964933`*^9, 3.686369652729047*^9, 
   3.686371599802937*^9, 3.686372410648528*^9, 3.686372466663102*^9, 
   3.6863745454399757`*^9, 3.6863751394369717`*^9, 3.6863758969776297`*^9, {
   3.6864738628929253`*^9, 3.686473887482531*^9}, 3.6864741083662663`*^9, 
   3.6864743542639236`*^9, {3.686474627111546*^9, 3.686474640056353*^9}, 
   3.686474885665637*^9, 3.6864762036763678`*^9, {3.6864763934430532`*^9, 
   3.6864764118304167`*^9}, 3.6864785115344267`*^9, 3.686478542143656*^9, {
   3.686484016460088*^9, 3.68648403469625*^9}, 3.686484792509206*^9, 
   3.686484862868883*^9, 3.686485226208563*^9, 3.686485444959845*^9, {
   3.686485998080852*^9, 3.6864860471149483`*^9}, 3.686486086236793*^9, 
   3.686539677394307*^9, 3.686541109978907*^9, {3.68656084737492*^9, 
   3.6865608760609217`*^9}, 3.686560921321844*^9, 3.686562764198472*^9, {
   3.686563150952256*^9, 3.686563174934256*^9}, 3.686567765791109*^9, 
   3.686568326864026*^9, 3.6866256953043833`*^9, 3.686627866667658*^9, 
   3.686634162236991*^9, 3.6866392879108143`*^9, 3.686916065870009*^9, 
   3.68697793784509*^9, 3.686992452612999*^9, 3.687005651237278*^9, 
   3.6870069765973997`*^9, 3.687007877444675*^9, 3.68700799126336*^9, 
   3.687060930774557*^9, 3.687068041652754*^9, 3.6870681502746973`*^9, 
   3.6870730916867313`*^9, 3.687092077200364*^9, 3.6870921263990593`*^9, 
   3.687094129257394*^9, 3.68718299122569*^9, 3.687183022060851*^9, 
   3.688302113363765*^9, 3.688302173492599*^9}],

Cell[BoxData["\<\"Y 0.00229112\"\>"], "Print",
 CellChangeTimes->{
  3.686287451145059*^9, 3.6862874865741653`*^9, 3.686287550003029*^9, 
   3.686290059243334*^9, 3.686290105717408*^9, 3.686290256607218*^9, 
   3.6862994514171963`*^9, 3.686301426286298*^9, 3.68630155924797*^9, 
   3.68630357283491*^9, {3.6863037473273087`*^9, 3.686303838488949*^9}, 
   3.686303919064446*^9, 3.686304760774735*^9, 3.686306367068056*^9, 
   3.686306518277248*^9, 3.68630696793642*^9, 3.686307128519987*^9, 
   3.686309644185211*^9, 3.6863098193046703`*^9, 3.686312900819681*^9, 
   3.6863139621909523`*^9, 3.6863693214964933`*^9, 3.686369652729047*^9, 
   3.686371599802937*^9, 3.686372410648528*^9, 3.686372466663102*^9, 
   3.6863745454399757`*^9, 3.6863751394369717`*^9, 3.6863758969776297`*^9, {
   3.6864738628929253`*^9, 3.686473887482531*^9}, 3.6864741083662663`*^9, 
   3.6864743542639236`*^9, {3.686474627111546*^9, 3.686474640056353*^9}, 
   3.686474885665637*^9, 3.6864762036763678`*^9, {3.6864763934430532`*^9, 
   3.6864764118304167`*^9}, 3.6864785115344267`*^9, 3.686478542143656*^9, {
   3.686484016460088*^9, 3.68648403469625*^9}, 3.686484792509206*^9, 
   3.686484862868883*^9, 3.686485226208563*^9, 3.686485444959845*^9, {
   3.686485998080852*^9, 3.6864860471149483`*^9}, 3.686486086236793*^9, 
   3.686539677394307*^9, 3.686541109978907*^9, {3.68656084737492*^9, 
   3.6865608760609217`*^9}, 3.686560921321844*^9, 3.686562764198472*^9, {
   3.686563150952256*^9, 3.686563174934256*^9}, 3.686567765791109*^9, 
   3.686568326864026*^9, 3.6866256953043833`*^9, 3.686627866667658*^9, 
   3.686634162236991*^9, 3.6866392879108143`*^9, 3.686916065870009*^9, 
   3.68697793784509*^9, 3.686992452612999*^9, 3.687005651237278*^9, 
   3.6870069765973997`*^9, 3.687007877444675*^9, 3.68700799126336*^9, 
   3.687060930774557*^9, 3.687068041652754*^9, 3.6870681502746973`*^9, 
   3.6870730916867313`*^9, 3.687092077200364*^9, 3.6870921263990593`*^9, 
   3.687094129257394*^9, 3.68718299122569*^9, 3.687183022060851*^9, 
   3.688302113363765*^9, 3.688302173504607*^9}],

Cell[BoxData["\<\"Z -0.11937\"\>"], "Print",
 CellChangeTimes->{
  3.686287451145059*^9, 3.6862874865741653`*^9, 3.686287550003029*^9, 
   3.686290059243334*^9, 3.686290105717408*^9, 3.686290256607218*^9, 
   3.6862994514171963`*^9, 3.686301426286298*^9, 3.68630155924797*^9, 
   3.68630357283491*^9, {3.6863037473273087`*^9, 3.686303838488949*^9}, 
   3.686303919064446*^9, 3.686304760774735*^9, 3.686306367068056*^9, 
   3.686306518277248*^9, 3.68630696793642*^9, 3.686307128519987*^9, 
   3.686309644185211*^9, 3.6863098193046703`*^9, 3.686312900819681*^9, 
   3.6863139621909523`*^9, 3.6863693214964933`*^9, 3.686369652729047*^9, 
   3.686371599802937*^9, 3.686372410648528*^9, 3.686372466663102*^9, 
   3.6863745454399757`*^9, 3.6863751394369717`*^9, 3.6863758969776297`*^9, {
   3.6864738628929253`*^9, 3.686473887482531*^9}, 3.6864741083662663`*^9, 
   3.6864743542639236`*^9, {3.686474627111546*^9, 3.686474640056353*^9}, 
   3.686474885665637*^9, 3.6864762036763678`*^9, {3.6864763934430532`*^9, 
   3.6864764118304167`*^9}, 3.6864785115344267`*^9, 3.686478542143656*^9, {
   3.686484016460088*^9, 3.68648403469625*^9}, 3.686484792509206*^9, 
   3.686484862868883*^9, 3.686485226208563*^9, 3.686485444959845*^9, {
   3.686485998080852*^9, 3.6864860471149483`*^9}, 3.686486086236793*^9, 
   3.686539677394307*^9, 3.686541109978907*^9, {3.68656084737492*^9, 
   3.6865608760609217`*^9}, 3.686560921321844*^9, 3.686562764198472*^9, {
   3.686563150952256*^9, 3.686563174934256*^9}, 3.686567765791109*^9, 
   3.686568326864026*^9, 3.6866256953043833`*^9, 3.686627866667658*^9, 
   3.686634162236991*^9, 3.6866392879108143`*^9, 3.686916065870009*^9, 
   3.68697793784509*^9, 3.686992452612999*^9, 3.687005651237278*^9, 
   3.6870069765973997`*^9, 3.687007877444675*^9, 3.68700799126336*^9, 
   3.687060930774557*^9, 3.687068041652754*^9, 3.6870681502746973`*^9, 
   3.6870730916867313`*^9, 3.687092077200364*^9, 3.6870921263990593`*^9, 
   3.687094129257394*^9, 3.68718299122569*^9, 3.687183022060851*^9, 
   3.688302113363765*^9, 3.688302173516666*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["LT3", "Subsection",
 CellChangeTimes->{{3.6864845822869453`*^9, 3.6864845954442663`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LT3SwapX", "=", 
   RowBox[{"getPulses", "[", 
    RowBox[{"basedirLT3", ",", "\"\<AWG_seqs_elc_carb_swap_X\>\""}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.68621226078228*^9, 3.6862122614118223`*^9}, {
   3.6862130000838127`*^9, 3.6862130114014673`*^9}, 3.6862135326294947`*^9, {
   3.68621454877389*^9, 3.68621454879186*^9}, {3.6862822817670927`*^9, 
   3.686282311673664*^9}, {3.686289852863875*^9, 3.686289895871109*^9}, 
   3.686483378626306*^9, {3.686484603281702*^9, 3.686484603824814*^9}, 
   3.68709205496985*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LT3SwapY", "=", 
   RowBox[{"getPulses", "[", 
    RowBox[{"basedirLT3", ",", "\"\<AWG_seqs_elc_carb_swap_Y\>\""}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.68621226078228*^9, 3.6862122614118223`*^9}, {
   3.6862130000838127`*^9, 3.6862130114014673`*^9}, 3.6862135326294947`*^9, {
   3.68621454877389*^9, 3.68621454879186*^9}, {3.6862822817670927`*^9, 
   3.686282311673664*^9}, {3.686286935892568*^9, 3.6862869489854507`*^9}, {
   3.686289871206646*^9, 3.686289908030209*^9}, 3.6864833786402817`*^9, {
   3.6864846044575453`*^9, 3.686484604647735*^9}, 3.6870920549825773`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LT3SwapZ", "=", 
   RowBox[{"getPulses", "[", 
    RowBox[{"basedirLT3", ",", "\"\<AWG_seqs_elc_carb_swap_Z\>\""}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.686287093080871*^9, 3.686287101950189*^9}, {
   3.686289874096245*^9, 3.686289910286207*^9}, 3.6864833786553497`*^9, {
   3.686484604782824*^9, 3.6864846049838047`*^9}, 3.687092054992146*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"LT3SwapX", "[", 
  RowBox[{"[", 
   RowBox[{";;", ",", "1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.686282316004796*^9, 3.686282319279604*^9}, {
   3.6862899257306223`*^9, 3.6862899673517933`*^9}, 3.686484605106882*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"MBI_0\"\>", 
      "1", "\<\"MBI_0\"\>", "\<\"init_C1_y_pt0_tau_0_N_0\"\>", "0.00007936`"},
     {"\<\"init_C1_y_pt0_tau_0_N_0\"\>", 
      "1", "\<\"MBI_0\"\>", "\<\"init_E_y_pt0_tau_0_N_0\"\>", 
      "0.0006146680000000054`"},
     {"\<\"init_E_y_pt0_tau_0_N_0\"\>", 
      "0", "\<\"MBI_0\"\>", "\<\"Tomo_y_pi2_init0_tau_0_N_0\"\>", 
      "0.0006178960000000055`"},
     {"\<\"Tomo_y_pi2_init0_tau_0_N_0\"\>", 
      "0", "\<\"MBI_1\"\>", "\<\"init_C1_y_pt1_tau_0_N_0\"\>", 
      "0.00035419999999999994`"},
     {"\<\"MBI_1\"\>", 
      "1", "\<\"MBI_1\"\>", "\<\"init_C1_y_pt1_tau_0_N_0\"\>", 
      "0.00035419999999999994`"},
     {"\<\"init_C1_y_pt1_tau_0_N_0\"\>", 
      "1", "\<\"MBI_1\"\>", "\<\"init_E_y_pt1_tau_0_N_0\"\>", 
      "0.0006146680000000054`"},
     {"\<\"init_E_y_pt1_tau_0_N_0\"\>", 
      "0", "\<\"MBI_1\"\>", "\<\"Tomo_y_pi2_init1_tau_0_N_0\"\>", 
      "0.0006178960000000055`"},
     {"\<\"Tomo_y_pi2_init1_tau_0_N_0\"\>", 
      "0", "\<\"MBI_2\"\>", "\<\"init_C1_y_pt2_tau_0_N_0\"\>", 
      "0.0003536439999999999`"},
     {"\<\"MBI_2\"\>", 
      "1", "\<\"MBI_2\"\>", "\<\"init_C1_y_pt2_tau_0_N_0\"\>", 
      "0.0003536439999999999`"},
     {"\<\"init_C1_y_pt2_tau_0_N_0\"\>", 
      "1", "\<\"MBI_2\"\>", "\<\"init_E_y_pt2_tau_0_N_0\"\>", 
      "0.0006146680000000054`"},
     {"\<\"init_E_y_pt2_tau_0_N_0\"\>", 
      "0", "\<\"MBI_2\"\>", "\<\"phase_gate_Tomo1_Ren_a_211_2_tau_0_N_0\"\>", 
      "0.0006178960000000055`"},
     {"\<\"phase_gate_Tomo1_Ren_a_211_2_tau_0_N_0\"\>", 
      "0", "\<\"None\"\>", "\<\"None\"\>", "0.0005348600000000054`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.686282320494244*^9, 3.6862828237406187`*^9, 3.686282871353675*^9, {
   3.68628993114113*^9, 3.68628996788203*^9}, 3.686290152215375*^9, 
   3.686299424937703*^9, 3.686301418115417*^9, 3.686301554251363*^9, 
   3.686303560232039*^9, 3.686304741008689*^9, 3.686305039705914*^9, 
   3.686306366482648*^9, 3.6863065177074833`*^9, 3.686306966884769*^9, 
   3.686307128012486*^9, 3.686309643338587*^9, 3.68630981359474*^9, 
   3.686312894594656*^9, 3.686313960498836*^9, 3.686369320416706*^9, 
   3.68636965181505*^9, 3.686371598480473*^9, 3.686372409839552*^9, 
   3.686372465900465*^9, 3.686374544722392*^9, 3.6863758963447123`*^9, 
   3.6864738625085773`*^9, 3.6864741078105583`*^9, 3.686474353763721*^9, {
   3.686474626842517*^9, 3.686474639822332*^9}, 3.6864748851105747`*^9, 
   3.6864762030408783`*^9, {3.686476393205472*^9, 3.68647641157436*^9}, 
   3.686478511174053*^9, 3.686478541805328*^9, {3.686484013894147*^9, 
   3.6864840344189043`*^9}, 3.686484621981461*^9, 3.686484793446025*^9, 
   3.686484863630756*^9, 3.686485445765162*^9, 3.686486021412456*^9, 
   3.686486086879027*^9, 3.68653967805755*^9, 3.6865411109900017`*^9, {
   3.686560848269018*^9, 3.686560876897992*^9}, 3.6865609222300873`*^9, 
   3.686568327706875*^9, 3.686634163081258*^9, 3.6869160668483047`*^9, 
   3.686977938684886*^9, 3.686992453186139*^9, 3.68700565205873*^9, 
   3.6870060593509808`*^9, 3.6870069777765408`*^9, 3.68700787872466*^9, 
   3.68700799213729*^9, 3.687014309193039*^9, 3.6870609319122267`*^9, 
   3.6870680424997883`*^9, 3.687068151196067*^9, 3.687073092712459*^9, 
   3.6870920788909388`*^9, 3.687092127871125*^9, 3.687094130696302*^9, 
   3.687182993096614*^9, 3.687183023763764*^9, 3.688302114965768*^9, 
   3.688302175197616*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"InitLT3Swap", "=", 
    RowBox[{
     RowBox[{"KP", "[", 
      RowBox[{
       SubscriptBox["\[ScriptCapitalP]", "0"], ",", 
       SubscriptBox["\[Sigma]", "0"]}], "]"}], ".", 
     RowBox[{"compiledPulse", "[", 
      RowBox[{"LT3C", ",", 
       RowBox[{"LT3SwapX", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", "LT3WrongRotate"}], "]"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InitEAndSwapLT3SwapX", "=", 
   RowBox[{
    RowBox[{"KP", "[", 
     RowBox[{
      SubscriptBox["\[ScriptCapitalP]", "0"], ",", 
      SubscriptBox["\[Sigma]", "0"]}], "]"}], ".", 
    RowBox[{"compiledPulse", "[", 
     RowBox[{"LT3C", ",", 
      RowBox[{"LT3SwapX", "[", 
       RowBox[{"[", "3", "]"}], "]"}], ",", "LT3WrongRotate"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InitEAndSwapLT3SwapY", "=", 
   RowBox[{
    RowBox[{"KP", "[", 
     RowBox[{
      SubscriptBox["\[ScriptCapitalP]", "0"], ",", 
      SubscriptBox["\[Sigma]", "0"]}], "]"}], ".", 
    RowBox[{"compiledPulse", "[", 
     RowBox[{"LT3C", ",", 
      RowBox[{"LT3SwapY", "[", 
       RowBox[{"[", "3", "]"}], "]"}], ",", "LT3WrongRotate"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InitEAndSwapLT3SwapZ", "=", 
    RowBox[{
     RowBox[{"KP", "[", 
      RowBox[{
       SubscriptBox["\[ScriptCapitalP]", "0"], ",", 
       SubscriptBox["\[Sigma]", "0"]}], "]"}], ".", 
     RowBox[{"compiledPulse", "[", 
      RowBox[{"LT3C", ",", 
       RowBox[{"LT3SwapZ", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", "LT3WrongRotate"}], "]"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InitSwap", "=", 
    RowBox[{"{", 
     RowBox[{
     "InitEAndSwapLT3SwapX", ",", "InitEAndSwapLT3SwapY", ",", 
      "InitEAndSwapLT3SwapZ"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TomoLT3XSwapX", "=", 
   RowBox[{"compiledPulse", "[", 
    RowBox[{"LT3C", ",", 
     RowBox[{"LT3SwapX", "[", 
      RowBox[{"[", "4", "]"}], "]"}], ",", "LT3WrongRotate"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TomoLT3XSwapY", "=", 
   RowBox[{"compiledPulse", "[", 
    RowBox[{"LT3C", ",", 
     RowBox[{"LT3SwapX", "[", 
      RowBox[{"[", "8", "]"}], "]"}], ",", "LT3WrongRotate"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TomoLT3XSwapZ", "=", 
    RowBox[{"compiledPulse", "[", 
     RowBox[{"LT3C", ",", 
      RowBox[{"LT3SwapX", "[", 
       RowBox[{"[", "12", "]"}], "]"}], ",", "LT3WrongRotate"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TomoSwap", "=", 
    RowBox[{"{", 
     RowBox[{"TomoLT3XSwapX", ",", "TomoLT3XSwapY", ",", "TomoLT3XSwapZ"}], 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pulseLT3", "=", "InitLT3Swap"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"initState", "=", 
   RowBox[{"KP", "[", 
    RowBox[{
     SubscriptBox["\[ScriptCapitalP]", "0"], ",", 
     RowBox[{
      SubscriptBox["\[Sigma]", "0"], "/", "2"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"outState", "=", 
   RowBox[{"PTr", "[", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"transformAndNorm", "[", 
      RowBox[{"initState", ",", "pulseLT3"}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bases", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<X\>\"", ",", "\"\<Y\>\"", ",", "\"\<Z\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"j", "=", "1"}], ",", 
   RowBox[{"j", "\[LessEqual]", "3"}], ",", 
   RowBox[{"j", "++"}], ",", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Input: \>\"", "<>", 
      RowBox[{"bases", "[", 
       RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ";", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "\[LessEqual]", "3"}], ",", 
      RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pulseLT3", "=", 
        RowBox[{
         RowBox[{"TomoSwap", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ".", 
         RowBox[{"InitSwap", "[", 
          RowBox[{"[", "j", "]"}], "]"}], ".", "InitLT3Swap"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"initState", "=", 
        RowBox[{"KP", "[", 
         RowBox[{
          SubscriptBox["\[ScriptCapitalP]", "0"], ",", 
          RowBox[{
           SubscriptBox["\[Sigma]", "0"], "/", "2"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"outState", "=", 
        RowBox[{"PTr", "[", 
         RowBox[{
          RowBox[{"{", "2", "}"}], ",", 
          RowBox[{"transformAndNorm", "[", 
           RowBox[{"initState", ",", "pulseLT3"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
         RowBox[{"bases", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "<>", "\"\< \>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"Re", "[", 
           RowBox[{"Tr", "[", 
            RowBox[{
             SubscriptBox["\[Sigma]", "3"], ".", "outState"}], "]"}], "]"}], 
          "]"}]}], "]"}]}]}], "]"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.686204250901569*^9, 3.6862043388278847`*^9}, {
   3.686204399421981*^9, 3.686204454400817*^9}, {3.686204635936344*^9, 
   3.6862046643738813`*^9}, {3.686204700797379*^9, 3.686204770994527*^9}, 
   3.686204846968647*^9, {3.6862048953542957`*^9, 3.686205018415694*^9}, {
   3.686205409140966*^9, 3.686205410255733*^9}, {3.686205746988648*^9, 
   3.6862057727718763`*^9}, {3.6862058117622223`*^9, 3.686205866322283*^9}, 
   3.6862073268265533`*^9, {3.686210218631989*^9, 3.686210219136548*^9}, {
   3.6862102619823*^9, 3.6862102918879967`*^9}, {3.686211789753356*^9, 
   3.686211820355667*^9}, {3.6862145552413816`*^9, 3.6862145553514643`*^9}, {
   3.686282347336713*^9, 3.686282454253824*^9}, {3.6862824956067457`*^9, 
   3.686282501762891*^9}, {3.6862825899611263`*^9, 3.6862825949995747`*^9}, {
   3.686282642143592*^9, 3.686282643438635*^9}, {3.686282701815427*^9, 
   3.6862827421531982`*^9}, {3.6862870166613817`*^9, 
   3.6862870498965693`*^9}, {3.6862872482883387`*^9, 3.6862872787972193`*^9}, 
   3.686287538861377*^9, {3.68628998535781*^9, 3.686290034243812*^9}, 
   3.686290210875903*^9, {3.6862902410725527`*^9, 3.6862902423432217`*^9}, {
   3.686484605751588*^9, 3.686484610862791*^9}, {3.687006067982051*^9, 
   3.687006180569233*^9}, {3.687006274014695*^9, 3.687006275093121*^9}, {
   3.688302036524547*^9, 3.688302045616818*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.00799483624817049`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.05144894723725536`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.07238971340977698`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.05144894723725536`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.07238971340977698`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.9920051637518295`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.687006108036303*^9, 3.6870061810472937`*^9}, 
   3.687006978373893*^9, 3.687007878846189*^9, 3.687007992252596*^9, 
   3.687014310557955*^9, 3.687060932010174*^9, 3.687068042607155*^9, 
   3.687068151339527*^9, 3.687073092806962*^9, 3.687092079092804*^9, 
   3.687092128005056*^9, 3.68709413080844*^9, 3.687182993348669*^9, 
   3.6871830238565617`*^9, 3.688302115267179*^9, 3.688302175319454*^9}],

Cell[CellGroupData[{

Cell[BoxData["\<\"Input: X\"\>"], "Print",
 CellChangeTimes->{{3.68700610805016*^9, 3.68700618106469*^9}, 
   3.687006978391268*^9, 3.687007878869697*^9, 3.6870079922696667`*^9, 
   3.687014310581932*^9, 3.6870609320225563`*^9, 3.6870680426245193`*^9, 
   3.6870681513623543`*^9, 3.687073092822146*^9, 3.687092079103394*^9, 
   3.687092128021885*^9, 3.687094130818943*^9, 3.6871829933572206`*^9, 
   3.687183023863538*^9, 3.688302115276916*^9, 3.688302175328849*^9}],

Cell[BoxData["\<\"X -0.00458003\"\>"], "Print",
 CellChangeTimes->{{3.68700610805016*^9, 3.68700618106469*^9}, 
   3.687006978391268*^9, 3.687007878869697*^9, 3.6870079922696667`*^9, 
   3.687014310581932*^9, 3.6870609320225563`*^9, 3.6870680426245193`*^9, 
   3.6870681513623543`*^9, 3.687073092822146*^9, 3.687092079103394*^9, 
   3.687092128021885*^9, 3.687094130818943*^9, 3.6871829933572206`*^9, 
   3.687183023863538*^9, 3.688302115276916*^9, 3.6883021753360453`*^9}],

Cell[BoxData["\<\"Y -0.152337\"\>"], "Print",
 CellChangeTimes->{{3.68700610805016*^9, 3.68700618106469*^9}, 
   3.687006978391268*^9, 3.687007878869697*^9, 3.6870079922696667`*^9, 
   3.687014310581932*^9, 3.6870609320225563`*^9, 3.6870680426245193`*^9, 
   3.6870681513623543`*^9, 3.687073092822146*^9, 3.687092079103394*^9, 
   3.687092128021885*^9, 3.687094130818943*^9, 3.6871829933572206`*^9, 
   3.687183023863538*^9, 3.688302115276916*^9, 3.688302175345454*^9}],

Cell[BoxData["\<\"Z 0.960145\"\>"], "Print",
 CellChangeTimes->{{3.68700610805016*^9, 3.68700618106469*^9}, 
   3.687006978391268*^9, 3.687007878869697*^9, 3.6870079922696667`*^9, 
   3.687014310581932*^9, 3.6870609320225563`*^9, 3.6870680426245193`*^9, 
   3.6870681513623543`*^9, 3.687073092822146*^9, 3.687092079103394*^9, 
   3.687092128021885*^9, 3.687094130818943*^9, 3.6871829933572206`*^9, 
   3.687183023863538*^9, 3.688302115276916*^9, 3.6883021753562613`*^9}],

Cell[BoxData["\<\"Input: Y\"\>"], "Print",
 CellChangeTimes->{{3.68700610805016*^9, 3.68700618106469*^9}, 
   3.687006978391268*^9, 3.687007878869697*^9, 3.6870079922696667`*^9, 
   3.687014310581932*^9, 3.6870609320225563`*^9, 3.6870680426245193`*^9, 
   3.6870681513623543`*^9, 3.687073092822146*^9, 3.687092079103394*^9, 
   3.687092128021885*^9, 3.687094130818943*^9, 3.6871829933572206`*^9, 
   3.687183023863538*^9, 3.688302115276916*^9, 3.688302175365184*^9}],

Cell[BoxData["\<\"X -0.00107303\"\>"], "Print",
 CellChangeTimes->{{3.68700610805016*^9, 3.68700618106469*^9}, 
   3.687006978391268*^9, 3.687007878869697*^9, 3.6870079922696667`*^9, 
   3.687014310581932*^9, 3.6870609320225563`*^9, 3.6870680426245193`*^9, 
   3.6870681513623543`*^9, 3.687073092822146*^9, 3.687092079103394*^9, 
   3.687092128021885*^9, 3.687094130818943*^9, 3.6871829933572206`*^9, 
   3.687183023863538*^9, 3.688302115276916*^9, 3.6883021753752413`*^9}],

Cell[BoxData["\<\"Y -0.987371\"\>"], "Print",
 CellChangeTimes->{{3.68700610805016*^9, 3.68700618106469*^9}, 
   3.687006978391268*^9, 3.687007878869697*^9, 3.6870079922696667`*^9, 
   3.687014310581932*^9, 3.6870609320225563`*^9, 3.6870680426245193`*^9, 
   3.6870681513623543`*^9, 3.687073092822146*^9, 3.687092079103394*^9, 
   3.687092128021885*^9, 3.687094130818943*^9, 3.6871829933572206`*^9, 
   3.687183023863538*^9, 3.688302115276916*^9, 3.6883021753857803`*^9}],

Cell[BoxData["\<\"Z 0.155527\"\>"], "Print",
 CellChangeTimes->{{3.68700610805016*^9, 3.68700618106469*^9}, 
   3.687006978391268*^9, 3.687007878869697*^9, 3.6870079922696667`*^9, 
   3.687014310581932*^9, 3.6870609320225563`*^9, 3.6870680426245193`*^9, 
   3.6870681513623543`*^9, 3.687073092822146*^9, 3.687092079103394*^9, 
   3.687092128021885*^9, 3.687094130818943*^9, 3.6871829933572206`*^9, 
   3.687183023863538*^9, 3.688302115276916*^9, 3.688302175393985*^9}],

Cell[BoxData["\<\"Input: Z\"\>"], "Print",
 CellChangeTimes->{{3.68700610805016*^9, 3.68700618106469*^9}, 
   3.687006978391268*^9, 3.687007878869697*^9, 3.6870079922696667`*^9, 
   3.687014310581932*^9, 3.6870609320225563`*^9, 3.6870680426245193`*^9, 
   3.6870681513623543`*^9, 3.687073092822146*^9, 3.687092079103394*^9, 
   3.687092128021885*^9, 3.687094130818943*^9, 3.6871829933572206`*^9, 
   3.687183023863538*^9, 3.688302115276916*^9, 3.6883021754026203`*^9}],

Cell[BoxData["\<\"X 0.999909\"\>"], "Print",
 CellChangeTimes->{{3.68700610805016*^9, 3.68700618106469*^9}, 
   3.687006978391268*^9, 3.687007878869697*^9, 3.6870079922696667`*^9, 
   3.687014310581932*^9, 3.6870609320225563`*^9, 3.6870680426245193`*^9, 
   3.6870681513623543`*^9, 3.687073092822146*^9, 3.687092079103394*^9, 
   3.687092128021885*^9, 3.687094130818943*^9, 3.6871829933572206`*^9, 
   3.687183023863538*^9, 3.688302115276916*^9, 3.688302175409442*^9}],

Cell[BoxData["\<\"Y 0.0275503\"\>"], "Print",
 CellChangeTimes->{{3.68700610805016*^9, 3.68700618106469*^9}, 
   3.687006978391268*^9, 3.687007878869697*^9, 3.6870079922696667`*^9, 
   3.687014310581932*^9, 3.6870609320225563`*^9, 3.6870680426245193`*^9, 
   3.6870681513623543`*^9, 3.687073092822146*^9, 3.687092079103394*^9, 
   3.687092128021885*^9, 3.687094130818943*^9, 3.6871829933572206`*^9, 
   3.687183023863538*^9, 3.688302115276916*^9, 3.688302175415083*^9}],

Cell[BoxData["\<\"Z -0.23518\"\>"], "Print",
 CellChangeTimes->{{3.68700610805016*^9, 3.68700618106469*^9}, 
   3.687006978391268*^9, 3.687007878869697*^9, 3.6870079922696667`*^9, 
   3.687014310581932*^9, 3.6870609320225563`*^9, 3.6870680426245193`*^9, 
   3.6870681513623543`*^9, 3.687073092822146*^9, 3.687092079103394*^9, 
   3.687092128021885*^9, 3.687094130818943*^9, 3.6871829933572206`*^9, 
   3.687183023863538*^9, 3.688302115276916*^9, 3.688302175420438*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1339, 992},
WindowMargins->{{163, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.4 for Mac OS X x86 (32-bit, 64-bit Kernel) (April 11, \
2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 101, 1, 62, "Subchapter"],
Cell[CellGroupData[{
Cell[706, 27, 506, 12, 63, "Input"],
Cell[1215, 41, 29888, 817, 367, "Print"]
}, Open  ]],
Cell[31118, 861, 161, 2, 46, "Text"],
Cell[31282, 865, 6435, 178, 273, "Input"],
Cell[37720, 1045, 3660, 107, 157, "Input"],
Cell[41383, 1154, 264, 4, 46, "Text"],
Cell[41650, 1160, 6452, 141, 394, "Input"],
Cell[48105, 1303, 163, 2, 46, "Text"],
Cell[48271, 1307, 2121, 45, 31, "Input"],
Cell[50395, 1354, 192, 3, 46, "Text"],
Cell[50590, 1359, 3934, 91, 182, "Input"],
Cell[54527, 1452, 772, 19, 63, "Input"],
Cell[55302, 1473, 782, 19, 217, "Text"],
Cell[56087, 1494, 8261, 173, 267, "Input"],
Cell[64351, 1669, 67, 1, 28, "Input"],
Cell[64421, 1672, 329, 7, 46, "Text"],
Cell[64753, 1681, 1092, 30, 31, "Input"],
Cell[65848, 1713, 137, 2, 28, "Input"],
Cell[65988, 1717, 6756, 162, 437, "Input"],
Cell[72747, 1881, 18193, 448, 896, "Input"],
Cell[90943, 2331, 922, 23, 46, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[91902, 2359, 100, 1, 62, "Subchapter"],
Cell[CellGroupData[{
Cell[92027, 2364, 91, 1, 44, "Subsection"],
Cell[92121, 2367, 363, 9, 28, "Input"],
Cell[CellGroupData[{
Cell[92509, 2380, 5338, 152, 267, "Input"],
Cell[97850, 2534, 12868, 222, 249, "Output"],
Cell[110721, 2758, 1693, 25, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[112451, 2788, 128, 1, 35, "Subsubsection"],
Cell[112582, 2791, 199, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[112806, 2799, 6267, 161, 250, "Input"],
Cell[119076, 2962, 12943, 222, 249, "Output"],
Cell[132022, 3186, 1931, 28, 28, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[134014, 3221, 93, 1, 44, "Subsection"],
Cell[134110, 3224, 312, 8, 28, "Input"],
Cell[CellGroupData[{
Cell[134447, 3236, 6512, 170, 284, "Input"],
Cell[140962, 3408, 15851, 268, 259, "Output"],
Cell[156816, 3678, 2214, 32, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[159067, 3715, 128, 1, 35, "Subsubsection"],
Cell[159198, 3718, 199, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[159422, 3726, 6565, 166, 250, "Input"],
Cell[165990, 3894, 15532, 265, 249, "Output"],
Cell[181525, 4161, 2033, 30, 28, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[183631, 4199, 151, 2, 62, "Subchapter"],
Cell[CellGroupData[{
Cell[183807, 4205, 91, 1, 44, "Subsection"],
Cell[183901, 4208, 256, 7, 28, "Input"],
Cell[CellGroupData[{
Cell[184182, 4219, 172, 4, 28, "Input"],
Cell[184357, 4225, 2338, 50, 165, "Output"]
}, Open  ]],
Cell[186710, 4278, 2687, 58, 131, "Input"],
Cell[189400, 4338, 184, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[189609, 4344, 2304, 57, 199, "Input"],
Cell[191916, 4403, 3504, 60, 47, "Output"],
Cell[195423, 4465, 3532, 60, 51, "Output"]
}, Open  ]],
Cell[198970, 4528, 119, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[199114, 4533, 2109, 50, 116, "Input"],
Cell[CellGroupData[{
Cell[201248, 4587, 588, 9, 21, "Print"],
Cell[201839, 4598, 588, 9, 21, "Print"],
Cell[202430, 4609, 586, 9, 21, "Print"]
}, Open  ]]
}, Open  ]],
Cell[203043, 4622, 108, 1, 30, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[203188, 4628, 92, 1, 44, "Subsection"],
Cell[203283, 4631, 306, 7, 28, "Input"],
Cell[CellGroupData[{
Cell[203614, 4642, 205, 5, 28, "Input"],
Cell[203822, 4649, 2330, 50, 165, "Output"]
}, Open  ]],
Cell[206167, 4702, 2619, 57, 131, "Input"],
Cell[208789, 4761, 183, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[208997, 4767, 728, 19, 63, "Input"],
Cell[209728, 4788, 3025, 53, 47, "Output"]
}, Open  ]],
Cell[212768, 4844, 119, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[212912, 4849, 2087, 50, 116, "Input"],
Cell[CellGroupData[{
Cell[215024, 4903, 593, 9, 21, "Print"],
Cell[215620, 4914, 595, 9, 21, "Print"],
Cell[216218, 4925, 593, 9, 21, "Print"]
}, Open  ]]
}, Open  ]],
Cell[216838, 4938, 157, 2, 30, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[217032, 4945, 141, 2, 44, "Subsection"],
Cell[217176, 4949, 259, 7, 28, "Input"],
Cell[CellGroupData[{
Cell[217460, 4960, 1016, 31, 97, "Input"],
Cell[218479, 4993, 661, 11, 28, "Output"],
Cell[219143, 5006, 661, 11, 28, "Output"],
Cell[219807, 5019, 664, 11, 28, "Output"],
Cell[220474, 5032, 662, 11, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[221173, 5048, 201, 5, 28, "Input"],
Cell[221377, 5055, 2359, 50, 165, "Output"]
}, Open  ]],
Cell[223751, 5108, 2714, 58, 148, "Input"],
Cell[226468, 5168, 184, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[226677, 5174, 703, 19, 63, "Input"],
Cell[227383, 5195, 3047, 53, 47, "Output"]
}, Open  ]],
Cell[230445, 5251, 119, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[230589, 5256, 2109, 50, 116, "Input"],
Cell[CellGroupData[{
Cell[232723, 5310, 614, 9, 21, "Print"],
Cell[233340, 5321, 610, 9, 21, "Print"],
Cell[233953, 5332, 611, 9, 21, "Print"]
}, Open  ]]
}, Open  ]],
Cell[234591, 5345, 159, 2, 30, "Text"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[234799, 5353, 158, 2, 62, "Subchapter"],
Cell[CellGroupData[{
Cell[234982, 5359, 93, 1, 44, "Subsection"],
Cell[235078, 5362, 518, 10, 28, "Input"],
Cell[235599, 5374, 574, 11, 28, "Input"],
Cell[236176, 5387, 345, 8, 28, "Input"],
Cell[236524, 5397, 236, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[236785, 5406, 2593, 79, 97, "Input"],
Cell[CellGroupData[{
Cell[239403, 5489, 929, 14, 21, "Print"],
Cell[240335, 5505, 929, 14, 21, "Print"],
Cell[241267, 5521, 930, 14, 21, "Print"],
Cell[242200, 5537, 929, 14, 21, "Print"],
Cell[243132, 5553, 929, 14, 21, "Print"],
Cell[244064, 5569, 930, 14, 21, "Print"],
Cell[244997, 5585, 929, 14, 21, "Print"],
Cell[245929, 5601, 929, 14, 21, "Print"],
Cell[246861, 5617, 932, 14, 21, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[247842, 5637, 557, 16, 46, "Input"],
Cell[248402, 5655, 1063, 17, 28, "Output"],
Cell[249468, 5674, 1063, 17, 28, "Output"]
}, Open  ]],
Cell[250546, 5694, 125, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[250696, 5699, 175, 4, 28, "Input"],
Cell[250874, 5705, 2729, 58, 217, "Output"]
}, Open  ]],
Cell[253618, 5766, 3947, 100, 233, "Input"],
Cell[257568, 5868, 685, 13, 28, "Input"],
Cell[258256, 5883, 109, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[258390, 5888, 681, 18, 63, "Input"],
Cell[259074, 5908, 3017, 53, 47, "Output"]
}, Open  ]],
Cell[262106, 5964, 157, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[262288, 5970, 3807, 99, 284, "Input"],
Cell[CellGroupData[{
Cell[266120, 6073, 564, 8, 22, "Print"],
Cell[266687, 6083, 1516, 32, 38, "Print"],
Cell[268206, 6117, 565, 8, 21, "Print"],
Cell[268774, 6127, 569, 8, 21, "Print"],
Cell[269346, 6137, 1354, 31, 38, "Print"],
Cell[270703, 6170, 564, 8, 22, "Print"],
Cell[271270, 6180, 1510, 32, 38, "Print"],
Cell[272783, 6214, 563, 8, 21, "Print"],
Cell[273349, 6224, 567, 8, 21, "Print"],
Cell[273919, 6234, 1347, 31, 38, "Print"],
Cell[275269, 6267, 564, 8, 22, "Print"],
Cell[275836, 6277, 1510, 32, 38, "Print"],
Cell[277349, 6311, 563, 8, 21, "Print"],
Cell[277915, 6321, 566, 8, 21, "Print"],
Cell[278484, 6331, 1341, 31, 38, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[279874, 6368, 538, 16, 63, "Input"],
Cell[280415, 6386, 1562, 33, 47, "Output"]
}, Open  ]],
Cell[281992, 6422, 173, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[282190, 6428, 2514, 61, 116, "Input"],
Cell[CellGroupData[{
Cell[284729, 6493, 2057, 29, 22, "Print"],
Cell[286789, 6524, 2062, 29, 21, "Print"],
Cell[288854, 6555, 2059, 29, 21, "Print"],
Cell[290916, 6586, 2057, 29, 21, "Print"],
Cell[292976, 6617, 2055, 29, 22, "Print"],
Cell[295034, 6648, 2062, 29, 21, "Print"],
Cell[297099, 6679, 2058, 29, 21, "Print"],
Cell[299160, 6710, 2059, 29, 21, "Print"],
Cell[301222, 6741, 2057, 29, 22, "Print"],
Cell[303282, 6772, 2057, 29, 21, "Print"],
Cell[305342, 6803, 2059, 29, 21, "Print"],
Cell[307404, 6834, 2057, 29, 21, "Print"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[309522, 6870, 95, 1, 44, "Subsection"],
Cell[309620, 6873, 567, 11, 28, "Input"],
Cell[310190, 6886, 622, 11, 28, "Input"],
Cell[310815, 6899, 393, 8, 28, "Input"],
Cell[CellGroupData[{
Cell[311233, 6911, 251, 5, 28, "Input"],
Cell[311487, 6918, 3916, 75, 217, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[315440, 6998, 6757, 175, 422, "Input"],
Cell[322200, 7175, 1469, 31, 105, "Output"],
Cell[CellGroupData[{
Cell[323694, 7210, 466, 6, 22, "Print"],
Cell[324163, 7218, 473, 6, 21, "Print"],
Cell[324639, 7226, 469, 6, 21, "Print"],
Cell[325111, 7234, 470, 6, 21, "Print"],
Cell[325584, 7242, 466, 6, 22, "Print"],
Cell[326053, 7250, 473, 6, 21, "Print"],
Cell[326529, 7258, 471, 6, 21, "Print"],
Cell[327003, 7266, 468, 6, 21, "Print"],
Cell[327474, 7274, 468, 6, 22, "Print"],
Cell[327945, 7282, 468, 6, 21, "Print"],
Cell[328416, 7290, 469, 6, 21, "Print"],
Cell[328888, 7298, 468, 6, 21, "Print"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

