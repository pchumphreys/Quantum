(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    150154,       4319]
NotebookOptionsPosition[    142035,       4046]
NotebookOutlinePosition[    142390,       4062]
CellTagsIndexPosition[    142347,       4059]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
This notebook shows how to implement the purification sequences using the \
gates we have to hand with the NV system.\
\>", "Text",
 CellChangeTimes->{{3.6699787220390663`*^9, 3.66997876151622*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Execute", " ", "if", " ", "you", " ", "want", " ", "to", " ", "clear", 
    " ", "all", " ", "current", " ", "definitions"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.669617133697877*^9, 3.6696171388304377`*^9}}],

Cell[CellGroupData[{

Cell["Definitions", "Section",
 CellChangeTimes->{{3.6253821671500354`*^9, 3.625382169200076*^9}, {
  3.6254033016485653`*^9, 3.6254033026585655`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"KP", "[", "r__", "]"}], ":=", 
  RowBox[{"KroneckerProduct", "[", "r", "]"}]}]], "Input",
 CellChangeTimes->{{3.669622303888039*^9, 3.6696223142992983`*^9}, 
   3.669622547593651*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Needs", "[", "\"\<QDENSITY`Qdensity`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<QDENSITY`QCWave`\>\"", "]"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.6695439070995455`*^9, {3.669615285514118*^9, 3.669615286297501*^9}, {
   3.66961535366998*^9, 3.6696153697304783`*^9}, {3.669615480132023*^9, 
   3.669615480610299*^9}, {3.66961556497503*^9, 3.6696155750271273`*^9}, {
   3.669615637840352*^9, 3.6696156384778433`*^9}, {3.6696169979826393`*^9, 
   3.6696170074136553`*^9}, {3.66961712203467*^9, 3.669617122405983*^9}, {
   3.669621269050124*^9, 3.669621274147662*^9}}],

Cell[BoxData["\<\"Type \\\"?intro\\\", \\\"?QDENSITY`Qdensity`*\\\" or \
\\\"?about for help.\"\>"], "Print",
 CellChangeTimes->{3.669659225270487*^9, 3.669974225648615*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["General function definitions", "Subsection",
 CellChangeTimes->{{3.6254032958485656`*^9, 3.6254033003085656`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Stokesfrom\[Rho]", "[", "\[Rho]_", "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Tr", "[", 
     RowBox[{
      SubscriptBox["\[Sigma]", "i"], ".", "\[Rho]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Stokesfrom\[Psi]", "[", "\[Psi]_", "]"}], ":=", 
  RowBox[{"Stokesfrom\[Rho]", "[", 
   RowBox[{"\[Rho]from\[Psi]", "[", "\[Psi]", "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Fidfrom\[Rho]", "[", 
   RowBox[{"\[Rho]_", ",", "\[Sigma]_"}], "]"}], ":=", 
  RowBox[{"Re", "[", 
   SuperscriptBox[
    RowBox[{"Tr", "[", 
     RowBox[{"MatrixPower", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MatrixPower", "[", 
         RowBox[{"\[Rho]", ",", "0.5"}], "]"}], ".", "\[Sigma]", ".", 
        RowBox[{"MatrixPower", "[", 
         RowBox[{"\[Rho]", ",", "0.5"}], "]"}]}], ",", "0.5"}], "]"}], "]"}], 
    "2"], "]"}]}]}], "Input",
 CellChangeTimes->{{3.6253953618339167`*^9, 3.625395387443952*^9}, {
  3.625459934579055*^9, 3.625459984883562*^9}, {3.625460021912673*^9, 
  3.625460092669779*^9}, {3.6254605769573603`*^9, 3.625460663198979*^9}, {
  3.669621625816255*^9, 3.6696216268870153`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "QDENSITY`Qdensity`*"}]], "Input"],

Cell[BoxData[
 DynamicModuleBox[{Typeset`open$$ = True}, 
  PaneSelectorBox[{False->
   RowBox[{
    OpenerBox[Dynamic[Typeset`open$$],
     ImageSize->Small], 
    StyleBox["QDENSITY`Qdensity`", "InfoHeading"]}], True->GridBox[{
     {
      RowBox[{
       OpenerBox[Dynamic[Typeset`open$$],
        ImageSize->Small], 
       StyleBox["QDENSITY`Qdensity`", "InfoHeading"]}]},
     {GridBox[{
        {
         ButtonBox["about",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "about", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["FidelityB",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "FidelityB", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["nq",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "nq", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["res1$",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "res1$", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["ts$",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "ts$", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"]},
        {
         ButtonBox["Adj",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "Adj", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["for",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "for", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["Observables",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "Observables", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["res2",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "res2", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["TwoOp",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "TwoOp", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"]},
        {
         ButtonBox["AF",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "AF", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["had",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "had", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["OneOp",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "OneOp", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["res2$",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "res2$", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["U",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "U", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"]},
        {
         ButtonBox["at",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "at", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["Had",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "Had", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["Oracle",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "Oracle", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["Rotqbit",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "Rotqbit", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["v",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "v", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"]},
        {
         ButtonBox["Bra1",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "Bra1", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["Hadamard",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "Hadamard", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["PartialTrace",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "PartialTrace", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["RotX",
          BaseStyle->"InformationLink",
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "RotX", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["Vs",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "Vs", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"]},
        {
         ButtonBox["BraV",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "BraV", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["HALL",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "HALL", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["PartialTraceGen",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "PartialTraceGen", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["RotY",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "RotY", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["v$",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "v$", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"]},
        {
         ButtonBox["BraX",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "BraX", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["i8",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "i8", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["PartialTranspose",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "PartialTranspose", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["RotZ",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "RotZ", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["ws",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "ws", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"]},
        {
         ButtonBox["BraY",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "BraY", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["intro",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "intro", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["ProjG",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "ProjG", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["s",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "s", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["xb",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "xb", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"]},
        {
         ButtonBox["CNOT",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "CNOT", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["j8",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "j8", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["PTr",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "PTr", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["Schmidt",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "Schmidt", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["Xb",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "Xb", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"]},
        {
         ButtonBox["Coeff",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "Coeff", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["Ket1",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "Ket1", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["PTrGen",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "PTrGen", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["Sigma0",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "Sigma0", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["xd",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "xd", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"]},
        {
         ButtonBox["Comm",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "Comm", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["KetV",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "KetV", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["Purity",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "Purity", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["Sigma1",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "Sigma1", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["Xd",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "Xd", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"]},
        {
         ButtonBox["CompMeasureKet",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "CompMeasureKet", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["KetX",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "KetX", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["PX",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "PX", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["Sigma2",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "Sigma2", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["ZeroMatrix",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "ZeroMatrix", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"]},
        {
         ButtonBox["CompPTr",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "CompPTr", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["KetY",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "KetY", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["PY",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "PY", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["Sigma3",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "Sigma3", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["ZeroT",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "ZeroT", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"]},
        {
         ButtonBox["ControlledX",
          BaseStyle->"InformationLink",
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "ControlledX", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["look",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "look", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["qubit",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "qubit", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["Snos",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "Snos", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["\[ScriptCapitalH]",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "\[ScriptCapitalH]", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"]},
        {
         ButtonBox["ControlledY",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "ControlledY", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["matrices",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "matrices", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["RandomBra1",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "RandomBra1", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["SP",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "SP", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["\[ScriptCapitalP]",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "\[ScriptCapitalP]", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"]},
        {
         ButtonBox["ControlledZ",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "ControlledZ", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["mc",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "mc", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["RandomBra2",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "RandomBra2", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["Spin",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "Spin", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["\[DoubleStruckCapitalI]",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "\[DoubleStruckCapitalI]", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"]},
        {
         ButtonBox["CPHASE",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "CPHASE", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["mcl",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "mcl", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["RandomBraN",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "RandomBraN", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["SpinObs",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "SpinObs", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["\[Rho]",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "\[Rho]", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"]},
        {
         ButtonBox["CPHASEV",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "CPHASEV", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["mcl$",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "mcl$", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["RandomKet1",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "RandomKet1", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["stA",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "stA", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["\[Rho]$",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "\[Rho]$", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"]},
        {
         ButtonBox["cRQN",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "cRQN", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["mc$",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "mc$", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["RandomKet2",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "RandomKet2", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["stB",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "stB", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["\[Sigma]",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "\[Sigma]", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"]},
        {
         ButtonBox["Definef",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "Definef", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["MeasureKet",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "MeasureKet", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["RandomKetN",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "RandomKetN", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["Swap",
          BaseStyle->"InformationLink",
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "Swap", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["\[Phi]A1",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "\[Phi]A1", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"]},
        {
         ButtonBox["density",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "density", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["MultiProjCBasis",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "MultiProjCBasis", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["RandomQubit1",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "RandomQubit1", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["s$",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "s$", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["\[Phi]A2",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "\[Phi]A2", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"]},
        {
         ButtonBox["DForm2",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "DForm2", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["MultiQProj",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "MultiQProj", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["RandomQubit2",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "RandomQubit2", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["TensorProductQ",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "TensorProductQ", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["\[Phi]B1",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "\[Phi]B1", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"]},
        {
         ButtonBox["Discord",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "Discord", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["Mutual",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "Mutual", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["RandomQubitN",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "RandomQubitN", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["ThreeOp",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "ThreeOp", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["\[Phi]B2",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "\[Phi]B2", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"]},
        {
         ButtonBox["EnTropy",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "EnTropy", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["nb",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "nb", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["rcsDate",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "rcsDate", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["to",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "to", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["\[CapitalOmega]s",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "\[CapitalOmega]s", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"]},
        {
         ButtonBox["EnTropy2",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "EnTropy2", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["neg",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "neg", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["rcsRevision",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "rcsRevision", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["Toffoli",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "Toffoli", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], ""},
        {
         ButtonBox["Fidelity",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "Fidelity", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["nneg",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "nneg", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["res1",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "res1", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], 
         ButtonBox["ts",
          BaseStyle->"InformationLink",
          
          ButtonData:>{
           "Info-550f2b6c-5056-4caf-be6e-1a4bf3938d84", {
            "ts", "QDENSITY`Qdensity`"}},
          ButtonNote->"QDENSITY`Qdensity`"], ""}
       },
       DefaultBaseStyle->"InfoGrid",
       GridBoxItemSize->{"Columns" -> {{
            Scaled[0.19]}}}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}}]}, 
   Dynamic[Typeset`open$$],
   ImageSize->Automatic]]], "Print", "InfoCell",
 CellChangeTimes->{3.669974229691983*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["My extra definitions", "Subsection",
 CellChangeTimes->{{3.66962218750191*^9, 3.669622192364294*^9}}],

Cell["\<\
Useful functions for easily constructing multi-qubit matrices - lets you \
specify any two qubit matrix, as opposed to only Pauli matrices\
\>", "Text",
 CellChangeTimes->{{3.669620346706481*^9, 3.6696203611613007`*^9}, {
  3.669620659817996*^9, 3.669620681816053*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Zero2b2T", "[", "L_", "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"IdentityMatrix", "[", "2", "]"}], ",", 
    RowBox[{"{", "L", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.669620141798723*^9, 3.669620209856435*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"OneOpArb", "[", 
    RowBox[{"L_", ",", " ", "q1_", ",", " ", "op1_"}], "]"}], " ", ":=", " ", 
   RowBox[{"SPArb", "[", 
    RowBox[{"L", ",", " ", 
     RowBox[{"ReplacePart", "[", 
      RowBox[{
       RowBox[{"Zero2b2T", "[", "L", "]"}], ",", " ", "op1", ",", " ", "q1"}],
       "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6696206486509047`*^9, 3.669620657672801*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TwoOpArb", "[", 
    RowBox[{"L_", ",", "q1_", ",", "q2_", ",", "op1_", ",", "op2_"}], "]"}], ":=", 
   RowBox[{"SPArb", "[", 
    RowBox[{"L", ",", 
     RowBox[{"ReplacePart", "[", 
      RowBox[{
       RowBox[{"ReplacePart", "[", 
        RowBox[{
         RowBox[{"Zero2b2T", "[", "L", "]"}], ",", "op1", ",", "q1"}], "]"}], 
       ",", "op2", ",", "q2"}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.669620109717997*^9, 3.669620111886518*^9}, {
  3.669620228252377*^9, 3.6696202529279137`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SPArb", "[", 
    RowBox[{"L_", ",", " ", "Q_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"SP", "[", 
     RowBox[{"L", ",", " ", "Q"}], "]"}], " ", "=", " ", 
    RowBox[{"If", " ", "[", 
     RowBox[{
      RowBox[{"L", " ", ">", " ", "1"}], ",", " ", 
      RowBox[{"TensorProductQ", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"SPArb", "[", 
          RowBox[{
           RowBox[{"L", " ", "-", " ", "1"}], ",", 
           RowBox[{"Drop", "[", 
            RowBox[{"Q", ",", 
             RowBox[{"-", "1"}]}], "]"}]}], "]"}], ",", 
         RowBox[{"Q", "[", 
          RowBox[{"[", "L", "]"}], "]"}]}], "}"}], "]"}], ",", 
      RowBox[{"Q", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.669619100485627*^9, {3.66962006503498*^9, 3.66962008092552*^9}, {
   3.669620239145608*^9, 3.669620243080225*^9}}],

Cell["\<\
E.g. To show it works, quickly make a CNOT between qubits 1 and 3\
\>", "Text",
 CellChangeTimes->{{3.66962036996861*^9, 3.669620380656255*^9}, {
  3.6696204971059637`*^9, 3.6696204995619392`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"CNOT", "[", 
   RowBox[{"3", ",", "1", ",", "3"}], "]"}], "==", 
  RowBox[{
   RowBox[{"TwoOpArb", "[", 
    RowBox[{"3", ",", "1", ",", "3", ",", 
     SubscriptBox["\[ScriptCapitalP]", "0"], ",", 
     SubscriptBox["\[Sigma]", "0"]}], "]"}], "+", 
   RowBox[{"TwoOpArb", "[", 
    RowBox[{"3", ",", "1", ",", "3", ",", 
     SubscriptBox["\[ScriptCapitalP]", "1"], ",", 
     SubscriptBox["\[Sigma]", "1"]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.669620269448163*^9, 3.669620324595374*^9}, {
  3.669620383041728*^9, 3.669620387872718*^9}, {3.669620462858924*^9, 
  3.669620511065439*^9}}],

Cell[BoxData[
 TagBox["True",
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6696203053274393`*^9, 3.669620324992613*^9}, 
   3.669620390369265*^9, {3.669620491134309*^9, 3.669620511426423*^9}, 
   3.669659228506114*^9, 3.6699742301130867`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Single qubit gates", "Subsection",
 CellChangeTimes->{{3.6253825232581577`*^9, 3.625382525948211*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Definition", " ", "of", " ", "single", " ", "spin", " ", "rotations", " ",
     "using", " ", "the", " ", "qdensity", " ", "package", 
    "\[IndentingNewLine]", 
    RowBox[{"Nomenclature", ":", "  ", 
     RowBox[{
      RowBox[{"r", " ", "followed", " ", "by", " ", "a", " ", "capital", " ", 
       RowBox[{"letter", " ", "--"}]}], ">", " ", 
      RowBox[{
      "rotation", " ", "by", " ", "\[Pi]", " ", "around", " ", "the", " ", 
       "axis", " ", "specified", " ", "by", " ", "the", " ", 
       RowBox[{"letter", ".", "\[IndentingNewLine]", "\t\t\t", "r"}], " ", 
       "followed", " ", "by", " ", "a", " ", "lower", " ", "case", " ", 
       "letter"}]}], ":", " ", 
     RowBox[{"rotation", " ", "by", " ", 
      RowBox[{"\[Pi]", "/", "2"}], " ", "around", " ", "the", " ", "axis", 
      " ", "specified", " ", "by", " ", "that", " ", "letter", 
      "\[IndentingNewLine]", "The", " ", "rotation", " ", "direction", " ", 
      "is", " ", "given", " ", "by", " ", "the", " ", "appended", " ", 
      "letter", " ", "m", " ", "or", " ", "p"}]}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "rxp", ",", "rXp", ",", "ryp", ",", "rYp", ",", "rzp", ",", "rZp"}], 
      "}"}], "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"AF", "[", 
        RowBox[{"MatrixExp", "[", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], "*", 
          SubscriptBox["\[Sigma]", 
           RowBox[{
            RowBox[{"Floor", "[", 
             RowBox[{
              RowBox[{"j", "/", "2"}], "-", "0.01"}], "]"}], "+", "1"}]], "*", 
          RowBox[{"\[Pi]", "/", 
           RowBox[{"(", 
            RowBox[{"2", "*", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"Mod", "[", 
                RowBox[{"j", ",", "2"}], "]"}]}], ")"}]}], ")"}]}]}], "]"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "rxm", ",", "rXm", ",", "rym", ",", "rYm", ",", "rzm", ",", "rZm"}], 
      "}"}], "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"AF", "[", 
        RowBox[{"MatrixExp", "[", 
         RowBox[{"\[ImaginaryI]", "*", 
          SubscriptBox["\[Sigma]", 
           RowBox[{
            RowBox[{"Floor", "[", 
             RowBox[{
              RowBox[{"j", "/", "2"}], "-", "0.01"}], "]"}], "+", "1"}]], "*", 
          RowBox[{"\[Pi]", "/", 
           RowBox[{"(", 
            RowBox[{"2", "*", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"Mod", "[", 
                RowBox[{"j", ",", "2"}], "]"}]}], ")"}]}], ")"}]}]}], "]"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "6"}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6253825423585396`*^9, 3.6253827022427373`*^9}, {
   3.625382734303378*^9, 3.625382934497382*^9}, {3.625383067510042*^9, 
   3.625383180183296*^9}, {3.6253833170660334`*^9, 3.625383321436121*^9}, {
   3.6253833557968082`*^9, 3.625383395257597*^9}, {3.625383441208516*^9, 
   3.625383456938831*^9}, 3.6254002924707193`*^9, {3.6254025285095654`*^9, 
   3.6254026176425657`*^9}, {3.6254648143872457`*^9, 3.625465144503848*^9}, {
   3.6254652474355307`*^9, 3.6254653002160587`*^9}, {3.6254653496075525`*^9, 
   3.6254653544276004`*^9}, {3.6254765225810413`*^9, 3.62547654041122*^9}, {
   3.6260849283733234`*^9, 3.626084936943409*^9}, {3.669616603318604*^9, 
   3.669616625730185*^9}, 3.669624019274583*^9, {3.669637023488163*^9, 
   3.669637035155864*^9}, {3.6699787860400963`*^9, 3.669978821820661*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Controlled qubit gates", "Subsection",
 CellChangeTimes->{{3.6253831931135545`*^9, 3.6253831965336227`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"When", " ", "experimenting", " ", 
     SuperscriptBox[
      RowBox[{"with", " "}], "13"], "C", " ", "spins", " ", "we", " ", 
     "currently", " ", "have", " ", "two", " ", "controlled", " ", "gates", 
     " ", "in", " ", "our", " ", 
     RowBox[{"toolset", ".", " ", "The"}]}], " ", "\[PlusMinus]", 
    RowBox[{"x", " ", "gate", " ", "and", " ", "the"}]}], " ", "\[PlusMinus]", 
   RowBox[{"y", " ", "gate", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
      "difference", " ", "is", " ", "effectively", " ", "given", " ", "by", 
       " ", "a", " ", "phaseshift"}], ")"}], ".", "\[IndentingNewLine]", 
     "These"}], " ", "can", " ", "be", " ", "modelled", " ", "by", " ", 
    "composite", " ", "actions", " ", "depending", " ", "on", " ", "the", " ",
     "projectors", " ", 
    SubscriptBox["\[ScriptCapitalP]", "0"], " ", "and", " ", 
    SubscriptBox["\[ScriptCapitalP]", "1"], " ", "for", " ", "the", " ", 
    "electronic", " ", "state"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.6253832251641955`*^9, 3.625383264554983*^9}, {
  3.6253834631489553`*^9, 3.6253835559699893`*^9}, {3.6253836057399893`*^9, 
  3.6253836334999895`*^9}, {3.6254003073531*^9, 3.625400323085617*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gmx", "=", 
   RowBox[{"AF", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[ScriptCapitalP]", "0"], "\[TensorProduct]", "rxp"}], 
     "+", 
     RowBox[{
      SubscriptBox["\[ScriptCapitalP]", "1"], "\[TensorProduct]", "rxm"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gmy", "=", 
   RowBox[{"AF", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[ScriptCapitalP]", "0"], "\[TensorProduct]", "ryp"}], 
     "+", 
     RowBox[{
      SubscriptBox["\[ScriptCapitalP]", "1"], "\[TensorProduct]", "rym"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.625383595679989*^9, 3.6253836004899893`*^9}, {
  3.6253836381999893`*^9, 3.6253837006539893`*^9}, {3.669616632082355*^9, 
  3.6696166393776703`*^9}, {3.6696171821048927`*^9, 3.66961719078232*^9}, {
  3.669622208415369*^9, 3.66962221557265*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "controlled", " ", "gates", " ", "generator", " ", "for", " ", "multiple",
      " ", "qubits"}], ",", " ", 
    RowBox[{
    "the", " ", "phase", " ", "results", " ", "in", " ", "a", " ", "phase", 
     " ", "gate", " ", "on", " ", "the", " ", "desired", " ", "qubit", " ", 
     "prior", " ", "to", " ", "the", " ", "gate", " ", "application"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"gmxMulti", "[", 
    RowBox[{
    "NoOfBits_", ",", "controlBit_", ",", "addressedBit_", ",", "\[Theta]_"}],
     "]"}], ":=", 
   RowBox[{
    RowBox[{"OneOpArb", "[", 
     RowBox[{"NoOfBits", ",", "addressedBit", ",", 
      RowBox[{"MatrixExp", "[", 
       RowBox[{"\[ImaginaryI]", " ", 
        SubscriptBox["\[Sigma]", "3"], 
        RowBox[{"\[Theta]", "/", "2"}]}], "]"}]}], "]"}], ".", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"TwoOpArb", "[", 
       RowBox[{"NoOfBits", ",", "controlBit", ",", "addressedBit", ",", 
        SubscriptBox["\[ScriptCapitalP]", "0"], ",", "rxp"}], "]"}], "+", 
      RowBox[{"TwoOpArb", "[", 
       RowBox[{"NoOfBits", ",", "controlBit", ",", "addressedBit", ",", 
        SubscriptBox["\[ScriptCapitalP]", "1"], ",", "rxm"}], "]"}]}], ")"}], 
    ".", 
    RowBox[{"OneOpArb", "[", 
     RowBox[{"NoOfBits", ",", "addressedBit", ",", 
      RowBox[{"MatrixExp", "[", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", 
        SubscriptBox["\[Sigma]", "3"], 
        RowBox[{"\[Theta]", "/", "2"}]}], "]"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.625404511479401*^9, 3.625404689094246*^9}, {
   3.625404721144887*^9, 3.6254047955163746`*^9}, {3.6254048312070885`*^9, 
   3.6254051400248675`*^9}, {3.625405183055298*^9, 3.625405184945317*^9}, {
   3.6254052175056424`*^9, 3.62540550485252*^9}, {3.625405622034692*^9, 
   3.6254056391548634`*^9}, {3.6254056777652493`*^9, 
   3.6254056944954166`*^9}, {3.6254063327168856`*^9, 3.625406339786956*^9}, {
   3.625406432699936*^9, 3.625406496588586*^9}, {3.6254746662088575`*^9, 
   3.6254746965002174`*^9}, 3.6306522352241096`*^9, {3.669617416509128*^9, 
   3.6696174406700087`*^9}, {3.669620955112088*^9, 3.669621000677031*^9}, {
   3.6696210453436613`*^9, 3.6696210487812777`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Testing", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"gmxMulti", "[", 
   RowBox[{"2", ",", "1", ",", "2", ",", "0"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.625405033831804*^9, 3.625405071544183*^9}, {
  3.6254051145046124`*^9, 3.6254051210246773`*^9}, {3.6254051522049894`*^9, 
  3.625405152874996*^9}, {3.6254053999674673`*^9, 3.625405414751619*^9}, {
  3.6254055199326706`*^9, 3.62540554187289*^9}, {3.625405649424966*^9, 
  3.6254056496049676`*^9}, {3.669524559475924*^9, 3.6695245634439387`*^9}, {
  3.6695251242884665`*^9, 3.6695251243854723`*^9}, {3.669617570194447*^9, 
  3.669617633350617*^9}, {3.669620925569137*^9, 3.669620940602983*^9}, {
  3.6696210522522793`*^9, 3.669621061418899*^9}, {3.669621102393118*^9, 
  3.6696211125794563`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        SqrtBox["2"]]}], "0", "0"},
     {
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        SqrtBox["2"]]}], 
      FractionBox["1", 
       SqrtBox["2"]], "0", "0"},
     {"0", "0", 
      FractionBox["1", 
       SqrtBox["2"]], 
      FractionBox["\[ImaginaryI]", 
       SqrtBox["2"]]},
     {"0", "0", 
      FractionBox["\[ImaginaryI]", 
       SqrtBox["2"]], 
      FractionBox["1", 
       SqrtBox["2"]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6254051433049*^9, 3.6254051531949997`*^9}, {
   3.625405396597433*^9, 3.62540545483202*^9}, {3.6254055084025555`*^9, 
   3.625405542392895*^9}, {3.6254056288047595`*^9, 3.625405650124973*^9}, 
   3.6254057003254747`*^9, 3.625406342088981*^9, 3.6254577575165763`*^9, 
   3.625468343379348*^9, 3.6254746992465305`*^9, {3.625483524647035*^9, 
   3.6254835479433646`*^9}, 3.625486336210578*^9, 3.6254866789128447`*^9, 
   3.6255649783257523`*^9, 3.625575165456239*^9, 3.6256442900509863`*^9, 
   3.6256443510315957`*^9, 3.6256475676148224`*^9, 3.6256508018875923`*^9, 
   3.6256512593021708`*^9, 3.6256516153248205`*^9, 3.625651977773735*^9, 
   3.6256520795847535`*^9, 3.625653271081724*^9, 3.6256538638051996`*^9, 
   3.6258077874936047`*^9, 3.62581580441855*^9, 3.625815960161665*^9, {
   3.625832941671501*^9, 3.6258329630807824`*^9}, 3.625919889911167*^9, 
   3.6259869741286173`*^9, 3.627194269014644*^9, 3.629632317169182*^9, 
   3.6296354206309185`*^9, {3.629636810210862*^9, 3.6296368360624475`*^9}, 
   3.62969479192599*^9, 3.629695101130908*^9, 3.630644650078563*^9, 
   3.6326284718019333`*^9, 3.638690485670994*^9, 3.6394620006139927`*^9, 
   3.6399056715114126`*^9, 3.669524682095871*^9, 3.669525124800496*^9, 
   3.6696144004766283`*^9, {3.669617427072337*^9, 3.66961744279395*^9}, {
   3.669617571041295*^9, 3.66961763377038*^9}, {3.669620941097107*^9, 
   3.669620962123989*^9}, {3.6696210329016743`*^9, 3.669621062048336*^9}, {
   3.669621103992495*^9, 3.669621112922245*^9}, 3.669659229197796*^9, 
   3.6699742304988327`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Initialisation", "Section",
 CellChangeTimes->{{3.669622251132554*^9, 3.669622257698867*^9}}],

Cell[CellGroupData[{

Cell["MBI", "Subsection",
 CellChangeTimes->{{3.669632448001319*^9, 3.6696324492310534`*^9}}],

Cell["First lets check that MBI works:", "Text",
 CellChangeTimes->{{3.669550283007002*^9, 3.6695502891328917`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"MBI", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"KP", "[", 
       RowBox[{"rxm", ",", "\[DoubleStruckCapitalI]"}], "]"}], ".", "gmx", 
      ".", 
      RowBox[{"KP", "[", 
       RowBox[{"ryp", ",", "\[DoubleStruckCapitalI]"}], "]"}]}], "]"}]}], 
   ")"}], "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.669549485387401*^9, 3.6695494989765673`*^9}, {
   3.669549638282818*^9, 3.6695497169637947`*^9}, {3.669549904216035*^9, 
   3.669549920744253*^9}, 3.669614269823135*^9, {3.669622335617751*^9, 
   3.669622394105411*^9}, {3.669622494415968*^9, 3.669622509136952*^9}, {
   3.669622714986388*^9, 3.669622715127721*^9}, {3.66962276840306*^9, 
   3.669622769456163*^9}, {3.669622806437297*^9, 3.669622806675161*^9}, {
   3.6696233432497787`*^9, 3.669623343384551*^9}}],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[2.0999999999999996`]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   Function[BoxForm`e$, 
    TableForm[BoxForm`e$]]],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.669549502745124*^9, {3.66954964141791*^9, 3.669549645034443*^9}, {
   3.669549678238689*^9, 3.669549717361711*^9}, {3.669549923816741*^9, 
   3.669549941212658*^9}, 3.6695503122462*^9, {3.669614281469227*^9, 
   3.669614293749055*^9}, {3.669622502926407*^9, 3.669622509636566*^9}, 
   3.669622552559634*^9, 3.669622716723955*^9, 3.6696228069679728`*^9, 
   3.669623350227682*^9, 3.669659229244726*^9, 3.669974230526582*^9}]
}, Open  ]],

Cell["\<\
Start with carbon in mixed state, electron in 0. Model by looking at outcomes \
for if carbon was in x, or was in -x\
\>", "Text",
 CellChangeTimes->{{3.669623482022566*^9, 3.669623509059801*^9}, {
  3.669623597887919*^9, 3.669623626261105*^9}, {3.669623698442271*^9, 
  3.6696237157766857`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"KP", "[", 
     RowBox[{"\[DoubleStruckCapitalI]", ",", "rym"}], "]"}], ".", "MBI", ".", 
    RowBox[{"KP", "[", 
     RowBox[{"\[DoubleStruckCapitalI]", ",", "ryp"}], "]"}], ".", 
    RowBox[{"{", 
     RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}]}], "//", "Simplify"}],
   " ", 
  RowBox[{"(*", 
   RowBox[{"Carbon", " ", "was", " ", "in", " ", "x"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KP", "[", 
    RowBox[{"\[DoubleStruckCapitalI]", ",", "rym"}], "]"}], ".", "MBI", ".", 
   RowBox[{"KP", "[", 
    RowBox[{"\[DoubleStruckCapitalI]", ",", "ryp"}], "]"}], ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}]}], "//", "Simplify", 
  " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Carbon", " ", "was", " ", "in"}], " ", "-", "x"}], " ", 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.669549720164712*^9, 3.6695497519529333`*^9}, {
  3.669550025929309*^9, 3.669550044864099*^9}, {3.669550192677483*^9, 
  3.66955022161725*^9}, {3.66955031662764*^9, 3.669550316970945*^9}, {
  3.669622687553974*^9, 3.669622700210937*^9}, {3.669623104973867*^9, 
  3.669623105427079*^9}, {3.669623510845079*^9, 3.6696235764272413`*^9}, {
  3.669623686258379*^9, 3.66962368864931*^9}, {3.669623758680971*^9, 
  3.6696237751695747`*^9}, {3.669623815117532*^9, 3.669623832124831*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"0"},
      {"0"},
      {
       FractionBox[
        RowBox[{"1", "+", "\[ImaginaryI]"}], 
        SqrtBox["2"]]},
      {"0"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.669549725970447*^9, 3.669549752234888*^9}, 
   3.6695499422667103`*^9, {3.669550035250153*^9, 3.6695500450764847`*^9}, {
   3.669550205631736*^9, 3.669550227999642*^9}, {3.669550314083885*^9, 
   3.669550317307692*^9}, {3.669614281523703*^9, 3.669614293795752*^9}, {
   3.669622689187932*^9, 3.669622717726757*^9}, 3.66962280811672*^9, 
   3.669623106007607*^9, 3.6696233539338207`*^9, 3.6696235352157393`*^9, {
   3.669623565574938*^9, 3.6696235767223577`*^9}, 3.669623689456455*^9, 
   3.669623796978181*^9, 3.6696592293458757`*^9, 3.6699742305521603`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"0"},
      {
       FractionBox[
        RowBox[{"1", "+", "\[ImaginaryI]"}], 
        SqrtBox["2"]]},
      {"0"},
      {"0"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.669549725970447*^9, 3.669549752234888*^9}, 
   3.6695499422667103`*^9, {3.669550035250153*^9, 3.6695500450764847`*^9}, {
   3.669550205631736*^9, 3.669550227999642*^9}, {3.669550314083885*^9, 
   3.669550317307692*^9}, {3.669614281523703*^9, 3.669614293795752*^9}, {
   3.669622689187932*^9, 3.669622717726757*^9}, 3.66962280811672*^9, 
   3.669623106007607*^9, 3.6696233539338207`*^9, 3.6696235352157393`*^9, {
   3.669623565574938*^9, 3.6696235767223577`*^9}, 3.669623689456455*^9, 
   3.669623796978181*^9, 3.6696592293458757`*^9, 3.669974230562402*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Swap", "Subsection",
 CellChangeTimes->{{3.6695513414922657`*^9, 3.6695513419135733`*^9}}],

Cell[CellGroupData[{

Cell["Into pure state", "Subsubsection",
 CellChangeTimes->{{3.669632459871253*^9, 3.669632462063285*^9}}],

Cell["\<\
Normally swap gates required three two qubit gates, but we can get away with \
two since we know the state of the electron.\
\>", "Text",
 CellChangeTimes->{{3.669632150495466*^9, 3.6696321714712667`*^9}, {
  3.66997418999727*^9, 3.669974190249649*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"Init", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"gmy", ".", 
      RowBox[{"KP", "[", 
       RowBox[{"rxm", ",", "rZp"}], "]"}], ".", "gmx", ".", 
      RowBox[{"KP", "[", 
       RowBox[{"ryp", ",", "\[DoubleStruckCapitalI]"}], "]"}]}], "]"}]}], 
   ")"}], "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.669551351211434*^9, 3.6695513563063307`*^9}, {
  3.6695514289450483`*^9, 3.669551434088723*^9}, {3.669551470511788*^9, 
  3.669551471775382*^9}, {3.6695515278933277`*^9, 3.669551536098621*^9}, {
  3.669623899655902*^9, 3.6696239513182793`*^9}, {3.669623998592238*^9, 
  3.669624008881426*^9}, {3.6696240851188726`*^9, 3.6696240857273693`*^9}, {
  3.669624177351017*^9, 3.669624180787785*^9}}],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {"0", "0", 
      RowBox[{
       FractionBox["1", "2"], "+", 
       FractionBox["\[ImaginaryI]", "2"]}], 
      RowBox[{
       FractionBox["1", "2"], "+", 
       FractionBox["\[ImaginaryI]", "2"]}]},
     {
      RowBox[{
       FractionBox["1", "2"], "-", 
       FractionBox["\[ImaginaryI]", "2"]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], "+", 
       FractionBox["\[ImaginaryI]", "2"]}], "0", "0"},
     {"0", "0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], "-", 
       FractionBox["\[ImaginaryI]", "2"]}], 
      RowBox[{
       FractionBox["1", "2"], "+", 
       FractionBox["\[ImaginaryI]", "2"]}]},
     {
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], "+", 
       FractionBox["\[ImaginaryI]", "2"]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], "+", 
       FractionBox["\[ImaginaryI]", "2"]}], "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[2.0999999999999996`]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   Function[BoxForm`e$, 
    TableForm[BoxForm`e$]]],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.669551357195266*^9, {3.669551430554223*^9, 3.669551434369624*^9}, 
   3.669551472530601*^9, {3.6695515313268957`*^9, 3.6695515366712837`*^9}, {
   3.669614281599223*^9, 3.669614293879901*^9}, 3.669623951654632*^9, 
   3.6696240863596363`*^9, {3.669624177791376*^9, 3.6696241811446753`*^9}, 
   3.6696242975221443`*^9, 3.669633119468408*^9, 3.669659229413609*^9, 
   3.669974230584908*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"swapSt", "=", 
  RowBox[{"Init", ".", 
   RowBox[{"AF", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[ScriptCapitalP]", "0"], "\[TensorProduct]", 
      "\[DoubleStruckCapitalI]"}], "/", "2"}], "]"}], ".", 
   RowBox[{"Init", "\[ConjugateTranspose]"}]}]}]], "Input",
 CellChangeTimes->{{3.669632036484429*^9, 3.669632084283647*^9}, {
  3.669632186845118*^9, 3.669632186961656*^9}, {3.6696330864689903`*^9, 
  3.669633102715734*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", 
      FractionBox["1", "2"], "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox["1", "2"]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.669632011218514*^9, 3.669632084828965*^9}, {
   3.6696330885562563`*^9, 3.669633120685629*^9}, 3.669659229462205*^9, 
   3.669974230607629*^9}]
}, Open  ]],

Cell["No matter which state the carbon is in, it ends up in 1.", "Text",
 CellChangeTimes->{{3.669632119236032*^9, 3.669632123458358*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PTr", "[", 
  RowBox[{
   RowBox[{"{", "1", "}"}], ",", "swapSt"}], "]"}]], "Input",
 CellChangeTimes->{{3.669631719701686*^9, 3.669631720430561*^9}, {
   3.669631755868639*^9, 3.669631761772963*^9}, {3.669631814809135*^9, 
   3.669631825904936*^9}, {3.669631857567384*^9, 3.669631872671237*^9}, {
   3.669631906144762*^9, 3.669631940126051*^9}, 3.6696320716645527`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0"},
     {"0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.669631762528851*^9, {3.669631819405652*^9, 3.669631826172798*^9}, 
   3.669631941220171*^9, 3.669632072426955*^9, 3.6696321081317472`*^9, {
   3.6696331129589157`*^9, 3.669633122839199*^9}, 3.669659229510633*^9, 
   3.669974230629224*^9}]
}, Open  ]],

Cell["The electron ends up in a mixed state", "Text",
 CellChangeTimes->{{3.669632128831422*^9, 3.669632134896487*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PTr", "[", 
  RowBox[{
   RowBox[{"{", "2", "}"}], ",", "swapSt"}], "]"}]], "Input",
 CellChangeTimes->{{3.669631719701686*^9, 3.669631720430561*^9}, {
   3.669631755868639*^9, 3.669631761772963*^9}, {3.669631814809135*^9, 
   3.669631825904936*^9}, {3.669631857567384*^9, 3.669631872671237*^9}, {
   3.669631906144762*^9, 3.669631940126051*^9}, 3.6696320716645527`*^9, {
   3.669632141793559*^9, 3.669632141904047*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", "2"], "0"},
     {"0", 
      FractionBox["1", "2"]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.669631762528851*^9, {3.669631819405652*^9, 3.669631826172798*^9}, 
   3.669631941220171*^9, 3.669632072426955*^9, 3.6696321081317472`*^9, 
   3.669632142867156*^9, {3.6696331162503767`*^9, 3.669633125442336*^9}, 
   3.669659229563519*^9, 3.6699742306571074`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Into mixed state", "Subsubsection",
 CellChangeTimes->{{3.669632465974104*^9, 3.66963246793504*^9}}],

Cell["This is one way with two gates", "Text",
 CellChangeTimes->{{3.669633351255826*^9, 3.669633355039921*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"InitMixed", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"gmy", ".", 
      RowBox[{"KP", "[", 
       RowBox[{"rxm", ",", "rZp"}], "]"}], ".", "gmx"}], "]"}]}], ")"}], "//",
   "TableForm"}]], "Input",
 CellChangeTimes->{{3.669551351211434*^9, 3.6695513563063307`*^9}, {
  3.6695514289450483`*^9, 3.669551434088723*^9}, {3.669551470511788*^9, 
  3.669551471775382*^9}, {3.6695515278933277`*^9, 3.669551536098621*^9}, {
  3.669623899655902*^9, 3.6696239513182793`*^9}, {3.669623998592238*^9, 
  3.669624008881426*^9}, {3.6696240851188726`*^9, 3.6696240857273693`*^9}, {
  3.669624177351017*^9, 3.669624180787785*^9}, {3.669632527317205*^9, 
  3.669632548651759*^9}}],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]]},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[2.0999999999999996`]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   Function[BoxForm`e$, 
    TableForm[BoxForm`e$]]],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.669551357195266*^9, {3.669551430554223*^9, 3.669551434369624*^9}, 
   3.669551472530601*^9, {3.6695515313268957`*^9, 3.6695515366712837`*^9}, {
   3.669614281599223*^9, 3.669614293879901*^9}, 3.669623951654632*^9, 
   3.6696240863596363`*^9, {3.669624177791376*^9, 3.6696241811446753`*^9}, 
   3.6696242975221443`*^9, {3.6696325282907476`*^9, 3.6696325571734037`*^9}, 
   3.669633151551806*^9, 3.669659229611784*^9, 3.6699742306835737`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"swapMixed", "=", 
  RowBox[{"InitMixed", ".", 
   RowBox[{"AF", "[", 
    RowBox[{
     SubscriptBox["\[ScriptCapitalP]", "0"], "\[TensorProduct]", 
     SubscriptBox["\[ScriptCapitalP]", "0"]}], "]"}], ".", 
   RowBox[{"InitMixed", "\[ConjugateTranspose]"}]}]}]], "Input",
 CellChangeTimes->{{3.669632036484429*^9, 3.669632084283647*^9}, {
  3.669632186845118*^9, 3.669632186961656*^9}, {3.669632541884839*^9, 
  3.669632552216116*^9}, {3.669633079527823*^9, 3.6696330812692003`*^9}, {
  3.669633514321262*^9, 3.669633520699791*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", "4"], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "4"]}], 
      RowBox[{"-", 
       FractionBox["1", "4"]}], 
      FractionBox["\[ImaginaryI]", "4"]},
     {
      FractionBox["\[ImaginaryI]", "4"], 
      FractionBox["1", "4"], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "4"]}], 
      RowBox[{"-", 
       FractionBox["1", "4"]}]},
     {
      RowBox[{"-", 
       FractionBox["1", "4"]}], 
      FractionBox["\[ImaginaryI]", "4"], 
      FractionBox["1", "4"], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "4"]}]},
     {
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "4"]}], 
      RowBox[{"-", 
       FractionBox["1", "4"]}], 
      FractionBox["\[ImaginaryI]", "4"], 
      FractionBox["1", "4"]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.669632011218514*^9, 3.669632084828965*^9}, {
   3.669632533148361*^9, 3.669632558239253*^9}, 3.669633081560198*^9, {
   3.6696331435919533`*^9, 3.66963315281886*^9}, 3.669633521093115*^9, 
   3.6696592296627398`*^9, 3.6699742307070637`*^9}]
}, Open  ]],

Cell["The carbon and electron end up in mixed states", "Text",
 CellChangeTimes->{{3.669632128831422*^9, 3.669632134896487*^9}, {
  3.669632578069141*^9, 3.669632586826715*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PTr", "[", 
  RowBox[{
   RowBox[{"{", "1", "}"}], ",", "swapMixed"}], "]"}]], "Input",
 CellChangeTimes->{{3.669631719701686*^9, 3.669631720430561*^9}, {
   3.669631755868639*^9, 3.669631761772963*^9}, {3.669631814809135*^9, 
   3.669631825904936*^9}, {3.669631857567384*^9, 3.669631872671237*^9}, {
   3.669631906144762*^9, 3.669631940126051*^9}, 3.6696320716645527`*^9, {
   3.669632554543895*^9, 3.669632574857852*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", "2"], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "2"]}]},
     {
      FractionBox["\[ImaginaryI]", "2"], 
      FractionBox["1", "2"]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.669631762528851*^9, {3.669631819405652*^9, 3.669631826172798*^9}, 
   3.669631941220171*^9, 3.669632072426955*^9, 3.6696321081317472`*^9, {
   3.6696325368163548`*^9, 3.669632559306179*^9}, {3.669633145116704*^9, 
   3.669633154677302*^9}, 3.669633522971161*^9, 3.6696592297118053`*^9, 
   3.669974230731289*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PTr", "[", 
  RowBox[{
   RowBox[{"{", "2", "}"}], ",", "swapMixed"}], "]"}]], "Input",
 CellChangeTimes->{{3.669631719701686*^9, 3.669631720430561*^9}, {
   3.669631755868639*^9, 3.669631761772963*^9}, {3.669631814809135*^9, 
   3.669631825904936*^9}, {3.669631857567384*^9, 3.669631872671237*^9}, {
   3.669631906144762*^9, 3.669631940126051*^9}, 3.6696320716645527`*^9, {
   3.669632141793559*^9, 3.669632141904047*^9}, 3.669632555504777*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", "2"], 
      RowBox[{"-", 
       FractionBox["1", "2"]}]},
     {
      RowBox[{"-", 
       FractionBox["1", "2"]}], 
      FractionBox["1", "2"]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.669631762528851*^9, {3.669631819405652*^9, 3.669631826172798*^9}, 
   3.669631941220171*^9, 3.669632072426955*^9, 3.6696321081317472`*^9, 
   3.669632142867156*^9, 3.669632561475181*^9, {3.6696331477338448`*^9, 
   3.669633155640327*^9}, 3.669633524135079*^9, 3.669659229761796*^9, 
   3.669974230909296*^9}]
}, Open  ]],

Cell["This way seems simpler", "Text",
 CellChangeTimes->{{3.66963335978344*^9, 3.669633363375263*^9}, {
  3.669633460494446*^9, 3.669633473159189*^9}, {3.669633562925177*^9, 
  3.6696335634834423`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"InitSMixed", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"gmx", ".", 
       RowBox[{"KP", "[", 
        RowBox[{"rym", ",", "\[DoubleStruckCapitalI]"}], "]"}]}], "]"}]}], 
    ")"}], "//", "TableForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"swapSMixed", "=", 
   RowBox[{"InitSMixed", ".", 
    RowBox[{"AF", "[", 
     RowBox[{
      SubscriptBox["\[ScriptCapitalP]", "0"], "\[TensorProduct]", 
      SubscriptBox["\[ScriptCapitalP]", "0"]}], "]"}], ".", 
    RowBox[{"InitSMixed", "\[ConjugateTranspose]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"PTr", "[", 
  RowBox[{
   RowBox[{"{", "1", "}"}], ",", "swapSMixed"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"PTr", "[", 
  RowBox[{
   RowBox[{"{", "2", "}"}], ",", "swapSMixed"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"swapSMixed", "=", 
   RowBox[{"InitSMixed", ".", 
    RowBox[{"AF", "[", 
     RowBox[{
      SubscriptBox["\[ScriptCapitalP]", "0"], "\[TensorProduct]", 
      SubscriptBox["\[ScriptCapitalP]", "1"]}], "]"}], ".", 
    RowBox[{"InitSMixed", "\[ConjugateTranspose]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"PTr", "[", 
  RowBox[{
   RowBox[{"{", "1", "}"}], ",", "swapSMixed"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"PTr", "[", 
  RowBox[{
   RowBox[{"{", "2", "}"}], ",", "swapSMixed"}], "]"}]}], "Input",
 CellChangeTimes->{{3.669551351211434*^9, 3.6695513563063307`*^9}, {
  3.6695514289450483`*^9, 3.669551434088723*^9}, {3.669551470511788*^9, 
  3.669551471775382*^9}, {3.6695515278933277`*^9, 3.669551536098621*^9}, {
  3.669623899655902*^9, 3.6696239513182793`*^9}, {3.669623998592238*^9, 
  3.669624008881426*^9}, {3.6696240851188726`*^9, 3.6696240857273693`*^9}, {
  3.669624177351017*^9, 3.669624180787785*^9}, {3.669632527317205*^9, 
  3.669632548651759*^9}, {3.6696330432788258`*^9, 3.669633077654191*^9}, {
  3.669633162987309*^9, 3.6696332282917147`*^9}, {3.669633266340159*^9, 
  3.669633309213871*^9}, {3.6696333758184643`*^9, 3.669633393569824*^9}, {
  3.669633539336087*^9, 3.6696336017260733`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", "2"], "0"},
     {"0", 
      FractionBox["1", "2"]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.669633048448235*^9, {3.669633171693323*^9, 3.6696331926798973`*^9}, {
   3.669633288067474*^9, 3.669633311419932*^9}, {3.669633379719754*^9, 
   3.669633400073658*^9}, {3.6696335443299503`*^9, 3.669633553404134*^9}, {
   3.669633585435418*^9, 3.669633602013521*^9}, 3.669659229812387*^9, 
   3.669974230933771*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", "2"], "0"},
     {"0", 
      FractionBox["1", "2"]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.669633048448235*^9, {3.669633171693323*^9, 3.6696331926798973`*^9}, {
   3.669633288067474*^9, 3.669633311419932*^9}, {3.669633379719754*^9, 
   3.669633400073658*^9}, {3.6696335443299503`*^9, 3.669633553404134*^9}, {
   3.669633585435418*^9, 3.669633602013521*^9}, 3.669659229812387*^9, 
   3.66997423094311*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", "2"], "0"},
     {"0", 
      FractionBox["1", "2"]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.669633048448235*^9, {3.669633171693323*^9, 3.6696331926798973`*^9}, {
   3.669633288067474*^9, 3.669633311419932*^9}, {3.669633379719754*^9, 
   3.669633400073658*^9}, {3.6696335443299503`*^9, 3.669633553404134*^9}, {
   3.669633585435418*^9, 3.669633602013521*^9}, 3.669659229812387*^9, 
   3.6699742309515533`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", "2"], "0"},
     {"0", 
      FractionBox["1", "2"]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.669633048448235*^9, {3.669633171693323*^9, 3.6696331926798973`*^9}, {
   3.669633288067474*^9, 3.669633311419932*^9}, {3.669633379719754*^9, 
   3.669633400073658*^9}, {3.6696335443299503`*^9, 3.669633553404134*^9}, {
   3.669633585435418*^9, 3.669633602013521*^9}, 3.669659229812387*^9, 
   3.6699742309570827`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Deriving relations", "Section",
 CellChangeTimes->{{3.6696537006567802`*^9, 3.669653701499907*^9}, {
  3.6697178995433187`*^9, 3.6697179028156357`*^9}}],

Cell[CellGroupData[{

Cell["Useful identities", "Subsection",
 CellChangeTimes->{{3.6697179049273*^9, 3.6697179065911922`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"gmx", " ", "==", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"\[Pi]", "/", "4"}]}]], 
   RowBox[{
    RowBox[{"KP", "[", 
     RowBox[{"rzp", ",", "rxp"}], "]"}], ".", 
    RowBox[{"CNOT", "[", 
     RowBox[{"2", ",", "1", ",", "2"}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"gmy", "==", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"\[Pi]", "/", "4"}]}]], 
   RowBox[{
    RowBox[{"KP", "[", 
     RowBox[{"rzp", ",", 
      RowBox[{"rzp", ".", "rxp"}]}], "]"}], ".", 
    RowBox[{"CNOT", "[", 
     RowBox[{"2", ",", "1", ",", "2"}], "]"}], ".", 
    RowBox[{"KP", "[", 
     RowBox[{"\[DoubleStruckCapitalI]", ",", "rzm"}], 
     "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"gmy", "==", 
  RowBox[{
   RowBox[{"KP", "[", 
    RowBox[{"\[DoubleStruckCapitalI]", ",", "rzp"}], "]"}], ".", "gmx", ".", 
   RowBox[{"KP", "[", 
    RowBox[{"\[DoubleStruckCapitalI]", ",", "rzm"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CNOT", "[", 
   RowBox[{"2", ",", "1", ",", "2"}], "]"}], "\[Equal]", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", 
     RowBox[{"\[Pi]", "/", "4"}]}]], 
   RowBox[{
    RowBox[{"KP", "[", 
     RowBox[{"rzm", ",", 
      RowBox[{"rxm", ".", "rzm"}]}], "]"}], ".", "gmy", ".", 
    RowBox[{"KP", "[", 
     RowBox[{"\[DoubleStruckCapitalI]", ",", "rzp"}], "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.66964037149607*^9, 3.669640372112306*^9}, {
  3.6696404025062447`*^9, 3.669640419224749*^9}, {3.6696404642621393`*^9, 
  3.669640475775137*^9}, {3.6696405401773767`*^9, 3.669640687672166*^9}, {
  3.669640769451476*^9, 3.669640867905224*^9}, {3.6696550993543253`*^9, 
  3.669655104199634*^9}, {3.669655943181403*^9, 3.669656114287059*^9}}],

Cell[BoxData[
 TagBox["True",
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.669640784826614*^9, 3.669640871980135*^9}, 
   3.669655104410918*^9, {3.669656002457554*^9, 3.669656069658927*^9}, {
   3.669656111002651*^9, 3.669656129340103*^9}, 3.669659229915141*^9, 
   3.669974230983142*^9}],

Cell[BoxData[
 TagBox["True",
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.669640784826614*^9, 3.669640871980135*^9}, 
   3.669655104410918*^9, {3.669656002457554*^9, 3.669656069658927*^9}, {
   3.669656111002651*^9, 3.669656129340103*^9}, 3.669659229915141*^9, 
   3.669974230992632*^9}],

Cell[BoxData[
 TagBox["True",
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.669640784826614*^9, 3.669640871980135*^9}, 
   3.669655104410918*^9, {3.669656002457554*^9, 3.669656069658927*^9}, {
   3.669656111002651*^9, 3.669656129340103*^9}, 3.669659229915141*^9, 
   3.669974230999302*^9}],

Cell[BoxData[
 TagBox["True",
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.669640784826614*^9, 3.669640871980135*^9}, 
   3.669655104410918*^9, {3.669656002457554*^9, 3.669656069658927*^9}, {
   3.669656111002651*^9, 3.669656129340103*^9}, 3.669659229915141*^9, 
   3.6699742310060987`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"had", "[", 
  RowBox[{"1", ",", "1"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"\[ImaginaryI]", " ", 
  RowBox[{"rXp", ".", "ryp"}]}]}], "Input",
 CellChangeTimes->{{3.669718225705011*^9, 3.669718261752047*^9}, {
  3.669723613164122*^9, 3.669723620584937*^9}, {3.669723667002556*^9, 
  3.6697236724929733`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", 
       SqrtBox["2"]], 
      FractionBox["1", 
       SqrtBox["2"]]},
     {
      FractionBox["1", 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox["1", 
        SqrtBox["2"]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.669718236208103*^9, 3.669718262303504*^9}, {
   3.6697236161693497`*^9, 3.669723620907652*^9}, {3.669723670106382*^9, 
   3.669723672759115*^9}, 3.669974231030929*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", 
       SqrtBox["2"]], 
      FractionBox["1", 
       SqrtBox["2"]]},
     {
      FractionBox["1", 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox["1", 
        SqrtBox["2"]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.669718236208103*^9, 3.669718262303504*^9}, {
   3.6697236161693497`*^9, 3.669723620907652*^9}, {3.669723670106382*^9, 
   3.669723672759115*^9}, 3.6699742310401773`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"-", "1"}], 
  RowBox[{
  "rXp", ".", "ryp", ".", "rXp"}]}], "\[IndentingNewLine]", "rym"}], "Input",
 CellChangeTimes->{{3.6697237331534967`*^9, 3.669723778171855*^9}, {
  3.669723824124914*^9, 3.6697238456218967`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", 
       SqrtBox["2"]], 
      FractionBox["1", 
       SqrtBox["2"]]},
     {
      RowBox[{"-", 
       FractionBox["1", 
        SqrtBox["2"]]}], 
      FractionBox["1", 
       SqrtBox["2"]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6697237388859663`*^9, 3.669723778431617*^9}, {
   3.669723825184094*^9, 3.66972384590012*^9}, 3.6699742310629187`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", 
       SqrtBox["2"]], 
      FractionBox["1", 
       SqrtBox["2"]]},
     {
      RowBox[{"-", 
       FractionBox["1", 
        SqrtBox["2"]]}], 
      FractionBox["1", 
       SqrtBox["2"]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6697237388859663`*^9, 3.669723778431617*^9}, {
   3.669723825184094*^9, 3.66972384590012*^9}, 3.6699742310754833`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Make a swap", "Subsection",
 CellChangeTimes->{{3.6697179152543697`*^9, 3.669717918478917*^9}}],

Cell[CellGroupData[{

Cell["Simplify if we know that electron in 0", "Subsubsection",
 CellChangeTimes->{{3.6696590382362843`*^9, 3.66965904654741*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"(", 
   RowBox[{"Init", "=", 
    RowBox[{"Simplify", "[", " ", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", 
         RowBox[{"\[Pi]", "/", "4"}]}]]}], " ", 
      RowBox[{"gmy", ".", 
       RowBox[{"KP", "[", 
        RowBox[{"\[DoubleStruckCapitalI]", ",", "rZp"}], "]"}], ".", 
       RowBox[{"KP", "[", 
        RowBox[{"rxp", ",", "\[DoubleStruckCapitalI]"}], "]"}], ".", "gmx", 
       ".", 
       RowBox[{"KP", "[", 
        RowBox[{"ryp", ",", 
         RowBox[{"had", "[", 
          RowBox[{"1", ",", "1"}], "]"}]}], "]"}]}]}], "]"}]}], ")"}], "//", 
  "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{"Init", ".", 
  RowBox[{"{", 
   RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "0", ",", "0"}], 
   "}"}]}]}], "Input",
 CellChangeTimes->{{3.669657662164776*^9, 3.669657663863776*^9}, {
   3.669658118033746*^9, 3.669658120770422*^9}, {3.669710085970566*^9, 
   3.6697101015628557`*^9}, {3.669710157283298*^9, 3.669710218318961*^9}, {
   3.669710369693911*^9, 3.6697103698691587`*^9}, {3.6697114070051622`*^9, 
   3.6697114168365107`*^9}, {3.6697114583763037`*^9, 
   3.6697114600724077`*^9}, {3.669711649571596*^9, 3.669711649841712*^9}, {
   3.669711730945551*^9, 3.669711736632169*^9}, {3.6697118573557663`*^9, 
   3.669711918321916*^9}, 3.669714848744856*^9, {3.669715623888218*^9, 
   3.669715638543735*^9}, {3.6697156878161592`*^9, 3.669715688415296*^9}, {
   3.6697166618220663`*^9, 3.66971668542525*^9}, {3.669716722108509*^9, 
   3.669716760238901*^9}, {3.66971685755963*^9, 3.66971689338169*^9}, {
   3.6697169269930887`*^9, 3.6697169946125793`*^9}, {3.669717033776381*^9, 
   3.669717244591681*^9}}],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {"1", "0", "0", "0"},
     {"0", "0", "0", 
      RowBox[{"-", "\[ImaginaryI]"}]},
     {"0", "1", "0", "0"},
     {"0", "0", 
      RowBox[{"-", "\[ImaginaryI]"}], "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[2.0999999999999996`]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   Function[BoxForm`e$, 
    TableForm[BoxForm`e$]]],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.669658165749279*^9, 3.6696592315363913`*^9, 3.669710102383057*^9, {
   3.66971016636556*^9, 3.669710170799567*^9}, {3.669710201766171*^9, 
   3.66971021868254*^9}, 3.66971037233329*^9, 3.669711425148266*^9, 
   3.669711460563339*^9, {3.669711633623578*^9, 3.669711650265275*^9}, {
   3.669711732964386*^9, 3.669711736954018*^9}, 3.669711920005845*^9, 
   3.669714849796966*^9, {3.669715627138982*^9, 3.6697156389862833`*^9}, 
   3.6697156891108932`*^9, 3.669716686087556*^9, {3.6697167230236692`*^9, 
   3.669716760562566*^9}, 3.669716859761525*^9, 3.669716893750292*^9, {
   3.6697169284022007`*^9, 3.669716943654558*^9}, {3.669716980710721*^9, 
   3.669716994968598*^9}, {3.6697170852285137`*^9, 3.669717125689142*^9}, {
   3.669717170469211*^9, 3.6697172396715403`*^9}, 3.669717280099614*^9, 
   3.669974231111867*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"\[Alpha]"},
      {"0"},
      {"\[Beta]"},
      {"0"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.669658165749279*^9, 3.6696592315363913`*^9, 3.669710102383057*^9, {
   3.66971016636556*^9, 3.669710170799567*^9}, {3.669710201766171*^9, 
   3.66971021868254*^9}, 3.66971037233329*^9, 3.669711425148266*^9, 
   3.669711460563339*^9, {3.669711633623578*^9, 3.669711650265275*^9}, {
   3.669711732964386*^9, 3.669711736954018*^9}, 3.669711920005845*^9, 
   3.669714849796966*^9, {3.669715627138982*^9, 3.6697156389862833`*^9}, 
   3.6697156891108932`*^9, 3.669716686087556*^9, {3.6697167230236692`*^9, 
   3.669716760562566*^9}, 3.669716859761525*^9, 3.669716893750292*^9, {
   3.6697169284022007`*^9, 3.669716943654558*^9}, {3.669716980710721*^9, 
   3.669716994968598*^9}, {3.6697170852285137`*^9, 3.669717125689142*^9}, {
   3.669717170469211*^9, 3.6697172396715403`*^9}, 3.669717280099614*^9, 
   3.669974231122115*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Ok, what if we know that nucleus in 0?", "Subsubsection",
 CellChangeTimes->{{3.66965903387002*^9, 3.669659057795639*^9}, {
   3.669659869786034*^9, 3.669659872663313*^9}, {3.669659932216887*^9, 
   3.669659933190556*^9}, 3.669710072856412*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"gate1", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"\[Pi]", "/", "4"}]}]], " ", 
    RowBox[{
     RowBox[{"KP", "[", 
      RowBox[{"rym", ",", 
       RowBox[{"had", "[", 
        RowBox[{"1", ",", "1"}], "]"}]}], "]"}], ".", "gmx", ".", 
     RowBox[{"KP", "[", 
      RowBox[{"rxp", ",", "\[DoubleStruckCapitalI]"}], "]"}], ".", "gmy"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"gate1", ".", 
  RowBox[{"{", 
   RowBox[{"\[Alpha]", ",", "0", ",", "\[Beta]", ",", "0"}], 
   "}"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.669700476492588*^9, 3.6697009355456038`*^9}, {
  3.6697078388101387`*^9, 3.669707996344067*^9}, {3.669708039820607*^9, 
  3.6697081556066303`*^9}, {3.66970831586285*^9, 3.669708376879621*^9}, {
  3.669708424797471*^9, 3.6697084391961823`*^9}, {3.669708477879233*^9, 
  3.669708480484516*^9}, {3.669708523659101*^9, 3.6697086061888227`*^9}, {
  3.669708661774811*^9, 3.669708691994444*^9}, {3.669708910146452*^9, 
  3.669708924928684*^9}, {3.669716606018093*^9, 3.6697166297382307`*^9}, {
  3.6697172965372868`*^9, 3.669717301783944*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "0", "0", "\[ImaginaryI]"},
     {"0", "\[ImaginaryI]", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.669700486034595*^9, 3.6697005458050528`*^9}, {
   3.669700582380275*^9, 3.669700590313113*^9}, {3.6697006250192738`*^9, 
   3.66970068273024*^9}, {3.669700713181885*^9, 3.669700719685227*^9}, {
   3.6697007550389023`*^9, 3.669700935890984*^9}, {3.6697078644851007`*^9, 
   3.669707996745132*^9}, {3.6697081297259283`*^9, 3.669708156035491*^9}, {
   3.669708429297689*^9, 3.669708439645759*^9}, 3.669708481138034*^9, 
   3.66970852622816*^9, {3.669708556567602*^9, 3.669708606586557*^9}, {
   3.669708662625437*^9, 3.66970869242723*^9}, {3.66970891188202*^9, 
   3.6697089252898407`*^9}, 3.669708971158895*^9, {3.669716612391324*^9, 
   3.6697166312747707`*^9}, {3.669717298625306*^9, 3.6697173020780497`*^9}, 
   3.669974231160128*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"\[Alpha]"},
      {"\[Beta]"},
      {"0"},
      {"0"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.669700486034595*^9, 3.6697005458050528`*^9}, {
   3.669700582380275*^9, 3.669700590313113*^9}, {3.6697006250192738`*^9, 
   3.66970068273024*^9}, {3.669700713181885*^9, 3.669700719685227*^9}, {
   3.6697007550389023`*^9, 3.669700935890984*^9}, {3.6697078644851007`*^9, 
   3.669707996745132*^9}, {3.6697081297259283`*^9, 3.669708156035491*^9}, {
   3.669708429297689*^9, 3.669708439645759*^9}, 3.669708481138034*^9, 
   3.66970852622816*^9, {3.669708556567602*^9, 3.669708606586557*^9}, {
   3.669708662625437*^9, 3.66970869242723*^9}, {3.66970891188202*^9, 
   3.6697089252898407`*^9}, 3.669708971158895*^9, {3.669716612391324*^9, 
   3.6697166312747707`*^9}, {3.669717298625306*^9, 3.6697173020780497`*^9}, 
   3.66997423116742*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Full swap", "Subsubsection",
 CellChangeTimes->{{3.669717924433392*^9, 3.669717925639017*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"-", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"\[Pi]", "/", "4"}]}]]}], 
   RowBox[{"gmx", ".", 
    RowBox[{"KP", "[", 
     RowBox[{
      RowBox[{"rzp", ".", "rym"}], ",", "ryp"}], "]"}], ".", "gmy", ".", 
    RowBox[{"KP", "[", 
     RowBox[{"rxp", ",", "rZp"}], "]"}], ".", "gmx"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.669719658225875*^9, 3.6697197749637747`*^9}, {
  3.6697198068552837`*^9, 3.669719866321883*^9}, {3.669719899190852*^9, 
  3.6697199586563168`*^9}, {3.6697200093231773`*^9, 3.669720062905054*^9}, {
  3.669720122547422*^9, 3.669720125015121*^9}, {3.669720186557372*^9, 
  3.6697202111666937`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.669719691094719*^9, 3.669719717808734*^9}, 
   3.6697197793133593`*^9, 3.6697198689022703`*^9, 3.6697199124489107`*^9, 
   3.669719965263691*^9, {3.669720024744779*^9, 3.669720063134584*^9}, 
   3.669720125485989*^9, {3.669720197233284*^9, 3.669720211777183*^9}, 
   3.6699742311941843`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Lets try to make a simpler full swap", "Subsubsection",
 CellChangeTimes->{{3.6699742144515553`*^9, 3.669974220961232*^9}, {
  3.669978690858076*^9, 3.6699786925336523`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"-", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"\[Pi]", "/", "4"}]}]]}], 
   RowBox[{"gmx", ".", 
    RowBox[{"KP", "[", 
     RowBox[{
      RowBox[{"rzp", ".", "rym"}], ",", "ryp"}], "]"}], ".", "gmy", ".", 
    RowBox[{"KP", "[", 
     RowBox[{"rxp", ",", "rZp"}], "]"}], ".", "gmx"}]}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.669974231222213*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Reduce", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"KP", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"e1", ",", "e2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"e3", ",", "e4"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"e10", ",", "e11"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"e12", ",", "e13"}], "}"}]}], "}"}]}], "]"}], ".", "gmx", 
      ".", 
      RowBox[{"KP", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"e5", ",", "e6"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"e7", ",", "e8"}], "}"}]}], "}"}], ",", 
        RowBox[{"RotZ", "[", "\[Theta]", "]"}]}], "]"}]}], "==", " ", 
     RowBox[{"gmx", ".", 
      RowBox[{"KP", "[", 
       RowBox[{"\[DoubleStruckCapitalI]", ",", "ryp"}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
     "e1", ",", "e2", ",", "e3", ",", "e4", ",", "e5", ",", "e6", ",", "e7", 
      ",", "e8", ",", "\[Theta]", ",", "e10", ",", "e11", ",", "e12", ",", 
      "e13"}], "}"}]}], "]"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.669977687950994*^9, 3.66997789003421*^9}, {
  3.669977953448782*^9, 3.669977977408617*^9}, {3.669978115102407*^9, 
  3.6699781235817127`*^9}, {3.66997819820992*^9, 3.6699782643203993`*^9}, {
  3.6699784344468327`*^9, 3.669978447376669*^9}, {3.669978624877304*^9, 
  3.669978658559701*^9}}],

Cell[BoxData[
 TagBox["False",
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.66997778926422*^9, {3.669977832359028*^9, 3.669977840352417*^9}, 
   3.669977897357128*^9, 3.6699779900692997`*^9, 3.669978456476459*^9, {
   3.669978629169245*^9, 3.66997865540779*^9}}]
}, Open  ]],

Cell["Ouch! Sounds like we can\[CloseCurlyQuote]t???", "Text",
 CellChangeTimes->{{3.66997869616775*^9, 3.669978696597541*^9}, {
  3.669978852262534*^9, 3.669978856938195*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Sequence with Carbon init in Z", "Section",
 CellChangeTimes->{{3.669524592916048*^9, 3.6695246037855883`*^9}}],

Cell[CellGroupData[{

Cell["Prepare nuclear state in 0", "Subsubsection",
 CellChangeTimes->{{3.669720260947732*^9, 3.669720285383333*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Init", "=", 
   RowBox[{"Simplify", "[", " ", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", 
        RowBox[{"\[Pi]", "/", "4"}]}]]}], " ", 
     RowBox[{"gmy", ".", 
      RowBox[{"KP", "[", 
       RowBox[{"\[DoubleStruckCapitalI]", ",", "rZp"}], "]"}], ".", 
      RowBox[{"KP", "[", 
       RowBox[{"rxp", ",", "\[DoubleStruckCapitalI]"}], "]"}], ".", "gmx", 
      ".", 
      RowBox[{"KP", "[", 
       RowBox[{"ryp", ",", 
        RowBox[{"had", "[", 
         RowBox[{"1", ",", "1"}], "]"}]}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"state", "=", 
  RowBox[{"Init", ".", 
   RowBox[{"{", 
    RowBox[{"\[Alpha]", ",", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SuperscriptBox["\[Alpha]", "2"]}], ")"}], 
      RowBox[{"1", "/", "2"}]], ",", "0", ",", "0"}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"PTr", "[", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"AF", "[", 
      RowBox[{"\[Rho]", "[", "state", "]"}], "]"}]}], "]"}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "\[Element]", "Reals"}], ",", 
      RowBox[{"\[Alpha]", "<", "1"}], ",", 
      RowBox[{"\[Alpha]", ">", "0"}]}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.669720290848259*^9, 3.6697204442039537`*^9}, {
  3.669720494204447*^9, 3.669720506794477*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"\[Alpha]"},
      {"0"},
      {
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["\[Alpha]", "2"]}]]},
      {"0"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.6697202984325523`*^9, {3.669720341998681*^9, 3.669720444606769*^9}, {
   3.669720500055722*^9, 3.669720507110243*^9}, 3.669974231252536*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0"},
     {"0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.6697202984325523`*^9, {3.669720341998681*^9, 3.669720444606769*^9}, {
   3.669720500055722*^9, 3.669720507110243*^9}, 3.669974231266032*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Swap electron in nuclear spin, given that should be in 0", \
"Subsubsection",
 CellChangeTimes->{{3.6697205442478733`*^9, 3.669720562904086*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"swapGate", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"\[Pi]", "/", "4"}]}]], " ", 
     RowBox[{
      RowBox[{"KP", "[", 
       RowBox[{"rym", ",", "\[DoubleStruckCapitalI]"}], "]"}], ".", "gmx", 
      ".", 
      RowBox[{"KP", "[", 
       RowBox[{"rxp", ",", "\[DoubleStruckCapitalI]"}], "]"}], ".", "gmy"}]}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"storedState", " ", "=", " ", 
  RowBox[{"AF", "[", 
   RowBox[{
    RowBox[{"KP", "[", 
     RowBox[{
      SubscriptBox["\[ScriptCapitalP]", "0"], ",", 
      "\[DoubleStruckCapitalI]"}], "]"}], ".", "swapGate", ".", 
    RowBox[{"Transpose", "[", 
     RowBox[{"KP", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"\[Alpha]", ",", "\[Beta]"}], "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}], "}"}]}], "]"}], "]"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.669720591159371*^9, 3.669720781264881*^9}, {
  3.6697208842873087`*^9, 3.6697209789516478`*^9}, {3.6697210205676947`*^9, 
  3.6697210829484377`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       FractionBox["\[Alpha]", 
        SqrtBox["2"]], "+", 
       FractionBox["\[Beta]", 
        SqrtBox["2"]]}]},
     {
      RowBox[{
       FractionBox["\[Alpha]", 
        SqrtBox["2"]], "-", 
       FractionBox["\[Beta]", 
        SqrtBox["2"]]}]},
     {"0"},
     {"0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6697206392624207`*^9, 3.669720685684082*^9}, {
   3.669720720811556*^9, 3.669720732551017*^9}, {3.6697207710046*^9, 
   3.6697207819632673`*^9}, {3.669720922609048*^9, 3.669720979225073*^9}, {
   3.669721021197897*^9, 3.669721081255293*^9}, 3.6699742312925*^9}]
}, Open  ]],

Cell["\<\
Electron is in 0, nuclear spin is in electron state IN X BASIS\
\>", "Text",
 CellChangeTimes->{{3.669720832656951*^9, 3.669720842798867*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"KP", "[", 
    RowBox[{"\[DoubleStruckCapitalI]", ",", 
     RowBox[{"had", "[", 
      RowBox[{"1", ",", "1"}], "]"}]}], "]"}], ".", "storedState"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.669720783864118*^9, 3.6697208253440237`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\[Alpha]"},
     {"\[Beta]"},
     {"0"},
     {"0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.669720791958934*^9, 3.6697208255526333`*^9}, 
   3.669721087722147*^9, 3.6699742313238697`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"MeasureKet", "[", 
    RowBox[{"storedState", ",", 
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"{", "0", "}"}]}], "]"}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Abs", "[", "\[Alpha]", "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"Abs", "[", "\[Beta]", "]"}], "2"]}], "\[Equal]", "1"}], 
     "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.669721466593701*^9, 3.669721509152048*^9}, {
  3.6697215592708073`*^9, 3.669721563586684*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{"\[Alpha]", "+", "\[Beta]"}], 
       SqrtBox["2"]]},
     {
      FractionBox[
       RowBox[{"\[Alpha]", "-", "\[Beta]"}], 
       SqrtBox["2"]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.669721502753004*^9, 3.669721509870734*^9}, 
   3.669721565029766*^9, 3.669974232529529*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check that can purify by carrying out CNOT", "Subsubsection",
 CellChangeTimes->{{3.6697205442478733`*^9, 3.669720562904086*^9}, {
  3.669721101702417*^9, 3.669721108491436*^9}, {3.669978905077752*^9, 
  3.66997890899305*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rawstate", " ", "=", 
  RowBox[{"AF", "[", " ", 
   RowBox[{
    RowBox[{"0.5", "*", 
     RowBox[{"\[Rho]", "[", 
      RowBox[{"AF", "[", 
       RowBox[{
        RowBox[{"Ket", "[", "0", "]"}], "\[TensorProduct]", 
        RowBox[{"Ket", "[", "0", "]"}]}], "]"}], "]"}]}], "+", 
    RowBox[{"0.5", "*", 
     RowBox[{"\[Rho]", "[", 
      RowBox[{"AF", "[", 
       RowBox[{
        FractionBox["1", 
         SqrtBox["2"]], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Ket", "[", "0", "]"}], "\[TensorProduct]", 
           RowBox[{"Ket", "[", "1", "]"}]}], "+", 
          RowBox[{
           RowBox[{"Ket", "[", "1", "]"}], "\[TensorProduct]", 
           RowBox[{"Ket", "[", "0", "]"}]}]}], ")"}]}], "]"}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.66952517329827*^9, 3.669525176829472*^9}, {
  3.669525220186952*^9, 3.669525298948457*^9}, {3.669621170134725*^9, 
  3.669621217305496*^9}, {3.669621455920342*^9, 3.6696214830630417`*^9}, {
  3.6696215375647078`*^9, 3.6696215699058313`*^9}, {3.669621601623109*^9, 
  3.669621612120575*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.5`", "0.`", "0.`", "0.`"},
     {"0.`", "0.25`", "0.25`", "0.`"},
     {"0.`", "0.25`", "0.25`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.6695252994844875`*^9, 3.669614400528417*^9, {3.6696212018874187`*^9, 
   3.669621217824749*^9}, {3.6696214601674347`*^9, 3.669621483355316*^9}, {
   3.669621548886883*^9, 3.669621577521708*^9}, 3.669621614890057*^9, 
   3.6696338469090567`*^9, 3.669659231849536*^9, 3.669721346192955*^9, 
   3.669974232768656*^9}]
}, Open  ]],

Cell["Ordering: {ElSpin1,ElSpin2,CSpin1,CSpin2}", "Text",
 CellChangeTimes->{{3.6695246322806826`*^9, 3.6695246476192393`*^9}, {
  3.6695250676162252`*^9, 3.6695250724525023`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Rho]Z", " ", "=", " ", 
   RowBox[{"AF", "[", 
    RowBox[{"\[Rho]", "[", 
     RowBox[{"Ket", "[", "1", "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]Initial", " ", "=", " ", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{"rawstate", ",", "rawstate"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.66952501402816*^9, 3.669525014849207*^9}, {
  3.669525318222559*^9, 3.6695253661853027`*^9}, {3.66962164160452*^9, 
  3.669621663339342*^9}, {3.66962179822192*^9, 3.669621799538958*^9}, {
  3.6696218450643883`*^9, 3.669621910965837*^9}, {3.6696338422018137`*^9, 
  3.6696338422996693`*^9}, {3.669721935033667*^9, 3.669721935398616*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"parityGates", "=", 
   RowBox[{
    RowBox[{"CNOT", "[", 
     RowBox[{"4", ",", "3", ",", "1"}], "]"}], ".", 
    RowBox[{"CNOT", "[", 
     RowBox[{"4", ",", "4", ",", "2"}], "]"}], ".", 
    RowBox[{"KP", "[", 
     RowBox[{
     "\[DoubleStruckCapitalI]", ",", "\[DoubleStruckCapitalI]", ",", "rYp", 
      ",", "rYp"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"state", "=", " ", 
    RowBox[{"parityGates", ".", "\[Rho]Initial", ".", 
     RowBox[{
      RowBox[{"(", "parityGates", ")"}], "\[ConjugateTranspose]"}]}]}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"proj", "=", 
    RowBox[{"MultiQProj", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"3", ",", "3", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"PTr", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"proj", ".", "state", ".", 
      RowBox[{"proj", "\[ConjugateTranspose]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"out", " ", "=", " ", 
  RowBox[{"Chop", "[", 
   RowBox[{"out", "/", 
    RowBox[{"Tr", "[", "out", "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.669721350676931*^9, 3.669721400045938*^9}, {
  3.6697215748651114`*^9, 3.669721577115881*^9}, {3.669721620666606*^9, 
  3.669721631801758*^9}, {3.669721698578211*^9, 3.669721895262429*^9}, {
  3.6697219461665707`*^9, 3.6697220252209806`*^9}, {3.669722068590734*^9, 
  3.669722110663307*^9}, {3.6697222715028543`*^9, 3.6697223030637493`*^9}, {
  3.669722458620532*^9, 3.669722490343943*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0.5`", "0.5`", "0"},
     {"0", "0.5`", "0.5`", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.669721759510951*^9, 3.669721826675521*^9}, {
   3.669721872283835*^9, 3.66972189555516*^9}, {3.669721939846195*^9, 
   3.669721959411756*^9}, 3.669722012202834*^9, {3.6697220702206297`*^9, 
   3.6697221111074266`*^9}, {3.6697222819000597`*^9, 3.669722303513977*^9}, {
   3.669722486163787*^9, 3.669722490571515*^9}, 3.669974232850212*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"-", "\[ImaginaryI]"}], " ", 
   SuperscriptBox["\[ExponentialE]", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
   RowBox[{
    RowBox[{"had", "[", 
     RowBox[{"1", ",", "1"}], "]"}], ".", "rxm"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", " ", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
   RowBox[{"rzp", ".", "rym"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.669723040417027*^9, 3.6697231568497467`*^9}, {
  3.669723191042427*^9, 3.669723192866012*^9}, {3.669723313257576*^9, 
  3.669723334273817*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", 
       SqrtBox["2"]], 
      FractionBox["1", 
       SqrtBox["2"]]},
     {
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        SqrtBox["2"]]}], 
      FractionBox["\[ImaginaryI]", 
       SqrtBox["2"]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.669723050080925*^9, 3.669723157119873*^9}, 
   3.669723193724927*^9, {3.669723326552434*^9, 3.669723334455575*^9}, 
   3.6699742328928213`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", 
       SqrtBox["2"]], 
      FractionBox["1", 
       SqrtBox["2"]]},
     {
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        SqrtBox["2"]]}], 
      FractionBox["\[ImaginaryI]", 
       SqrtBox["2"]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.669723050080925*^9, 3.669723157119873*^9}, 
   3.669723193724927*^9, {3.669723326552434*^9, 3.669723334455575*^9}, 
   3.66997423290275*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"\[ImaginaryI]", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"\[Pi]", "/", "4"}]}]], 
   RowBox[{
    RowBox[{"KP", "[", 
     RowBox[{
      RowBox[{"ryp", ".", "rzp"}], ",", 
      RowBox[{"rzp", ".", "rym"}]}], "]"}], ".", "gmx", ".", 
    RowBox[{"KP", "[", 
     RowBox[{
      RowBox[{"had", "[", 
       RowBox[{"1", ",", "1"}], "]"}], ",", "rym"}], "]"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.669723454923386*^9, 3.6697235208897676`*^9}, {
  3.6697239995461206`*^9, 3.669724075607374*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "0", "0", "1"},
     {"1", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.669723500379779*^9, 3.669723521769861*^9}, {
   3.669724052735011*^9, 3.6697240760289383`*^9}, 3.669974232942986*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Purify using our gates", "Subsubsection",
 CellChangeTimes->{{3.669722658772149*^9, 3.6697226638819113`*^9}}],

Cell["In isolation", "Text",
 CellChangeTimes->{{3.669724282470606*^9, 3.6697242847010183`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"purifyGates", "=", 
    RowBox[{
     RowBox[{"KP", "[", 
      RowBox[{
       RowBox[{"ryp", ".", "rzp"}], ",", 
       RowBox[{"ryp", ".", "rzp"}], ",", 
       RowBox[{"rzp", ".", "rym"}], ",", 
       RowBox[{"rzp", ".", "rym"}]}], "]"}], ".", 
     RowBox[{"gmxMulti", "[", 
      RowBox[{"4", ",", "1", ",", "3", ",", "0"}], "]"}], ".", 
     RowBox[{"gmxMulti", "[", 
      RowBox[{"4", ",", "2", ",", "4", ",", "0"}], "]"}], ".", 
     RowBox[{"KP", "[", 
      RowBox[{
       RowBox[{"had", "[", 
        RowBox[{"1", ",", "1"}], "]"}], ",", 
       RowBox[{"had", "[", 
        RowBox[{"1", ",", "1"}], "]"}], ",", "rym", ",", "rym"}], "]"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"state", "=", " ", 
    RowBox[{"purifyGates", ".", "\[Rho]Initial", ".", 
     RowBox[{
      RowBox[{"(", "purifyGates", ")"}], "\[ConjugateTranspose]"}]}]}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"proj", "=", 
    RowBox[{"MultiQProj", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"3", ",", "3", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"PTr", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"proj", ".", "state", ".", 
      RowBox[{"proj", "\[ConjugateTranspose]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"out", " ", "=", " ", 
  RowBox[{"Chop", "[", 
   RowBox[{"out", "/", 
    RowBox[{"Tr", "[", "out", "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.669722676073382*^9, 3.669722781645191*^9}, {
  3.6697239094751787`*^9, 3.669723975371304*^9}, {3.669724168760303*^9, 
  3.669724216873871*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0.5`", "0.5`", "0"},
     {"0", "0.5`", "0.5`", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6697227679089947`*^9, 3.6697227821584263`*^9}, {
   3.6697239659530773`*^9, 3.669723975824437*^9}, {3.669724212757703*^9, 
   3.669724217148983*^9}, 3.669974233064011*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Put it together into a full scheme", "Subsection",
 CellChangeTimes->{{3.66972429046049*^9, 3.6697242959722767`*^9}, {
  3.669978913481093*^9, 3.6699789177287893`*^9}}],

Cell["Start with nucleus in 0, electron in raw state", "Text",
 CellChangeTimes->{{3.669724335525441*^9, 3.669724345370922*^9}, {
  3.669724394202757*^9, 3.6697244016324577`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rawstate", " ", "=", 
  RowBox[{"AF", "[", " ", 
   RowBox[{
    RowBox[{"0.5", "*", 
     RowBox[{"\[Rho]", "[", 
      RowBox[{"AF", "[", 
       RowBox[{
        RowBox[{"Ket", "[", "0", "]"}], "\[TensorProduct]", 
        RowBox[{"Ket", "[", "0", "]"}]}], "]"}], "]"}]}], "+", 
    RowBox[{"0.5", "*", 
     RowBox[{"\[Rho]", "[", 
      RowBox[{"AF", "[", 
       RowBox[{
        FractionBox["1", 
         SqrtBox["2"]], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Ket", "[", "0", "]"}], "\[TensorProduct]", 
           RowBox[{"Ket", "[", "1", "]"}]}], "+", 
          RowBox[{
           RowBox[{"Ket", "[", "1", "]"}], "\[TensorProduct]", 
           RowBox[{"Ket", "[", "0", "]"}]}]}], ")"}]}], "]"}], "]"}]}]}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.5`", "0.`", "0.`", "0.`"},
     {"0.`", "0.25`", "0.25`", "0.`"},
     {"0.`", "0.25`", "0.25`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.669974233106544*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Rho]Z", " ", "=", " ", 
   RowBox[{"AF", "[", 
    RowBox[{"\[Rho]", "[", 
     RowBox[{"Ket", "[", "0", "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]Initial", " ", "=", " ", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{"rawstate", ",", "\[Rho]Z", ",", "\[Rho]Z"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.669724407253468*^9, 3.6697244191677*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"swapGates", "=", 
   RowBox[{"Simplify", "[", " ", 
    RowBox[{
     RowBox[{"KP", "[", 
      RowBox[{
      "rym", ",", "rym", ",", "\[DoubleStruckCapitalI]", ",", 
       "\[DoubleStruckCapitalI]"}], "]"}], ".", 
     RowBox[{"gmxMulti", "[", 
      RowBox[{"4", ",", "2", ",", "4", ",", "0"}], "]"}], ".", 
     RowBox[{"gmxMulti", "[", 
      RowBox[{"4", ",", "1", ",", "3", ",", "0"}], "]"}], ".", 
     RowBox[{"KP", "[", 
      RowBox[{
      "rxp", ",", "rxp", ",", "\[DoubleStruckCapitalI]", ",", 
       "\[DoubleStruckCapitalI]"}], "]"}], ".", 
     RowBox[{"gmxMulti", "[", 
      RowBox[{"4", ",", "1", ",", "3", ",", 
       RowBox[{
        RowBox[{"-", "\[Pi]"}], "/", "2"}]}], "]"}], ".", 
     RowBox[{"gmxMulti", "[", 
      RowBox[{"4", ",", "2", ",", "4", ",", 
       RowBox[{
        RowBox[{"-", "\[Pi]"}], "/", "2"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"storedState", " ", "=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"swapGates", ".", "\[Rho]Initial", ".", 
     RowBox[{"swapGates", "\[ConjugateTranspose]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.669720591159371*^9, 3.669720781264881*^9}, {
  3.6697208842873087`*^9, 3.6697209789516478`*^9}, {3.6697210205676947`*^9, 
  3.6697210829484377`*^9}, {3.669724445392318*^9, 3.669724562256222*^9}, {
  3.669724594485675*^9, 3.6697246164647083`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"proj", "=", 
    RowBox[{"MultiQProj", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"3", ",", "3", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"projState", "=", 
   RowBox[{"PTr", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"proj", ".", "storedState", ".", 
      RowBox[{"proj", "\[ConjugateTranspose]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"projState", " ", "=", " ", 
  RowBox[{"Chop", "[", 
   RowBox[{"projState", "/", 
    RowBox[{"Tr", "[", "projState", "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.669724645901539*^9, 3.6697246699571533`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.375`", "0.125`", "0.125`", 
      RowBox[{"-", "0.125`"}]},
     {"0.125`", "0.125`", "0.125`", "0.125`"},
     {"0.125`", "0.125`", "0.125`", "0.125`"},
     {
      RowBox[{"-", "0.125`"}], "0.125`", "0.125`", "0.375`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.669724673564373*^9, 3.6699742332709827`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"KP", "[", 
   RowBox[{
    RowBox[{"had", "[", 
     RowBox[{"1", ",", "1"}], "]"}], ",", 
    RowBox[{"had", "[", 
     RowBox[{"1", ",", "1"}], "]"}]}], "]"}], ".", "projState", ".", 
  RowBox[{"KP", "[", 
   RowBox[{
    RowBox[{"had", "[", 
     RowBox[{"1", ",", "1"}], "]"}], ",", 
    RowBox[{"had", "[", 
     RowBox[{"1", ",", "1"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.669724708875194*^9, 3.66972473361456*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.5`", "0.`", "0.`", "0.`"},
     {"0.`", "0.25`", "0.25`", "0.`"},
     {"0.`", "0.25`", "0.25`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.669724734513088*^9, 3.6699742333220453`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Onto the next state of entanglement generation", "Subsubsection",
 CellChangeTimes->{{3.669724764886656*^9, 3.669724778973893*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Rho]Comb", " ", "=", " ", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{"rawstate", ",", "projState"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.669724788288938*^9, 3.6697248057750807`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"purifyGatesNoY", "=", 
    RowBox[{
     RowBox[{"KP", "[", 
      RowBox[{
       RowBox[{"ryp", ".", "rzp"}], ",", 
       RowBox[{"ryp", ".", "rzp"}], ",", 
       RowBox[{"rzp", ".", "rym"}], ",", 
       RowBox[{"rzp", ".", "rym"}]}], "]"}], ".", 
     RowBox[{"gmxMulti", "[", 
      RowBox[{"4", ",", "1", ",", "3", ",", "0"}], "]"}], ".", 
     RowBox[{"gmxMulti", "[", 
      RowBox[{"4", ",", "2", ",", "4", ",", "0"}], "]"}], ".", 
     RowBox[{"KP", "[", 
      RowBox[{
       RowBox[{"had", "[", 
        RowBox[{"1", ",", "1"}], "]"}], ",", 
       RowBox[{"had", "[", 
        RowBox[{"1", ",", "1"}], "]"}], ",", "rZp", ",", "rZp"}], "]"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"purifiedState", "=", " ", 
    RowBox[{"purifyGatesNoY", ".", "\[Rho]Comb", ".", 
     RowBox[{
      RowBox[{"(", "purifyGatesNoY", ")"}], "\[ConjugateTranspose]"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"proj", "=", 
    RowBox[{"MultiQProj", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"3", ",", "3", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"PTr", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"proj", ".", "purifiedState", ".", 
      RowBox[{"proj", "\[ConjugateTranspose]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"out", " ", "=", " ", 
  RowBox[{"Chop", "[", 
   RowBox[{"out", "/", 
    RowBox[{"Tr", "[", "out", "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.669722676073382*^9, 3.669722781645191*^9}, {
  3.6697239094751787`*^9, 3.669723975371304*^9}, {3.669724168760303*^9, 
  3.669724216873871*^9}, {3.6697248254659767`*^9, 3.669724884328871*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0.5`", "0.5`", "0"},
     {"0", "0.5`", "0.5`", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6697227679089947`*^9, 3.6697227821584263`*^9}, {
   3.6697239659530773`*^9, 3.669723975824437*^9}, {3.669724212757703*^9, 
   3.669724217148983*^9}, {3.6697248404734364`*^9, 3.669724885209158*^9}, 
   3.6699742334355173`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{841, 879},
WindowMargins->{{67, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 9, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 208, 4, 49, "Text"],
Cell[769, 26, 370, 9, 46, "Input"],
Cell[CellGroupData[{
Cell[1164, 39, 151, 2, 64, "Section"],
Cell[1318, 43, 218, 5, 28, "Input"],
Cell[CellGroupData[{
Cell[1561, 52, 648, 12, 46, "Input"],
Cell[2212, 66, 173, 2, 22, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2422, 73, 120, 1, 44, "Subsection"],
Cell[2545, 76, 1274, 33, 69, "Input"],
Cell[CellGroupData[{
Cell[3844, 113, 62, 1, 28, "Input"],
Cell[3909, 116, 33514, 940, 579, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[37472, 1062, 107, 1, 44, "Subsection"],
Cell[37582, 1065, 279, 5, 49, "Text"],
Cell[37864, 1072, 276, 7, 28, "Input"],
Cell[38143, 1081, 434, 11, 28, "Input"],
Cell[38580, 1094, 561, 14, 46, "Input"],
Cell[39144, 1110, 934, 26, 46, "Input"],
Cell[40081, 1138, 207, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[40313, 1146, 630, 15, 28, "Input"],
Cell[40946, 1163, 283, 6, 28, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[41278, 1175, 108, 1, 44, "Subsection"],
Cell[41389, 1178, 3816, 90, 208, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45242, 1273, 114, 1, 44, "Subsection"],
Cell[45359, 1276, 1269, 25, 100, "Input"],
Cell[46631, 1303, 880, 24, 46, "Input"],
Cell[47514, 1329, 2298, 49, 151, "Input"],
Cell[CellGroupData[{
Cell[49837, 1382, 794, 13, 46, "Input"],
Cell[50634, 1397, 2654, 59, 121, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[53349, 1463, 99, 1, 64, "Section"],
Cell[CellGroupData[{
Cell[53473, 1468, 93, 1, 44, "Subsection"],
Cell[53569, 1471, 116, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[53710, 1476, 848, 18, 28, "Input"],
Cell[54561, 1496, 3526, 116, 172, "Output"]
}, Open  ]],
Cell[58102, 1615, 306, 6, 30, "Text"],
Cell[CellGroupData[{
Cell[58433, 1625, 1400, 33, 46, "Input"],
Cell[59836, 1660, 1319, 32, 91, "Output"],
Cell[61158, 1694, 1317, 32, 91, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[62524, 1732, 96, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[62645, 1737, 106, 1, 35, "Subsubsection"],
Cell[62754, 1740, 263, 5, 49, "Text"],
Cell[CellGroupData[{
Cell[63042, 1749, 764, 16, 28, "Input"],
Cell[63809, 1767, 1923, 56, 124, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65769, 1828, 465, 11, 30, "Input"],
Cell[66237, 1841, 875, 24, 97, "Output"]
}, Open  ]],
Cell[67127, 1868, 138, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[67290, 1873, 394, 7, 28, "Input"],
Cell[67687, 1882, 848, 22, 47, "Output"]
}, Open  ]],
Cell[68550, 1907, 119, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[68694, 1912, 444, 8, 28, "Input"],
Cell[69141, 1922, 922, 24, 63, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[70112, 1952, 106, 1, 35, "Subsubsection"],
Cell[70221, 1955, 112, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[70358, 1960, 722, 15, 28, "Input"],
Cell[71083, 1977, 3597, 118, 172, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[74717, 2100, 558, 11, 30, "Input"],
Cell[75278, 2113, 1602, 47, 113, "Output"]
}, Open  ]],
Cell[76895, 2163, 177, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[77097, 2169, 447, 8, 28, "Input"],
Cell[77547, 2179, 1069, 28, 63, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78653, 2212, 469, 8, 28, "Input"],
Cell[79125, 2222, 1064, 29, 63, "Output"]
}, Open  ]],
Cell[80204, 2254, 203, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[80432, 2261, 2114, 49, 131, "Input"],
Cell[82549, 2312, 974, 25, 63, "Output"],
Cell[83526, 2339, 973, 25, 63, "Output"],
Cell[84502, 2366, 976, 25, 63, "Output"],
Cell[85481, 2393, 976, 25, 63, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[86530, 2426, 158, 2, 64, "Section"],
Cell[CellGroupData[{
Cell[86713, 2432, 105, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[86843, 2437, 1880, 50, 88, "Input"],
Cell[88726, 2489, 329, 7, 28, "Output"],
Cell[89058, 2498, 329, 7, 28, "Output"],
Cell[89390, 2507, 329, 7, 28, "Output"],
Cell[89722, 2516, 331, 7, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[90090, 2528, 336, 7, 46, "Input"],
Cell[90429, 2537, 967, 29, 67, "Output"],
Cell[91399, 2568, 969, 29, 67, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[92405, 2602, 255, 6, 46, "Input"],
Cell[92663, 2610, 918, 28, 67, "Output"],
Cell[93584, 2640, 918, 28, 67, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[94551, 2674, 101, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[94677, 2679, 130, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[94832, 2684, 1750, 38, 53, "Input"],
Cell[96585, 2724, 1600, 36, 92, "Output"],
Cell[98188, 2762, 1512, 34, 79, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[99749, 2802, 250, 3, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[100024, 2809, 1205, 26, 70, "Input"],
Cell[101232, 2837, 1441, 30, 81, "Output"],
Cell[102676, 2869, 1423, 32, 79, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[104148, 2907, 100, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[104273, 2912, 736, 17, 35, "Input"],
Cell[105012, 2931, 973, 24, 81, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[106034, 2961, 180, 2, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[106239, 2967, 418, 12, 35, "Input"],
Cell[106660, 2981, 701, 20, 81, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[107398, 3006, 1561, 42, 80, "Input"],
Cell[108962, 3050, 305, 7, 28, "Output"]
}, Open  ]],
Cell[109282, 3060, 176, 2, 30, "Text"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[109519, 3069, 117, 1, 64, "Section"],
Cell[CellGroupData[{
Cell[109661, 3074, 117, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[109803, 3079, 1551, 45, 76, "Input"],
Cell[111357, 3126, 909, 27, 91, "Output"],
Cell[112269, 3155, 750, 20, 47, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[113068, 3181, 151, 2, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[113244, 3187, 1209, 34, 53, "Input"],
Cell[114456, 3223, 1139, 33, 103, "Output"]
}, Open  ]],
Cell[115610, 3259, 152, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[115787, 3266, 306, 8, 28, "Input"],
Cell[116096, 3276, 730, 21, 79, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[116863, 3302, 614, 17, 35, "Input"],
Cell[117480, 3321, 855, 25, 69, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[118384, 3352, 232, 3, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[118641, 3359, 1119, 29, 54, "Input"],
Cell[119763, 3390, 1039, 25, 81, "Output"]
}, Open  ]],
Cell[120817, 3418, 180, 2, 30, "Text"],
Cell[121000, 3422, 718, 15, 46, "Input"],
Cell[CellGroupData[{
Cell[121743, 3441, 1802, 47, 131, "Input"],
Cell[123548, 3490, 1032, 24, 81, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[124617, 3519, 696, 19, 79, "Input"],
Cell[125316, 3540, 967, 29, 67, "Output"],
Cell[126286, 3571, 964, 29, 67, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[127287, 3605, 605, 17, 35, "Input"],
Cell[127895, 3624, 799, 21, 81, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[128743, 3651, 115, 1, 35, "Subsubsection"],
Cell[128861, 3654, 96, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[128982, 3659, 1919, 54, 165, "Input"],
Cell[130904, 3715, 865, 22, 81, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[131818, 3743, 174, 2, 44, "Subsection"],
Cell[131995, 3747, 179, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[132199, 3753, 806, 24, 54, "Input"],
Cell[133008, 3779, 742, 20, 81, "Output"]
}, Open  ]],
Cell[133765, 3802, 441, 12, 46, "Input"],
Cell[134209, 3816, 1422, 35, 63, "Input"],
Cell[CellGroupData[{
Cell[135656, 3855, 847, 24, 80, "Input"],
Cell[136506, 3881, 849, 22, 81, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[137392, 3908, 470, 14, 28, "Input"],
Cell[137865, 3924, 766, 20, 81, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[138668, 3949, 137, 1, 35, "Subsubsection"],
Cell[138808, 3952, 238, 5, 28, "Input"],
Cell[CellGroupData[{
Cell[139071, 3961, 1990, 54, 165, "Input"],
Cell[141064, 4017, 919, 23, 81, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
