(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     74992,       1720]
NotebookOptionsPosition[     73168,       1655]
NotebookOutlinePosition[     73524,       1671]
CellTagsIndexPosition[     73481,       1668]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"$packageDir", " ", "=", " ", 
  "\"\<~/Documents/IDrive-Sync/Work/Delft/Projects/Purification/Simulations/\
QSIM\>\""}], "\n", 
 RowBox[{"Needs", "[", 
  RowBox[{"\"\<QSIM`basicfunctions`\>\"", ",", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"$packageDir", ",", "\"\<QSIM_basicFunctions.m\>\""}], "}"}], 
    "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Needs", "[", 
  RowBox[{"\"\<QSIM`measurement`\>\"", ",", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"$packageDir", ",", "\"\<QSIM_measurement.m\>\""}], "}"}], 
    "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Needs", "[", 
  RowBox[{"\"\<QSIM`stabilizers`\>\"", ",", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"$packageDir", ",", "\"\<QSIM_stabilizers.m\>\""}], "}"}], 
    "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Needs", "[", 
  RowBox[{"\"\<QSIM`nonlocal`\>\"", ",", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"$packageDir", ",", "\"\<QSIM_nonlocal.m\>\""}], "}"}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Needs", "[", 
  RowBox[{"\"\<QSIM`noise`\>\"", ",", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"$packageDir", ",", "\"\<QSIM_noise.m\>\""}], "}"}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Needs", "[", 
  RowBox[{"\"\<QSIM`superoperators`\>\"", ",", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"$packageDir", ",", "\"\<QSIM_superoperators.m\>\""}], "}"}], 
    "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Needs", "[", 
  RowBox[{"\"\<QSIM`errorAnalysis`\>\"", ",", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"$packageDir", ",", "\"\<QSIM_errorAnalysis.m\>\""}], "}"}], 
    "]"}]}], "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.626015630672985*^9, 3.626015652167428*^9}, {
   3.626015709597934*^9, 3.626015736167651*^9}, {3.626015780242087*^9, 
   3.626015788445459*^9}, {3.626019940240074*^9, 3.626019946452292*^9}, {
   3.67792492475344*^9, 3.677924926278592*^9}, 3.677924961114075*^9, 
   3.677996608765787*^9, {3.678014302274992*^9, 3.6780143026107607`*^9}}],

Cell[BoxData["\<\"~/Documents/IDrive-Sync/Work/Delft/Projects/Purification/\
Simulations/QSIM\"\>"], "Output",
 CellChangeTimes->{
  3.6780086106477327`*^9, {3.678009046711412*^9, 3.67800907536051*^9}, {
   3.67801416348*^9, 3.678014216797428*^9}, 3.678014259163231*^9, 
   3.6780143404737587`*^9, 3.678014486904751*^9, {3.67801506090312*^9, 
   3.678015061106763*^9}, {3.678081933140888*^9, 3.678081933363706*^9}, {
   3.678084084377788*^9, 3.678084084740829*^9}, {3.678088639973198*^9, 
   3.67808864029665*^9}, 3.678092541984913*^9, {3.678112497957301*^9, 
   3.6781124983041153`*^9}, {3.678112594718225*^9, 3.678112594892477*^9}, {
   3.678112768152788*^9, 3.678112790591134*^9}, 3.678126189070838*^9}]
}, Open  ]],

Cell[TextData[{
 "Parameters that define the raw state (generated by a single photon click): \
\n\n",
 StyleBox["vis ",
  FontWeight->"Bold"],
 "- the visibility of the photons\n",
 StyleBox["fz ",
  FontWeight->"Bold"],
 " - determined by initialization error, MW pulse infidelity and spin flip \
probability  \n",
 StyleBox["r ",
  FontWeight->"Bold"],
 " - the proportion of the state in the unentangled \[OpenCurlyQuote]11\
\[CloseCurlyQuote] state\n\nThe r value depends on: \n\n",
 StyleBox["pd",
  FontWeight->"Bold"],
 " - the probability that a photon emitted is detected pd = pZPL*pDetect \
where: \n\t- ",
 StyleBox["pZPL ",
  FontWeight->"Bold"],
 "- probability that a given photon is in the zero photon line\n\t-",
 StyleBox[" pDetect ",
  FontWeight->"Bold"],
 "- detection efficiency\n",
 StyleBox["theta ",
  FontWeight->"Bold"],
 " - the initial rotation of the state of the qubits: Cos[theta]|0> + \
Sin[theta]|1>\n\n",
 StyleBox["(or can treat the raw state as being werner state in which case we \
need only the fidelity: \n",
  FontSize->12],
 StyleBox["fid",
  FontSize->12,
  FontWeight->"Bold"],
 StyleBox[" - The fidelity of the raw state immediately after it is generated \
if there was no photon loss) ",
  FontSize->12],
 "\n\n\n\nThe parameters of the distillation procedure:\n\n",
 StyleBox["pCNOT",
  FontWeight->"Bold"],
 " - the error rate when a CNOT gate can be performed between electron and \
nuclear qubits\n",
 StyleBox["pSWAP",
  FontWeight->"Bold"],
 " - the error rate when a SWAP operation is performed between electron and \
nuclear qubits\n",
 StyleBox["pmBright",
  FontWeight->"Bold"],
 " - the probability of error in measuring the bright state\n",
 StyleBox["pmDark",
  FontWeight->"Bold"],
 " - the probability of error in measureing the dark state\n",
 StyleBox["pp",
  FontWeight->"Bold"],
 " - the probability for a phase error between the genration of raw state 1 & \
2\n\n\n-----------------------------------------------\n\tAdditional \
parameters\n-----------------------------------------------\n",
 StyleBox["pCarbonDephasing",
  FontWeight->"Bold"],
 " - the probability for a phase error on the stored carbon state\n",
 StyleBox["RndOpticalPhase",
  FontWeight->"Bold"],
 " - the phase imprinted on the first raw state (this parameter is only just \
to check the robustness of the protocol\n",
 StyleBox["\n",
  FontWeight->"Bold"],
 "\n\n\n\nthe function rawState[fid_,pLoss_] generates a density matrix of \
the entangled state generated after a single detector click\n"
}], "Text",
 CellChangeTimes->{{3.6260159054750957`*^9, 3.6260159848498287`*^9}, {
   3.6260160164807587`*^9, 3.62601603241346*^9}, {3.6260160853325787`*^9, 
   3.626016360869864*^9}, {3.6260164044790154`*^9, 3.626016428197345*^9}, {
   3.6260199750885077`*^9, 3.6260200503918753`*^9}, {3.6260200878771048`*^9, 
   3.626020121937676*^9}, 3.626020458581408*^9, {3.6574481636279697`*^9, 
   3.657448389576106*^9}, {3.657448433633213*^9, 3.657448582392974*^9}, {
   3.6574486184878273`*^9, 3.6574486295662527`*^9}, {3.6579699944312153`*^9, 
   3.6579701660203724`*^9}, {3.657970914417205*^9, 3.6579709242871914`*^9}},
 Background->RGBColor[0.87, 0.94, 1]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rValue", "[", 
    RowBox[{"theta_", ",", "pZPL_", ",", "pDetect_", ",", "pDC_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p00", ",", "p01", ",", "p11", ",", "pd"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"pd", " ", "=", " ", 
       RowBox[{"pZPL", "*", "pDetect"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"p00", " ", "=", " ", 
       RowBox[{"2", "*", 
        RowBox[{
         RowBox[{"Cos", "[", "theta", "]"}], "^", "4"}], "*", "pDC", "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", "pDC"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"p01", " ", "=", " ", 
       RowBox[{"2", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Sin", "[", "theta", "]"}], ")"}], "^", "2"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Cos", "[", "theta", "]"}], ")"}], "^", "2"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "pDC"}], ")"}], "^", "2"}], " ", "*", " ", 
           "pd"}], "+", " ", 
          RowBox[{"2", "*", "pDC", "*", 
           RowBox[{"(", 
            RowBox[{"1", "-", "pDC"}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"1", "-", "pd"}], ")"}]}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"p11", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Sin", "[", "theta", "]"}], "^", "4"}], " ", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "pDC"}], ")"}], "^", "2"}], "*", "2", "*", 
           RowBox[{"(", 
            RowBox[{"pd", " ", "*", 
             RowBox[{"(", 
              RowBox[{"1", "-", "pd"}], ")"}]}], ")"}]}], " ", "+", " ", 
          RowBox[{"2", 
           RowBox[{"(", 
            RowBox[{"1", "-", "pDC"}], ")"}], "*", "pDC", "*", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "pd"}], ")"}], "^", "2"}]}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"p00", ",", "p01", ",", "p11"}], "}"}], "/", 
       RowBox[{"(", 
        RowBox[{"p00", "+", "p01", "+", "p11"}], ")"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}]], "Code",
 CellChangeTimes->{{3.657448711288566*^9, 3.6574487489939947`*^9}, {
   3.6574498817703133`*^9, 3.657450127628716*^9}, {3.65745038070788*^9, 
   3.657450472295886*^9}, {3.657450528801023*^9, 3.6574505620945044`*^9}, {
   3.6574506234124537`*^9, 3.657450623483407*^9}, {3.6574507521998053`*^9, 
   3.657450757010153*^9}, {3.657450799343954*^9, 3.657450845429591*^9}, {
   3.657450876921249*^9, 3.657451003532775*^9}, {3.657451150388335*^9, 
   3.6574512528777113`*^9}, {3.6574512920694237`*^9, 3.6574513315796003`*^9}, 
   3.657451572499042*^9, {3.657451787775593*^9, 3.6574517943027153`*^9}, 
   3.6574521051442623`*^9, {3.671856477089058*^9, 3.671856477186067*^9}, {
   3.6781005347017717`*^9, 3.6781005347540407`*^9}, {3.678111418833529*^9, 
   3.6781114531018267`*^9}, {3.67811180499543*^9, 3.6781118051189003`*^9}, {
   3.678111897945161*^9, 3.678111911107593*^9}}],

Cell[CellGroupData[{

Cell["Raw state generation", "Subsection",
 CellChangeTimes->{{3.657452115546418*^9, 3.6574521293461647`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rawState", " ", "[", 
    RowBox[{"vis_", ",", "fz_", ",", "rValue_", ",", "RndOpticalPhase_"}], 
    "]"}], ":=", 
   RowBox[{"Chop", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"rValue", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "*", 
      RowBox[{"KP", "[", 
       RowBox[{"one", ",", "one"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"rValue", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "*", "0.5", "*", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "-", "fz"}], ",", "0", ",", "0", ",", "0"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "fz", ",", 
          RowBox[{
           RowBox[{"-", "vis"}], "*", 
           RowBox[{"Exp", "[", 
            RowBox[{"\[ImaginaryI]", "*", "RndOpticalPhase"}], "]"}]}], ",", 
          "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"-", "vis"}], "*", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], "*", "RndOpticalPhase"}], 
            "]"}]}], ",", "fz", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", 
          RowBox[{"1", "-", "fz"}]}], "}"}]}], "}"}]}], "+", 
     RowBox[{
      RowBox[{"rValue", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "*", 
      RowBox[{"KP", "[", 
       RowBox[{"zero", ",", "zero"}], "]"}]}]}], "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.657451286838171*^9, 3.657451290637148*^9}, 
   3.6574521426655273`*^9, {3.657452583436804*^9, 3.657452618447434*^9}, {
   3.657452710796493*^9, 3.657452782806159*^9}, {3.6579701770184727`*^9, 
   3.657970210616832*^9}, {3.6579708619019537`*^9, 3.657970865084272*^9}, 
   3.6579710551492767`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"rawState", "[", 
   RowBox[{"0.9", ",", "0.99", ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0.5", ",", "0.5"}], "}"}], ",", 
    RowBox[{"0.5", "\[Pi]"}]}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.65745261618729*^9, 3.6574526750066442`*^9}, {
  3.657452739158271*^9, 3.657452742968199*^9}, {3.657460389590446*^9, 
  3.657460395754766*^9}, {3.657970257950565*^9, 3.657970261764946*^9}, {
  3.6579708391666803`*^9, 3.6579708427560396`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.5025`", "0", "0", "0"},
     {"0", "0.2475`", 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.225`", " ", "\[ImaginaryI]"}]}], "0"},
     {"0", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.225`", " ", "\[ImaginaryI]"}]}], "0.2475`", "0"},
     {"0", "0", "0", "0.0025000000000000022`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.657452644660597*^9, 3.657452675252245*^9}, 
   3.657452713701495*^9, {3.65745277568547*^9, 3.6574527846027822`*^9}, {
   3.657460392150454*^9, 3.6574603960017653`*^9}, 3.6579673278144493`*^9, {
   3.657970258875657*^9, 3.657970261953965*^9}, {3.657970836297394*^9, 
   3.657970867299494*^9}, 3.6579709389376564`*^9, 3.6579710570124626`*^9, 
   3.657972618527599*^9, 3.657978712572384*^9, 3.671856311155466*^9, 
   3.671856482188567*^9, 3.677586761879753*^9, 3.677586836639228*^9, 
   3.677587215009536*^9, 3.677917441145151*^9, 3.6779195231763334`*^9, 
   3.6779242954575167`*^9, 3.677924985295493*^9, 3.677996658707383*^9, 
   3.677996879744383*^9, 3.677997034461967*^9, 3.678006885305724*^9, 
   3.678007415889127*^9, 3.678007454530347*^9, 3.678015061636915*^9, 
   3.67808193373905*^9, 3.678084085151938*^9, 3.678088640877193*^9, 
   3.678092542264339*^9, 3.678112498381496*^9, 3.678112594975635*^9, {
   3.6781127682933407`*^9, 3.678112790685603*^9}, 3.678126189152667*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["EPL protocol", "Subsection",
 CellChangeTimes->{{3.657452115546418*^9, 3.6574521293461647`*^9}, {
  3.657452802724926*^9, 3.657452804104664*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"eplFromRawState", "[", 
    RowBox[{
    "inputState_", ",", "inputState2_", ",", "pCNOT_", ",", "pSWAP_", ",", 
     "pmDark_", ",", "pmBright_", ",", "pp_", ",", "pCarbonDephasing_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "rawState", ",", "rawState1", ",", "rawState2", ",", "state", ",", 
       "cz1", ",", "cz2", ",", "hads", ",", "p", ",", "swap1", ",", "swap2"}],
       "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rawState", " ", "=", " ", "inputState"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "the", " ", "state", " ", "gets", " ", "swapped", " ", "onto", " ", 
        "nuclear", " ", "spins"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"state", " ", "=", " ", 
       RowBox[{"KP", "[", 
        RowBox[{"rawState", ",", "zero", ",", "zero"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"swap1", " ", "=", " ", 
       RowBox[{"twoQgate", "[", 
        RowBox[{"4", ",", "1", ",", "3", ",", "swap"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"swap2", " ", "=", " ", 
       RowBox[{"twoQgate", "[", 
        RowBox[{"4", ",", "2", ",", "4", ",", "swap"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"state", " ", "=", " ", 
       RowBox[{"swap1", ".", "state", ".", 
        RowBox[{"CT", "[", "swap1", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"state", " ", "=", " ", 
       RowBox[{"swap2", ".", "state", ".", 
        RowBox[{"CT", "[", "swap2", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"state", " ", "=", " ", 
       RowBox[{"applyGateNoise", "[", 
        RowBox[{"state", ",", "pSWAP", ",", "1", ",", "3"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"state", " ", "=", " ", 
       RowBox[{"applyGateNoise", "[", 
        RowBox[{"state", ",", "pSWAP", ",", "2", ",", "4"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "the", " ", "electron", " ", "spins", " ", "are", " ", "measured", " ",
         "out", " ", "in", " ", "the", " ", "zero", " ", 
        RowBox[{"state", ":", " ", 
         RowBox[{
         "NB", " ", "this", " ", "is", " ", "post", " ", "selective"}]}]}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"rawState1", " ", "=", " ", 
       RowBox[{"measureOutcomeReal", "[", 
        RowBox[{"state", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", "pmDark"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "generate", " ", "another", " ", "raw", " ", "pair", " ", "on", " ", 
         "the", " ", "electrons"}], ",", " ", 
        RowBox[{"this", " ", "time", " ", 
         RowBox[{"there", "'"}], "s", " ", "some", " ", "phase", " ", "shift",
          " ", "pp", " ", "from", " ", "the", " ", "first", " ", "one"}]}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"rawState2", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "pp"}], ")"}], "*", "inputState2"}], " ", "+", 
        " ", 
        RowBox[{"pp", "*", 
         RowBox[{
          RowBox[{"KP", "[", 
           RowBox[{"pZ", ",", "id"}], "]"}], ".", "inputState2", ".", 
          RowBox[{"KP", "[", 
           RowBox[{"pZ", ",", "id"}], "]"}]}]}]}]}], ";", "\n", "\n", 
      RowBox[{"(*", 
       RowBox[{
       "dephasing", " ", "of", " ", "the", " ", "stored", " ", "state", " ", 
        "is", " ", "modelled", " ", "symmetrically", " ", "for", " ", "both", 
        " ", "nuclear", " ", "spins"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"rawState1", " ", "=", " ", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", "pCarbonDephasing"}], ")"}], "2"], "*", 
         "rawState1"}], " ", "+", " ", 
        RowBox[{"pCarbonDephasing", "*", 
         RowBox[{"(", 
          RowBox[{"1", "-", "pCarbonDephasing"}], ")"}], "*", 
         RowBox[{
          RowBox[{"KP", "[", 
           RowBox[{"pZ", ",", "id"}], "]"}], ".", "rawState1", ".", 
          RowBox[{"KP", "[", 
           RowBox[{"pZ", ",", "id"}], "]"}]}]}], "+", 
        RowBox[{"pCarbonDephasing", "*", 
         RowBox[{"(", 
          RowBox[{"1", "-", "pCarbonDephasing"}], ")"}], "*", 
         RowBox[{
          RowBox[{"KP", "[", 
           RowBox[{"id", ",", "pZ"}], "]"}], ".", "rawState1", ".", 
          RowBox[{"KP", "[", 
           RowBox[{"id", ",", "pZ"}], "]"}]}]}], "+", 
        RowBox[{
         SuperscriptBox["pCarbonDephasing", "2"], "*", 
         RowBox[{
          RowBox[{"KP", "[", 
           RowBox[{"pZ", ",", "pZ"}], "]"}], ".", "rawState1", ".", 
          RowBox[{"KP", "[", 
           RowBox[{"pZ", ",", "pZ"}], "]"}]}]}]}]}], ";", "\n", 
      "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"KP", "[", 
        RowBox[{"rawState1", ",", "rawState2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"cz1", "=", 
       RowBox[{"twoQgate", "[", 
        RowBox[{"4", ",", "1", ",", "3", ",", "cnotB"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"cz2", "=", 
       RowBox[{"twoQgate", "[", 
        RowBox[{"4", ",", "2", ",", "4", ",", "cnotB"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"cz1", ".", "state", ".", 
        RowBox[{"CT", "[", "cz1", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"cz2", ".", "state", ".", 
        RowBox[{"CT", "[", "cz2", "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"applyGateNoise", "[", 
        RowBox[{"state", ",", "pCNOT", ",", "1", ",", "3"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"applyGateNoise", "[", 
        RowBox[{"state", ",", "pCNOT", ",", "2", ",", "4"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"measureOutcomeReal", "[", 
        RowBox[{"state", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], ",", "pmDark"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"state", "=", " ", 
       RowBox[{
        RowBox[{"KP", "[", 
         RowBox[{"pX", ",", "id"}], "]"}], ".", "state", ".", 
        RowBox[{"KP", "[", 
         RowBox[{"pX", ",", "id"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Chop", "[", 
       RowBox[{"state", "/", 
        RowBox[{"Tr", "[", "state", "]"}]}], "]"}]}]}], "\[IndentingNewLine]",
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Code",
 CellChangeTimes->{{3.626014274371472*^9, 3.6260143025889177`*^9}, {
   3.62601528951161*^9, 3.626015299770426*^9}, {3.626015386244769*^9, 
   3.626015401191888*^9}, {3.626015827486863*^9, 3.626015851279748*^9}, 
   3.626015897505383*^9, {3.626016041501705*^9, 3.6260160779908333`*^9}, {
   3.6260163084462023`*^9, 3.626016312151067*^9}, {3.626016435763886*^9, 
   3.626016545731391*^9}, {3.626017050152656*^9, 3.626017254889628*^9}, {
   3.626017285288323*^9, 3.626017321111019*^9}, {3.6260173744916153`*^9, 
   3.626017379330467*^9}, {3.6260174192576923`*^9, 3.626017419887233*^9}, {
   3.626017492797843*^9, 3.6260176018925343`*^9}, {3.626017899745989*^9, 
   3.626018046040257*^9}, {3.626018135133116*^9, 3.626018179635046*^9}, {
   3.626018224272769*^9, 3.626018323312355*^9}, {3.6260184557951*^9, 
   3.626018456063141*^9}, {3.62601855420151*^9, 3.626018586771699*^9}, {
   3.626018672862569*^9, 3.6260186759827423`*^9}, {3.626018713777542*^9, 
   3.626018743592835*^9}, {3.626018851886465*^9, 3.62601885336611*^9}, {
   3.626020055751233*^9, 3.626020082329286*^9}, 3.6260203125482273`*^9, {
   3.6573645638651447`*^9, 3.6573646804026203`*^9}, {3.6573647113234386`*^9, 
   3.657364712188695*^9}, {3.65736480121299*^9, 3.65736482889789*^9}, {
   3.657364944703672*^9, 3.6573649602098627`*^9}, {3.6573664155576878`*^9, 
   3.657366522643482*^9}, {3.6573665830530357`*^9, 3.6573665866110992`*^9}, {
   3.657366733409678*^9, 3.657366739448947*^9}, {3.6573667935024767`*^9, 
   3.657366902040443*^9}, {3.6573687355319443`*^9, 3.657368748383046*^9}, {
   3.6573700246945467`*^9, 3.6573700401895943`*^9}, {3.657370092547884*^9, 
   3.6573701140418177`*^9}, {3.657370201018347*^9, 3.657370236971127*^9}, {
   3.657370623503697*^9, 3.657370666814638*^9}, {3.657371201974942*^9, 
   3.657371358040461*^9}, {3.657371557984788*^9, 3.657371594626405*^9}, {
   3.657432611540427*^9, 3.657432613477182*^9}, {3.657440363988915*^9, 
   3.657440365530199*^9}, {3.657452836437943*^9, 3.657452850132251*^9}, {
   3.657967552631449*^9, 3.657967552721449*^9}, {3.657967840685449*^9, 
   3.6579678497094493`*^9}, {3.6579702161633863`*^9, 3.657970252574027*^9}, 
   3.657978558681997*^9, {3.6579793609902196`*^9, 3.6579793611522355`*^9}, {
   3.6779239437483487`*^9, 3.677923950529027*^9}, {3.6780089951929092`*^9, 
   3.6780089960226803`*^9}, {3.678009239531205*^9, 3.6780092415531473`*^9}, {
   3.678013982215477*^9, 3.678013984436771*^9}, {3.678016135914647*^9, 
   3.678016139375662*^9}, {3.678083615193223*^9, 3.678083633646394*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"eplRotatedFromRawState", "[", 
    RowBox[{
    "inputState_", ",", "inputState2_", ",", "pCNOT_", ",", "pSWAP_", ",", 
     "pmDark_", ",", "pmBright_", ",", "pp_", ",", "pCarbonDephasing_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "rootX", ",", "rawState", ",", "rawState1", ",", "rawState2", ",", 
       "state", ",", "cz1", ",", "cz2", ",", "hads", ",", "p", ",", "swap1", 
       ",", "swap2"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rawState", " ", "=", " ", "inputState"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "the", " ", "state", " ", "gets", " ", "swapped", " ", "onto", " ", 
        "nuclear", " ", "spins"}], " ", "*)"}], "\n", 
      RowBox[{"rootX", " ", "=", " ", 
       RowBox[{"MatrixExp", "[", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], "*", "pX", "*", 
         RowBox[{"\[Pi]", "/", "4"}]}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"state", " ", "=", " ", 
       RowBox[{"KP", "[", 
        RowBox[{"rawState", ",", "zero", ",", "zero"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"swap1", " ", "=", " ", 
       RowBox[{"twoQgate", "[", 
        RowBox[{"4", ",", "1", ",", "3", ",", "swap"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"swap2", " ", "=", " ", 
       RowBox[{"twoQgate", "[", 
        RowBox[{"4", ",", "2", ",", "4", ",", "swap"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"state", " ", "=", " ", 
       RowBox[{"swap1", ".", "state", ".", 
        RowBox[{"CT", "[", "swap1", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"state", " ", "=", " ", 
       RowBox[{"swap2", ".", "state", ".", 
        RowBox[{"CT", "[", "swap2", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"state", " ", "=", " ", 
       RowBox[{"applyGateNoise", "[", 
        RowBox[{"state", ",", "pSWAP", ",", "1", ",", "3"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"state", " ", "=", " ", 
       RowBox[{"applyGateNoise", "[", 
        RowBox[{"state", ",", "pSWAP", ",", "2", ",", "4"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "the", " ", "electron", " ", "spins", " ", "are", " ", "measured", " ",
         "out", " ", "in", " ", "the", " ", "zero", " ", 
        RowBox[{"state", ":", " ", 
         RowBox[{
         "NB", " ", "this", " ", "is", " ", "post", " ", "selective"}]}]}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"rawState1", " ", "=", " ", 
       RowBox[{"measureOutcomeReal", "[", 
        RowBox[{"state", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", "pmDark"}], "]"}]}], ";", "\n", 
      RowBox[{"rawState1", " ", "=", " ", 
       RowBox[{
        RowBox[{"KP", "[", 
         RowBox[{"rootX", ",", "rootX"}], "]"}], ".", "rawState1", ".", 
        RowBox[{"KP", "[", 
         RowBox[{
          RowBox[{"rootX", "\[ConjugateTranspose]"}], ",", 
          RowBox[{"rootX", "\[ConjugateTranspose]"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "generate", " ", "another", " ", "raw", " ", "pair", " ", "on", " ", 
         "the", " ", "electrons"}], ",", " ", 
        RowBox[{"this", " ", "time", " ", 
         RowBox[{"there", "'"}], "s", " ", "some", " ", "phase", " ", "shift",
          " ", "pp", " ", "from", " ", "the", " ", "first", " ", "one"}]}], 
       " ", "*)"}], "\n", 
      RowBox[{"(*", " ", 
       RowBox[{
       "now", " ", "also", " ", "supporting", " ", "a", " ", "different", " ",
         "theta", " ", "angle"}], " ", "*)"}], "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"rawState", "  ", "=", " ", "inputState2"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"rawState2", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "pp"}], ")"}], "*", "inputState2"}], " ", "+", 
        " ", 
        RowBox[{"pp", "*", 
         RowBox[{
          RowBox[{"KP", "[", 
           RowBox[{"pZ", ",", "id"}], "]"}], ".", "inputState2", ".", 
          RowBox[{"KP", "[", 
           RowBox[{"pZ", ",", "id"}], "]"}]}]}]}]}], ";", 
      "\[IndentingNewLine]", "\n", 
      RowBox[{"(*", 
       RowBox[{
       "dephasing", " ", "of", " ", "the", " ", "stored", " ", "state", " ", 
        "is", " ", "modelled", " ", "symmetrically", " ", "for", " ", "both", 
        " ", "nuclear", " ", "spins"}], "*)"}], "\n", 
      RowBox[{"rawState1", " ", "=", " ", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", "pCarbonDephasing"}], ")"}], "2"], "*", 
         "rawState1"}], " ", "+", " ", 
        RowBox[{"pCarbonDephasing", "*", 
         RowBox[{"(", 
          RowBox[{"1", "-", "pCarbonDephasing"}], ")"}], "*", 
         RowBox[{
          RowBox[{"KP", "[", 
           RowBox[{"pZ", ",", "id"}], "]"}], ".", "rawState1", ".", 
          RowBox[{"KP", "[", 
           RowBox[{"pZ", ",", "id"}], "]"}]}]}], "+", 
        RowBox[{"pCarbonDephasing", "*", 
         RowBox[{"(", 
          RowBox[{"1", "-", "pCarbonDephasing"}], ")"}], "*", 
         RowBox[{
          RowBox[{"KP", "[", 
           RowBox[{"id", ",", "pZ"}], "]"}], ".", "rawState1", ".", 
          RowBox[{"KP", "[", 
           RowBox[{"id", ",", "pZ"}], "]"}]}]}], "+", 
        RowBox[{
         SuperscriptBox["pCarbonDephasing", "2"], "*", 
         RowBox[{
          RowBox[{"KP", "[", 
           RowBox[{"pZ", ",", "pZ"}], "]"}], ".", "rawState1", ".", 
          RowBox[{"KP", "[", 
           RowBox[{"pZ", ",", "pZ"}], "]"}]}]}]}]}], ";", "\n", "\n", 
      RowBox[{"rawState1", " ", "=", " ", 
       RowBox[{
        RowBox[{"KP", "[", 
         RowBox[{
          RowBox[{"rootX", "\[ConjugateTranspose]"}], ",", 
          RowBox[{"rootX", "\[ConjugateTranspose]"}]}], "]"}], ".", 
        "rawState1", ".", 
        RowBox[{"KP", "[", 
         RowBox[{"rootX", ",", "rootX"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"state", " ", "=", " ", 
       RowBox[{"KP", "[", 
        RowBox[{"rawState1", ",", "rawState2"}], "]"}]}], ";", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"For", " ", "debugging", "\n", 
         RowBox[{"Print", "[", "\"\<rawstate1\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"rawState1", "//", "MatrixForm"}], "]"}], ";", "\n", 
        RowBox[{"Print", "[", "\"\<rawstate2\>\"", "]"}], ";", "\n", 
        RowBox[{"Print", "[", 
         RowBox[{"rawState2", "//", "MatrixForm"}], "]"}], ";", "\n", 
        RowBox[{"Print", "[", "\"\<PTr over qubits 1,2 of state\>\"", "]"}], 
        ";", "\n", 
        RowBox[{"Print", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"measureOutcome", "[", 
             RowBox[{"state", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "+", 
            RowBox[{"measureOutcome", "[", 
             RowBox[{"state", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "0"}], "}"}]}], "]"}], "+", 
            RowBox[{"measureOutcome", "[", 
             RowBox[{"state", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "+", 
            RowBox[{"measureOutcome", "[", 
             RowBox[{"state", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}], ")"}], "//", 
          "MatrixForm"}], "]"}], ";"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"cz1", "=", 
       RowBox[{"twoQgate", "[", 
        RowBox[{"4", ",", "1", ",", "3", ",", "cnotB"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"cz2", "=", 
       RowBox[{"twoQgate", "[", 
        RowBox[{"4", ",", "2", ",", "4", ",", "cnotB"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"cz1", ".", "state", ".", 
        RowBox[{"CT", "[", "cz1", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"cz2", ".", "state", ".", 
        RowBox[{"CT", "[", "cz2", "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"applyGateNoise", "[", 
        RowBox[{"state", ",", "pCNOT", ",", "1", ",", "3"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"applyGateNoise", "[", 
        RowBox[{"state", ",", "pCNOT", ",", "2", ",", "4"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"measureOutcomeReal", "[", 
        RowBox[{"state", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], ",", "pmDark"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"state", "=", " ", 
       RowBox[{
        RowBox[{"KP", "[", 
         RowBox[{"pX", ",", "id"}], "]"}], ".", "state", ".", 
        RowBox[{"KP", "[", 
         RowBox[{"pX", ",", "id"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Chop", "[", 
            RowBox[{"state", "/", 
             RowBox[{"Tr", "[", "state", "]"}]}], "]"}], ")"}], "//", 
          "MatrixForm"}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Chop", "[", 
       RowBox[{"state", "/", 
        RowBox[{"Tr", "[", "state", "]"}]}], "]"}]}]}], "\[IndentingNewLine]",
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Code",
 CellChangeTimes->{{3.626014274371472*^9, 3.6260143025889177`*^9}, {
   3.62601528951161*^9, 3.626015299770426*^9}, {3.626015386244769*^9, 
   3.626015401191888*^9}, {3.626015827486863*^9, 3.626015851279748*^9}, 
   3.626015897505383*^9, {3.626016041501705*^9, 3.6260160779908333`*^9}, {
   3.6260163084462023`*^9, 3.626016312151067*^9}, {3.626016435763886*^9, 
   3.626016545731391*^9}, {3.626017050152656*^9, 3.626017254889628*^9}, {
   3.626017285288323*^9, 3.626017321111019*^9}, {3.6260173744916153`*^9, 
   3.626017379330467*^9}, {3.6260174192576923`*^9, 3.626017419887233*^9}, {
   3.626017492797843*^9, 3.6260176018925343`*^9}, {3.626017899745989*^9, 
   3.626018046040257*^9}, {3.626018135133116*^9, 3.626018179635046*^9}, {
   3.626018224272769*^9, 3.626018323312355*^9}, {3.6260184557951*^9, 
   3.626018456063141*^9}, {3.62601855420151*^9, 3.626018586771699*^9}, {
   3.626018672862569*^9, 3.6260186759827423`*^9}, {3.626018713777542*^9, 
   3.626018743592835*^9}, {3.626018851886465*^9, 3.62601885336611*^9}, {
   3.626020055751233*^9, 3.626020082329286*^9}, 3.6260203125482273`*^9, {
   3.6573645638651447`*^9, 3.6573646804026203`*^9}, {3.6573647113234386`*^9, 
   3.657364712188695*^9}, {3.65736480121299*^9, 3.65736482889789*^9}, {
   3.657364944703672*^9, 3.6573649602098627`*^9}, {3.6573664155576878`*^9, 
   3.657366522643482*^9}, {3.6573665830530357`*^9, 3.6573665866110992`*^9}, {
   3.657366733409678*^9, 3.657366739448947*^9}, {3.6573667935024767`*^9, 
   3.657366902040443*^9}, {3.6573687355319443`*^9, 3.657368748383046*^9}, {
   3.6573700246945467`*^9, 3.6573700401895943`*^9}, {3.657370092547884*^9, 
   3.6573701140418177`*^9}, {3.657370201018347*^9, 3.657370236971127*^9}, {
   3.657370623503697*^9, 3.657370666814638*^9}, {3.657371201974942*^9, 
   3.657371358040461*^9}, {3.657371557984788*^9, 3.657371594626405*^9}, {
   3.657432611540427*^9, 3.657432613477182*^9}, {3.657440363988915*^9, 
   3.657440365530199*^9}, {3.657452836437943*^9, 3.657452850132251*^9}, {
   3.6579675015484495`*^9, 3.657967711804449*^9}, {3.657967851289449*^9, 
   3.6579678530914493`*^9}, {3.6579683323360224`*^9, 
   3.6579683683486233`*^9}, {3.6579779009852333`*^9, 
   3.6579779120523405`*^9}, {3.657977944181553*^9, 3.6579780132004538`*^9}, {
   3.657978095028636*^9, 3.65797809706384*^9}, {3.6579781691340456`*^9, 
   3.657978372266357*^9}, {3.6579784108942194`*^9, 3.6579784117863083`*^9}, {
   3.657978460848214*^9, 3.6579784806941986`*^9}, {3.657978523004429*^9, 
   3.6579785340515337`*^9}, {3.6579786001851463`*^9, 
   3.6579786106581936`*^9}, {3.6579793185069714`*^9, 3.657979334010522*^9}, {
   3.6779200468576965`*^9, 3.6779201136713767`*^9}, {3.677921240295012*^9, 
   3.6779212483308153`*^9}, {3.6779235401649947`*^9, 
   3.6779235454625244`*^9}, {3.677923782979274*^9, 3.6779237868276587`*^9}, {
   3.6779239649184656`*^9, 3.6779240134153147`*^9}, {3.67792405157413*^9, 
   3.677924054976471*^9}, {3.677924228006772*^9, 3.677924229569928*^9}, {
   3.677924275052476*^9, 3.6779242776087313`*^9}, {3.6779243636943393`*^9, 
   3.6779243999899683`*^9}, {3.677924475944563*^9, 3.6779246194559126`*^9}, {
   3.677924650397007*^9, 3.6779246591558824`*^9}, {3.677924733382304*^9, 
   3.677924797110677*^9}, {3.677925126166579*^9, 3.677925146100572*^9}, {
   3.6779257576957254`*^9, 3.6779257666056166`*^9}, {3.677925807591715*^9, 
   3.677925807993755*^9}, {3.6779259400239563`*^9, 3.6779259610290565`*^9}, {
   3.6779260036053143`*^9, 3.677926028946848*^9}, {3.677926059901943*^9, 
   3.6779260719571486`*^9}, {3.677926116787631*^9, 3.677926117853738*^9}, {
   3.6779264516071095`*^9, 3.6779264541703663`*^9}, {3.6779267040583525`*^9, 
   3.677926708707817*^9}, {3.6779267732112665`*^9, 3.677926775551501*^9}, {
   3.6779268518131266`*^9, 3.6779268722351685`*^9}, {3.6779269164105854`*^9, 
   3.677926972680212*^9}, {3.6779276467276096`*^9, 3.6779276589338303`*^9}, {
   3.677927824196355*^9, 3.677927837505686*^9}, {3.678008982002635*^9, 
   3.678008982984317*^9}, {3.678009231908165*^9, 3.6780092335300627`*^9}, {
   3.678013974864799*^9, 3.678013977837968*^9}, {3.678014509805571*^9, 
   3.678014512474749*^9}, {3.6780150901680183`*^9, 3.67801509269484*^9}, {
   3.678016127573031*^9, 3.678016131992816*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"outputState", "[", 
   RowBox[{
   "theta_", ",", "theta2_", ",", "pZPL_", ",", "pDetect_", ",", "pDC_", ",", 
    "vis_", ",", "fz_", ",", "pCNOT_", ",", "pSWAP_", ",", "pmDark_", ",", 
    "pmBright_", ",", "pp_", ",", "pCarbonDephasing_", ",", 
    "RndOpticalPhase_", ",", 
    RowBox[{"PsiPlus_:", "True"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"rawstate", ",", "rval", ",", "rawstate2", ",", "rval2"}], "}"}],
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rval", "=", 
      RowBox[{"rValue", "[", 
       RowBox[{"theta", ",", "pZPL", ",", "pDetect", ",", "pDC"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"rval2", " ", "=", " ", 
      RowBox[{"rValue", "[", 
       RowBox[{"theta2", ",", "pZPL", ",", "pDetect", ",", "pDC"}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"rawstate", " ", "=", " ", 
      RowBox[{"rawState", "[", 
       RowBox[{"vis", ",", "fz", ",", "rval", ",", "RndOpticalPhase"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"rawstate2", " ", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"PsiPlus", "\[Equal]", "True"}], ",", 
        RowBox[{"rawState", "[", 
         RowBox[{"vis", ",", "fz", ",", "rval2", ",", "RndOpticalPhase"}], 
         "]"}], ",", 
        RowBox[{"rawState", "[", 
         RowBox[{
          RowBox[{"-", "vis"}], ",", "fz", ",", "rval2", ",", 
          "RndOpticalPhase"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"eplFromRawState", "[", 
      RowBox[{
      "rawstate", ",", "rawstate2", ",", "pCNOT", ",", "pSWAP", ",", "pmDark",
        ",", "pmBright", ",", "pp", ",", "pCarbonDephasing"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.657457033148971*^9, 3.657457408025284*^9}, {
   3.657457502017713*^9, 3.6574575028807*^9}, {3.657457544374501*^9, 
   3.657457572225761*^9}, {3.657457617143345*^9, 3.657457619821855*^9}, 
   3.657460416000187*^9, {3.6579677385624495`*^9, 3.657967751343449*^9}, {
   3.657970287229492*^9, 3.6579702955023193`*^9}, {3.677996838402172*^9, 
   3.677996839696206*^9}, 3.678006368366343*^9, {3.678006602827084*^9, 
   3.678006608376178*^9}, 3.678014524395515*^9, 3.678014582505768*^9, {
   3.6780836603060102`*^9, 3.678083680379476*^9}, 3.678084060230279*^9, {
   3.678084633982781*^9, 3.6780846349073772`*^9}, 3.678087758822624*^9, {
   3.678087809940432*^9, 3.678087881204258*^9}, 3.6780879806948833`*^9, {
   3.6780884201685467`*^9, 3.6780884338284607`*^9}, {3.678088666436144*^9, 
   3.678088685115267*^9}, 3.6780887580328083`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"outputStateRotated", "[", 
   RowBox[{
   "theta_", ",", "theta2_", ",", "pZPL_", ",", "pDetect_", ",", "pDC_", ",", 
    "vis_", ",", "fz_", ",", "pCNOT_", ",", "pSWAP_", ",", "pmDark_", ",", 
    "pmBright_", ",", "pp_", ",", "pCarbonDephasing_", ",", 
    "RndOpticalPhase_", ",", 
    RowBox[{"PsiPlus_:", "True"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"rawstate", ",", "rval", ",", "rawstate2", ",", "rval2"}], "}"}],
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rval", "=", 
      RowBox[{"rValue", "[", 
       RowBox[{"theta", ",", "pZPL", ",", "pDetect", ",", "pDC"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"rval2", " ", "=", " ", 
      RowBox[{"rValue", "[", 
       RowBox[{"theta2", ",", "pZPL", ",", "pDetect", ",", "pDC"}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"rawstate", " ", "=", " ", 
      RowBox[{"rawState", "[", 
       RowBox[{"vis", ",", "fz", ",", "rval", ",", "RndOpticalPhase"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rawstate2", " ", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"PsiPlus", "\[Equal]", "True"}], ",", 
        RowBox[{"rawState", "[", 
         RowBox[{"vis", ",", "fz", ",", "rval2", ",", "RndOpticalPhase"}], 
         "]"}], ",", 
        RowBox[{"rawState", "[", 
         RowBox[{
          RowBox[{"-", "vis"}], ",", "fz", ",", "rval2", ",", 
          "RndOpticalPhase"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"eplRotatedFromRawState", "[", 
      RowBox[{
      "rawstate", ",", "rawstate2", ",", "pCNOT", ",", "pSWAP", ",", "pmDark",
        ",", "pmBright", ",", "pp", ",", "pCarbonDephasing"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.657967721077449*^9, 3.657967748273449*^9}, {
   3.657970300452814*^9, 3.657970317594528*^9}, {3.677919970102021*^9, 
   3.677920030385049*^9}, {3.677920404660473*^9, 3.6779204403570423`*^9}, 
   3.677920565528558*^9, 3.678014529331517*^9, 3.678014586169921*^9, 
   3.678087761826912*^9, {3.6780878875570297`*^9, 3.678087895871716*^9}, 
   3.678087983159148*^9, {3.678088436414774*^9, 3.678088437390625*^9}, {
   3.678088675098433*^9, 3.67808868259645*^9}, {3.6780887454068747`*^9, 
   3.678088778054343*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculate output fidelity", "Section",
 CellChangeTimes->{{3.657457721005013*^9, 3.657457724295266*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"corrs", "[", 
    RowBox[{"theta_", ",", 
     RowBox[{"theta2_:", 
      RowBox[{"\[Pi]", "/", "4"}]}], ",", 
     RowBox[{"pCarbonDephasing_:", "0.1"}], ",", 
     RowBox[{"PsiPlus_:", "True"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "pCNOT", ",", "pSWAP", ",", "pmDark", ",", "pmBright", ",", "pp", ",", 
       "vis", ",", "fz", ",", "pZPL", ",", "pDetect", ",", "pDC", ",", 
       "RndOpticalPhase", ",", "outSt", ",", "outStRt", ",", "outStXX", ",", 
       "outStRtXX", ",", "XX", ",", "XXrt", ",", "ZZ", ",", "ZZrt", ",", 
       "Fid", ",", "FidRt", ",", "rootX"}], "}"}], ",", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"pCNOT", "=", "0.025"}], ";", "\[IndentingNewLine]", 
      RowBox[{"pSWAP", " ", "=", " ", "0.05"}], ";", "\[IndentingNewLine]", 
      RowBox[{"pmDark", " ", "=", " ", "0.01"}], ";", "\[IndentingNewLine]", 
      RowBox[{"pmBright", " ", "=", " ", "0.1"}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"pp", " ", "=", " ", "0.00"}], ";", "\[IndentingNewLine]", 
      RowBox[{"RndOpticalPhase", " ", "=", " ", 
       RowBox[{"0.25", "\[Pi]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"vis", " ", "=", "0.95"}], ";", "\[IndentingNewLine]", 
      RowBox[{"fz", " ", "=", " ", "0.99"}], ";", "\[IndentingNewLine]", 
      RowBox[{"pZPL", " ", "=", " ", "0.03"}], ";", "\[IndentingNewLine]", 
      RowBox[{"pDetect", " ", "=", " ", "0.13"}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"pDC", "=", 
       SuperscriptBox["10", 
        RowBox[{"-", "7"}]]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"outSt", "=", 
       RowBox[{"outputState", "[", 
        RowBox[{
        "theta", ",", "theta2", ",", "pZPL", ",", "pDetect", ",", "pDC", ",", 
         "vis", ",", "fz", ",", "pCNOT", ",", "pSWAP", ",", "pmDark", ",", 
         "pmBright", ",", "pp", ",", "pCarbonDephasing", ",", 
         "RndOpticalPhase", ",", "PsiPlus"}], "]"}]}], ";", 
      RowBox[{"outStRt", "=", 
       RowBox[{"outputStateRotated", "[", 
        RowBox[{
        "theta", ",", "theta2", ",", "pZPL", ",", "pDetect", ",", "pDC", ",", 
         "vis", ",", "fz", ",", "pCNOT", ",", "pSWAP", ",", "pmDark", ",", 
         "pmBright", ",", "pp", ",", "pCarbonDephasing", ",", 
         "RndOpticalPhase", ",", "PsiPlus"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ZZ", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"outSt", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
         RowBox[{"outSt", "[", 
          RowBox[{"[", 
           RowBox[{"4", ",", "4"}], "]"}], "]"}]}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ZZrt", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"outStRt", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
         RowBox[{"outStRt", "[", 
          RowBox[{"[", 
           RowBox[{"4", ",", "4"}], "]"}], "]"}]}], ")"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"outStZZ", "=", " ", 
       RowBox[{"Chop", "@", "outSt"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"outStRtZZ", "=", 
       RowBox[{"Chop", "@", "outStRt"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"rootX", " ", "=", " ", 
       RowBox[{"MatrixExp", "[", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], "*", "pX", "*", 
         RowBox[{"\[Pi]", "/", "4"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"outStXX", "=", " ", 
       RowBox[{
        RowBox[{"KP", "[", 
         RowBox[{"rootX", ",", "rootX"}], "]"}], ".", "outSt", ".", 
        RowBox[{
         RowBox[{"KP", "[", 
          RowBox[{"rootX", ",", "rootX"}], "]"}], 
         "\[ConjugateTranspose]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"outStRtXX", "=", " ", 
       RowBox[{
        RowBox[{"KP", "[", 
         RowBox[{"rootX", ",", "rootX"}], "]"}], ".", "outStRt", ".", 
        RowBox[{
         RowBox[{"KP", "[", 
          RowBox[{"rootX", ",", "rootX"}], "]"}], 
         "\[ConjugateTranspose]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"PsiPlus", "\[Equal]", "True"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"XX", "=", 
          RowBox[{"Re", "@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"outStXX", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "2"}], "]"}], "]"}], "+", 
             RowBox[{"outStXX", "[", 
              RowBox[{"[", 
               RowBox[{"3", ",", "3"}], "]"}], "]"}]}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"XXrt", "=", 
          RowBox[{"Re", "@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"outStRtXX", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "2"}], "]"}], "]"}], "+", 
             RowBox[{"outStRtXX", "[", 
              RowBox[{"[", 
               RowBox[{"3", ",", "3"}], "]"}], "]"}]}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Fid", "=", 
          RowBox[{"Re", "@", 
           RowBox[{"Fidelity", "[", 
            RowBox[{"outSt", ",", 
             RowBox[{"bellState", "[", "0", "]"}]}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"FidRt", "=", 
          RowBox[{"Re", "@", 
           RowBox[{"Fidelity", "[", 
            RowBox[{"outStRt", ",", 
             RowBox[{"bellState", "[", "0", "]"}]}], "]"}]}]}], ";"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"XX", "=", 
          RowBox[{"Re", "@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"outStXX", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
             RowBox[{"outStXX", "[", 
              RowBox[{"[", 
               RowBox[{"4", ",", "4"}], "]"}], "]"}]}], ")"}]}]}], ";", 
         RowBox[{"XXrt", "=", 
          RowBox[{"Re", "@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"outStRtXX", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
             RowBox[{"outStRtXX", "[", 
              RowBox[{"[", 
               RowBox[{"4", ",", "4"}], "]"}], "]"}]}], ")"}]}]}], ";", 
         RowBox[{"Fid", "=", 
          RowBox[{"Re", "@", 
           RowBox[{"Fidelity", "[", 
            RowBox[{"outSt", ",", 
             RowBox[{"bellState", "[", "3", "]"}]}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"FidRt", "=", 
          RowBox[{"Re", "@", 
           RowBox[{"Fidelity", "[", 
            RowBox[{"outStRt", ",", 
             RowBox[{"bellState", "[", "3", "]"}]}], "]"}]}]}], ";"}]}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "ZZ", ",", "XX", ",", "Fid", ",", "ZZrt", ",", "XXrt", ",", "FidRt"}], 
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.6574574197636747`*^9, 3.657457523717958*^9}, {
   3.657457588431343*^9, 3.657457607773171*^9}, {3.6574576399670067`*^9, 
   3.6574576929392443`*^9}, 3.657457730611253*^9, {3.657459805285996*^9, 
   3.6574598080312233`*^9}, {3.657460424683663*^9, 3.65746043000362*^9}, {
   3.657967805011449*^9, 3.657967825370449*^9}, {3.6579678621144495`*^9, 
   3.657967862316449*^9}, {3.6579683075815473`*^9, 3.6579683223760266`*^9}, {
   3.6579683856693554`*^9, 3.6579684122730155`*^9}, {3.657970323968166*^9, 
   3.6579703658973584`*^9}, {3.6579706509448605`*^9, 3.657970653050071*^9}, {
   3.6579707026290283`*^9, 3.6579707539691615`*^9}, {3.6579709520179644`*^9, 
   3.65797095347011*^9}, {3.6579714032740855`*^9, 3.657971423274085*^9}, 
   3.6579725963333797`*^9, {3.65797467798742*^9, 3.6579746780614204`*^9}, {
   3.6579780238985233`*^9, 3.6579780839225254`*^9}, {3.65797820818195*^9, 
   3.6579782087430067`*^9}, {3.6579783189760284`*^9, 
   3.6579783235154824`*^9}, {3.657978389128043*^9, 3.657978432024332*^9}, 
   3.6579785473498635`*^9, {3.6579785877449026`*^9, 3.6579785884099693`*^9}, 
   3.6729754954029884`*^9, {3.6779201738423934`*^9, 3.6779201751415234`*^9}, {
   3.677920459797986*^9, 3.677920477700776*^9}, {3.6779205180218077`*^9, 
   3.6779205409701023`*^9}, {3.6779208871157136`*^9, 3.677920894612463*^9}, {
   3.6779210964896326`*^9, 3.6779211352945127`*^9}, {3.677921256017584*^9, 
   3.6779212622822104`*^9}, {3.677923724270403*^9, 3.6779237338753633`*^9}, {
   3.677926106294582*^9, 3.6779261104339957`*^9}, {3.6779264667506237`*^9, 
   3.6779264752664757`*^9}, {3.6779268125351987`*^9, 3.677926812687214*^9}, {
   3.677927746281564*^9, 3.6779277683257685`*^9}, {3.678013758202837*^9, 
   3.678013758463842*^9}, {3.678081911394837*^9, 3.678082103128997*^9}, {
   3.678082134062923*^9, 3.678082470733953*^9}, {3.678082506199326*^9, 
   3.678082577659753*^9}, {3.678082611374012*^9, 3.678082763304286*^9}, {
   3.678082797586771*^9, 3.678082817622919*^9}, {3.678084071289733*^9, 
   3.678084072296657*^9}, {3.678084338765946*^9, 3.678084376826508*^9}, {
   3.678084415035043*^9, 3.678084435954197*^9}, {3.6780860813919477`*^9, 
   3.678086081663114*^9}, 3.678086166615334*^9, {3.678087198771584*^9, 
   3.6780872105593576`*^9}, {3.67808738414235*^9, 3.6780873874044724`*^9}, {
   3.678087640927887*^9, 3.678087647318819*^9}, {3.678087698808454*^9, 
   3.678087706845626*^9}, 3.678087742181497*^9, {3.678087907763032*^9, 
   3.678087922824477*^9}, {3.6780884728166723`*^9, 3.678088518009019*^9}, 
   3.6780886107203503`*^9, {3.678088649717922*^9, 3.678088661434622*^9}, {
   3.678088801536861*^9, 3.6780888063589697`*^9}, {3.678088876223651*^9, 
   3.67808887639004*^9}, {3.678088972889551*^9, 3.6780890271539383`*^9}, {
   3.6780890830024977`*^9, 3.6780891067342367`*^9}, {3.678089410628867*^9, 
   3.6780894656653633`*^9}, {3.6780926285925703`*^9, 3.67809277603228*^9}, {
   3.6780928167032433`*^9, 3.6780928360015173`*^9}, {3.678094113010429*^9, 
   3.678094134005432*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"corrs", "[", 
  RowBox[{"0.1", ",", "02.", ",", "0.1"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.735134348968421`", ",", "0.6935330234328694`", ",", 
   "0.5611002096557701`", ",", "0.43291074162875437`", ",", 
   "0.6700963584115577`", ",", "0.3865517347347212`"}], "}"}]], "Output",
 CellChangeTimes->{3.678112595132972*^9, 3.6781127908537893`*^9, 
  3.678126189280607*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Scan over different thetas", "Subsubsection",
 CellChangeTimes->{{3.678094987627664*^9, 3.678094992808611*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Print", "[", "\"\<0.1 p Carbon dephasing\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"results", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<\[Theta]1\>\"", ",", "\"\<\[Theta]2\>\"", ",", "\"\<pCd\>\"", ",", 
       "\"\<|\>\"", ",", "\"\<ZZ\>\"", ",", "\"\<XX\>\"", ",", "\"\<Fid\>\"", 
       ",", "\"\<ZZrt\>\"", ",", "\"\<XXrt\>\"", ",", "\"\<Fidrt\>\""}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"\"\<----\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "0", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", "\"\<|\>\"", "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<-------\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "0", ",", "5"}], "}"}]}], "]"}]}], "]"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"theta1", " ", "=", " ", 
   RowBox[{"\[Pi]", "/", "4"}]}], ";", " ", 
  RowBox[{"theta2", " ", "=", " ", 
   RowBox[{"\[Pi]", "/", "4"}]}], ";", " ", 
  RowBox[{"pCd", " ", "=", " ", "0.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"results", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{"results", ",", 
     RowBox[{"{", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"theta1", ",", "theta2", ",", "pCd", ",", "\"\<|\>\""}], 
         "}"}], ",", 
        RowBox[{"corrs", "[", 
         RowBox[{"theta1", ",", "theta2", ",", "pCd"}], "]"}]}], "]"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"theta1", " ", "=", " ", 
   RowBox[{"\[Pi]", "/", "4"}]}], ";", " ", 
  RowBox[{"theta2", " ", "=", " ", 
   RowBox[{"\[Pi]", "/", "12"}]}], ";", " ", 
  RowBox[{"pCd", " ", "=", " ", "0.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"results", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{"results", ",", 
     RowBox[{"{", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"theta1", ",", "theta2", ",", "pCd", ",", "\"\<|\>\""}], 
         "}"}], ",", 
        RowBox[{"corrs", "[", 
         RowBox[{"theta1", ",", "theta2", ",", "pCd"}], "]"}]}], "]"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"theta1", " ", "=", " ", 
   RowBox[{"\[Pi]", "/", "12"}]}], ";", " ", 
  RowBox[{"theta2", " ", "=", " ", 
   RowBox[{"\[Pi]", "/", "4"}]}], ";", " ", 
  RowBox[{"pCd", " ", "=", " ", "0.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"results", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{"results", ",", 
     RowBox[{"{", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"theta1", ",", "theta2", ",", "pCd", ",", "\"\<|\>\""}], 
         "}"}], ",", 
        RowBox[{"corrs", "[", 
         RowBox[{"theta1", ",", "theta2", ",", "pCd"}], "]"}]}], "]"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"theta1", " ", "=", " ", 
   RowBox[{"\[Pi]", "/", "12"}]}], ";", " ", 
  RowBox[{"theta2", " ", "=", " ", 
   RowBox[{"\[Pi]", "/", "12"}]}], ";", " ", 
  RowBox[{"pCd", " ", "=", " ", "0.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"results", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{"results", ",", 
     RowBox[{"{", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"theta1", ",", "theta2", ",", "pCd", ",", "\"\<|\>\""}], 
         "}"}], ",", 
        RowBox[{"corrs", "[", 
         RowBox[{"theta1", ",", "theta2", ",", "pCd"}], "]"}]}], "]"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"results", "//", "TableForm"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<0.3 p Carbon dephasing\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"results", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<\[Theta]1\>\"", ",", "\"\<\[Theta]2\>\"", ",", "\"\<pCd\>\"", ",", 
       "\"\<|\>\"", ",", "\"\<ZZ\>\"", ",", "\"\<XX\>\"", ",", "\"\<Fid\>\"", 
       ",", "\"\<ZZrt\>\"", ",", "\"\<XXrt\>\"", ",", "\"\<Fidrt\>\""}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"\"\<----\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "0", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", "\"\<|\>\"", "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<-------\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "0", ",", "5"}], "}"}]}], "]"}]}], "]"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"theta1", " ", "=", " ", 
   RowBox[{"\[Pi]", "/", "4"}]}], ";", " ", 
  RowBox[{"theta2", " ", "=", " ", 
   RowBox[{"\[Pi]", "/", "4"}]}], ";", " ", 
  RowBox[{"pCd", " ", "=", " ", "0.3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"results", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{"results", ",", 
     RowBox[{"{", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"theta1", ",", "theta2", ",", "pCd", ",", "\"\<|\>\""}], 
         "}"}], ",", 
        RowBox[{"corrs", "[", 
         RowBox[{"theta1", ",", "theta2", ",", "pCd"}], "]"}]}], "]"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"theta1", " ", "=", " ", 
   RowBox[{"\[Pi]", "/", "4"}]}], ";", " ", 
  RowBox[{"theta2", " ", "=", " ", 
   RowBox[{"\[Pi]", "/", "12"}]}], ";", " ", 
  RowBox[{"pCd", " ", "=", " ", "0.3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"results", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{"results", ",", 
     RowBox[{"{", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"theta1", ",", "theta2", ",", "pCd", ",", "\"\<|\>\""}], 
         "}"}], ",", 
        RowBox[{"corrs", "[", 
         RowBox[{"theta1", ",", "theta2", ",", "pCd"}], "]"}]}], "]"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"theta1", " ", "=", " ", 
   RowBox[{"\[Pi]", "/", "12"}]}], ";", " ", 
  RowBox[{"theta2", " ", "=", " ", 
   RowBox[{"\[Pi]", "/", "4"}]}], ";", " ", 
  RowBox[{"pCd", " ", "=", " ", "0.3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"results", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{"results", ",", 
     RowBox[{"{", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"theta1", ",", "theta2", ",", "pCd", ",", "\"\<|\>\""}], 
         "}"}], ",", 
        RowBox[{"corrs", "[", 
         RowBox[{"theta1", ",", "theta2", ",", "pCd"}], "]"}]}], "]"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"theta1", " ", "=", " ", 
   RowBox[{"\[Pi]", "/", "12"}]}], ";", " ", 
  RowBox[{"theta2", " ", "=", " ", 
   RowBox[{"\[Pi]", "/", "12"}]}], ";", " ", 
  RowBox[{"pCd", " ", "=", " ", "0.3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"results", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{"results", ",", 
     RowBox[{"{", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"theta1", ",", "theta2", ",", "pCd", ",", "\"\<|\>\""}], 
         "}"}], ",", 
        RowBox[{"corrs", "[", 
         RowBox[{"theta1", ",", "theta2", ",", "pCd"}], "]"}]}], "]"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"results", "//", "TableForm"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.678084448779333*^9, 3.678084468430073*^9}, {
  3.678085174279765*^9, 3.678085197875011*^9}, {3.6780852811102657`*^9, 
  3.678085301285121*^9}, {3.6780853418557796`*^9, 3.678085342668198*^9}, {
  3.678085559762499*^9, 3.678085606286923*^9}, {3.678089126046238*^9, 
  3.678089145612253*^9}, {3.678089233667931*^9, 3.678089349993539*^9}, {
  3.6780930905177193`*^9, 3.678093495521459*^9}, {3.6780935320978622`*^9, 
  3.678093645378046*^9}, {3.678094057693995*^9, 3.678094069342843*^9}, {
  3.678094099928247*^9, 3.678094108346496*^9}, {3.678094164466261*^9, 
  3.678094175298855*^9}, {3.678094282775174*^9, 3.678094325029789*^9}}],

Cell[BoxData["\<\"0.1 p Carbon dephasing\"\>"], "Print",
 CellChangeTimes->{
  3.6780940698255653`*^9, 3.6780941354978848`*^9, 3.6780941756672363`*^9, {
   3.6780942831376333`*^9, 3.6780943254349413`*^9}, 3.678112498487795*^9, 
   3.678112595162869*^9, 3.6781127908949423`*^9, 3.678126189329886*^9}],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"\[Theta]1\"\>", "\<\"\[Theta]2\"\>", "\<\"pCd\"\>", "\<\"|\"\>", \
"\<\"ZZ\"\>", "\<\"XX\"\>", "\<\"Fid\"\>", "\<\"ZZrt\"\>", "\<\"XXrt\"\>", \
"\<\"Fidrt\"\>"},
    {"\<\"----\"\>", "\<\"----\"\>", "\<\"----\"\>", "\<\"|\"\>", \
"\<\"-------\"\>", "\<\"-------\"\>", "\<\"-------\"\>", "\<\"-------\"\>", "\
\<\"-------\"\>", "\<\"-------\"\>"},
    {
     FractionBox["\[Pi]", "4"], 
     FractionBox["\[Pi]", "4"], "0.1`", "\<\"|\"\>", "0.9041284317001892`", 
     "0.736462813685647`", "0.6885270296184631`", "0.7756159735919955`", 
     "0.7548646839205141`", "0.6426726707283903`"},
    {
     FractionBox["\[Pi]", "4"], 
     FractionBox["\[Pi]", "12"], "0.1`", "\<\"|\"\>", "0.958640579177516`", 
     "0.7540953100752639`", "0.7334155996648708`", "0.9466677437481295`", 
     "0.8159872335334928`", "0.7893211054791185`"},
    {
     FractionBox["\[Pi]", "12"], 
     FractionBox["\[Pi]", "4"], "0.1`", "\<\"|\"\>", "0.9186736435210661`", 
     "0.7540953100752639`", "0.7134321465366937`", "0.7674752011969483`", 
     "0.8159872335334928`", "0.6997248342102173`"},
    {
     FractionBox["\[Pi]", "12"], 
     FractionBox["\[Pi]", "12"], "0.1`", "\<\"|\"\>", "0.9782884225207171`", 
     "0.7742398233453616`", "0.7633840368153486`", "0.9592451038446257`", 
     "0.9013338045631072`", "0.8809563565160083`"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.678094069947261*^9, 3.678094135622827*^9, 3.678094175795478*^9, {
   3.67809428326665*^9, 3.678094325577817*^9}, 3.67811253775242*^9, 
   3.678112595296055*^9, 3.678112791002696*^9, 3.678126189438655*^9}],

Cell[BoxData["\<\"0.3 p Carbon dephasing\"\>"], "Print",
 CellChangeTimes->{
  3.6780940698255653`*^9, 3.6780941354978848`*^9, 3.6780941756672363`*^9, {
   3.6780942831376333`*^9, 3.6780943254349413`*^9}, 3.678112498487795*^9, 
   3.678112595162869*^9, 3.6781127908949423`*^9, 3.678126189447976*^9}],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"\[Theta]1\"\>", "\<\"\[Theta]2\"\>", "\<\"pCd\"\>", "\<\"|\"\>", \
"\<\"ZZ\"\>", "\<\"XX\"\>", "\<\"Fid\"\>", "\<\"ZZrt\"\>", "\<\"XXrt\"\>", \
"\<\"Fidrt\"\>"},
    {"\<\"----\"\>", "\<\"----\"\>", "\<\"----\"\>", "\<\"|\"\>", \
"\<\"-------\"\>", "\<\"-------\"\>", "\<\"-------\"\>", "\<\"-------\"\>", "\
\<\"-------\"\>", "\<\"-------\"\>"},
    {
     FractionBox["\[Pi]", "4"], 
     FractionBox["\[Pi]", "4"], "0.3`", "\<\"|\"\>", "0.9041284317001892`", 
     "0.5591157034214117`", "0.5111799309364172`", "0.6049203003757653`", 
     "0.6184786633209598`", "0.4209388219683474`"},
    {
     FractionBox["\[Pi]", "4"], 
     FractionBox["\[Pi]", "12"], "0.3`", "\<\"|\"\>", "0.9586405791775159`", 
     "0.5635238275188159`", "0.5428441171076474`", "0.9235416497338271`", 
     "0.6845869421724735`", "0.6463577745473`"},
    {
     FractionBox["\[Pi]", "12"], 
     FractionBox["\[Pi]", "4"], "0.3`", "\<\"|\"\>", "0.9186736435210661`", 
     "0.5635238275188159`", "0.522860662092932`", "0.5681855957119056`", 
     "0.6845869421724736`", "0.4686797486250136`"},
    {
     FractionBox["\[Pi]", "12"], 
     FractionBox["\[Pi]", "12"], "0.3`", "\<\"|\"\>", "0.978288422520717`", 
     "0.5685599558363403`", "0.5577041670967767`", "0.9210052127942076`", 
     "0.805767359688979`", "0.7662699807332333`"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.678094069947261*^9, 3.678094135622827*^9, 3.678094175795478*^9, {
   3.67809428326665*^9, 3.678094325577817*^9}, 3.67811253775242*^9, 
   3.678112595296055*^9, 3.678112791002696*^9, 3.6781261895838633`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Thoughts", "Subsubsection",
 CellChangeTimes->{{3.6780929728875513`*^9, 3.678092973709508*^9}}],

Cell[TextData[{
 "We start with an impurity that is possible to remove by purifying in the ZZ \
basis (00). If, during the second LDE attempts, we stay in Z basis, \
decoherence doesnt mix this with any other state. However, if we store it \
rotated, 00 could turn into 01 or 10 with some probability, which now cannot \
be removed. Crucially though, if 00 is quite small to start with, one would \
expect that should benefit from storing in a rotated basis since in this case \
can catch 01 and 10 turning into 00 or 11. \n\n",
 StyleBox["Observation",
  FontWeight->"Bold"],
 ": For standard thetas (\[Pi]/4), it looks like the ZZ correlations are \
heavily contaminated when stored in the rotated basis, while for nonrotated \
storage this isnt the case. I guess this is because 00 cannot turn into \
anything else as discussed above.\n\n",
 StyleBox["Observation",
  FontWeight->"Bold"],
 ": We see here that for small thetas the diagonal stored state has much \
worse X correlations than the rotated state. This also makes sense as \
discussed above\n\n",
 StyleBox["General note",
  FontWeight->"Bold"],
 ": for non rotated storage, changing theta doesnt really buy you so much. \
This also kind of makes sense since any 00 contamination can be effectively \
filtered out.\n\n",
 StyleBox["Observation",
  FontWeight->"Bold"],
 ": Curiously, decreasing theta1 buys almost no improvement for the rotated \
XX correlations. Decreasing theta2 by contrast buys a lot for the rotated \
basis ZZ correlations! At first this seems counterintuitive since theta2 \
doesnt impact the stored state. \n\nSo why could this be? For the rotated \
basis and large decoherence, one will have a very decent chance for 01 to \
turn into 00 and vice versa. Even if one plays with theta1, one will \
therefore still have lots of decoherence in the XX basis. However, if the \
other state is very close to 01 + 10, purification will cut out all 00 and 11 \
components from the other state, so will end up perfectly correlated (i.e. ZZ \
correlated). I guess this is because if have 00 in the second state, it \
cannot remove 11 from the decohered state.\n\nIn contrast, as can be seen, \
theta2 doesnt help nearly as much with the XX correlations because it cannot \
remove the initial 00 mixedness that has blurred into the entangled state. \
This can only be fully removed by reducing theta1. However, notably, even \
though this is the case, theta2 still buys you just as much as theta1 did for \
the XX correlations, I guess because both lead to improved original XX \
correlations. \n\n",
 StyleBox["I guess that is the lesson here",
  FontWeight->"Bold"],
 ": theta1 and theta2 buy you the same amount for XX correlations, by giving \
you a better entangled state in the first place. However, the big benefit is \
that theta2 can be a great filter for the noise induced by the carbon \
dephasing when storing in the rotated basis, since it can really effectively \
filter the ZZ correlations (where the noise ends up). Key to this is that it \
only works if the other state is close to being 01 + 10. This is therefore a \
big benefit for stored in the rotated basis if you have small theta2. \n\n\
Unfortunately, this must be traded off against the fact that the non-rotated \
state decays slower in general, since the ZZ correlations are better \
protected than in the rotated basis, and this is where the noise source that \
can be near perfectly removed lives (i.e. stored in this way the noise doesnt \
leak away but is contained and then removed)."
}], "Text",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQB2IQ7fIm5E5y+mtHwYZZL0C03rHCNyD64P+0jyDajJXz
G4hWSb35E0S7Ta7mSwHSssULhUH0hE3nZEH0ObdrRiC6YIGzK4i+MaMkACx+
rzscRNdUB0aC6ATPA4kgepH5r3QQrd12PQ9EyxQmlIJoVx3nbhDNt05zGYiO
rGpaA6Kb3l1dC6I3sf7eDKIX26buBNFKO6L2guh9AteOg+j9jwQug+g44UgI
Lbj0JoiOvzTrAYhep3f8KYjWkJv/GkRzRZz6AFbn8PETiG64LvYLRE/7XfQP
RD8r3nA9HUhLbT/zAERfacorygD5b09aCYiWm+HVAKKfeaotANHX6sOXgOg/
2x3PguiGT6/SMoH0Bu0feSAaADuovxs=
  "]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Psi minus vs Psi plus", "Subsubsection",
 CellChangeTimes->{{3.678092977677479*^9, 3.678092982325536*^9}}],

Cell["\<\
As a side note, I checked, and for these calculations psi minus and psi plus \
should behave exactly the same\
\>", "Text",
 CellChangeTimes->{{3.678092946184064*^9, 3.678092966036873*^9}, {
  3.678094962042091*^9, 3.678094963066231*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"corrs", "[", 
   RowBox[{
    RowBox[{"\[Pi]", "/", "12"}], ",", 
    RowBox[{"\[Pi]", "/", "12"}], ",", "0.3", ",", "True"}], "]"}], "==", 
  RowBox[{"corrs", "[", 
   RowBox[{
    RowBox[{"\[Pi]", "/", "12"}], ",", 
    RowBox[{"\[Pi]", "/", "12"}], ",", "0.3", ",", "False"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.678084448779333*^9, 3.678084468430073*^9}, {
  3.678085174279765*^9, 3.678085197875011*^9}, {3.6780852811102657`*^9, 
  3.678085301285121*^9}, {3.6780853418557796`*^9, 3.678085342668198*^9}, {
  3.678085559762499*^9, 3.678085606286923*^9}, {3.678089126046238*^9, 
  3.678089145612253*^9}, {3.678089233667931*^9, 3.67808938621729*^9}, {
  3.678092927098949*^9, 3.67809293921731*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.678089387295804*^9, 3.67809254276482*^9, {3.678092804573688*^9, 
   3.678092839038004*^9}, {3.678092934617057*^9, 3.6780929397226877`*^9}, 
   3.6781125955174437`*^9, 3.6781127912147837`*^9, 3.6781261896684647`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1081, 907},
WindowMargins->{{Automatic, 18}, {Automatic, 21}},
FrontEndVersion->"10.4 for Mac OS X x86 (32-bit, 64-bit Kernel) (April 11, \
2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 2176, 51, 148, "Input",
 InitializationCell->True],
Cell[2759, 75, 706, 10, 28, "Output"]
}, Open  ]],
Cell[3480, 88, 3187, 77, 764, "Text"],
Cell[6670, 167, 3295, 78, 177, "Code"],
Cell[CellGroupData[{
Cell[9990, 249, 110, 1, 44, "Subsection"],
Cell[10103, 252, 1821, 49, 50, "Code"],
Cell[CellGroupData[{
Cell[11949, 305, 498, 10, 28, "Input"],
Cell[12450, 317, 1886, 37, 92, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[14385, 360, 151, 2, 44, "Subsection"],
Cell[14539, 364, 9627, 198, 768, "Code"],
Cell[24169, 564, 14191, 294, 894, "Code"],
Cell[38363, 860, 2745, 55, 216, "Input"],
Cell[41111, 917, 2415, 51, 199, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43563, 973, 110, 1, 64, "Section"],
Cell[43676, 976, 10254, 216, 787, "Input"],
Cell[CellGroupData[{
Cell[53955, 1196, 97, 2, 28, "Input"],
Cell[54055, 1200, 323, 7, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54415, 1212, 117, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[54557, 1217, 8247, 215, 488, "Input"],
Cell[62807, 1434, 299, 4, 22, "Print"],
Cell[63109, 1440, 2062, 44, 150, "Output"],
Cell[65174, 1486, 299, 4, 22, "Print"],
Cell[65476, 1492, 2060, 44, 150, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[67585, 1542, 101, 1, 35, "Subsubsection"],
Cell[67689, 1545, 3998, 66, 657, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71724, 1616, 112, 1, 35, "Subsubsection"],
Cell[71839, 1619, 248, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[72112, 1628, 742, 16, 28, "Input"],
Cell[72857, 1646, 271, 4, 28, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

